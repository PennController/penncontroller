/*!
 * PennController for IBEX
 * This software is licensed under a BSD license; see the LICENSE file for details.
 * 
 *  - Version 1.8
 *  - Last Update:  2020, May 24
 *  - Major changes in version 1.8:
 *    * Debug window now reports PennController version
 *    * Containers of elements .print-ed with coordinates no longer remain on the screen after the trial
 *    * Special commands clear and end now also work in .callback commands
 *    * Fixed cluttering of results file from injected controllers
 *    * Fixed timeout feature of injected controllers (eg. DashedController in speeded acceptability mode)
 *    * Fixed selector.test.selected: it no longer crashes when no selection happened
 *    * Fixed unsuccessful wait on Key elements when focused element has been disabled (eg. after click on once-scale)
 *    * Space characters in initial and final position of Text elements are now non-breakable spaces
 *    * Updated display of Scale elements
 *    * Fixed reference to DropDown elements' value that would prevent testing them and setting Var elements
 *    * Fixed automatic naming of MediaRecorder (formerly VoiceRecorder) files
 *    * Failed uploads of recordings now ask participants to download an archive containing the samples before proceeding
 *    * Media recordings are now encoded as WEBM, OGG or MP4, depending on browser support
 *    * Fixed mediarecorder.test.hasPlayed (formerly voicerecorder.test.hasPlayed)
 *    + Added MediaRecorder element, VoiceRecorder is now deprecated, use newMediaRecorder("name", "audio") instead
 *    + Added PennController.UploadRecordings: creates a trial that uploads the samples recorded (but not sent) so far
 *    + PennController.InitiateRecorder can now take a third parameter to customize the consent form text
 *    + Accordingly added methods PennController.InitiateRecorder().warning(text) and PennController.InitiateRecorder().consent(text)
 *    + Added PennController.EyeTrackerURL to set where to send eyetracking data
 *    + Added PennController.version
 */
/*! $AC$ PennController.newVoiceRecorder(name,file) Creates a new VoiceRecorder element $AC$$AC$ PennController.getVoiceRecorder(name) Retrieves an existing Video element $AC$$AC$ global.PennController.InitiateRecorder(url,warning,consent) Sets the URL where to upload the recordings and creates a trial inviting the user to activate their microphone $AC$$AC$ global.PennController.UploadVoiceRecordings(label,noblock) Creates a trial that sends the voice recordings to the server $AC$$AC$ VoiceRecorder PElement.play() Starts playing back the recording $AC$$AC$ VoiceRecorder PElement.record() Starts recording $AC$$AC$ VoiceRecorder PElement.stop() Stops playback or recording $AC$$AC$ VoiceRecorder PElement.wait() Waits until recording stops before proceeding $AC$$AC$ VoiceRecorder PElement.once() Will disable the recording interface after the first recording is complete $AC$$AC$ VoiceRecorder PElement.log() Will log events in the results file $AC$$AC$ VoiceRecorder PElement.test.hasPlayed() Checks that the recording was fully played back before $AC$$AC$ VoiceRecorder PElement.test.playing() Checks that the recording is currently being played back $AC$$AC$ VoiceRecorder PElement.test.recorded() Checks that recording has happened $AC$$AC$ global.PennController.DownloadVoiceButton(text) Returns an HTML string representing a button to download an archive of the recordings $AC$ */
/*! $AC$ PennController.newYoutube(name,url) Creates a new Youtube element with the specified URL $AC$$AC$ PennController.getYoutube(name) Retrieves an existing Youtube element $AC$$AC$ Youtube PElement.play() Starts playing the video (visible only if print was called) $AC$$AC$ Youtube PElement.pause() Pauses the video $AC$$AC$ Youtube PElement.print() Shows Youtube's video player $AC$$AC$ Youtube PElement.remove() Removes Youtube's video player $AC$$AC$ Youtube PElement.stop() Stops the video and goes back to the beginning $AC$$AC$ Youtube PElement.wait() Wait until the video reaches the end before proceeding $AC$$AC$ Youtube PElement.disable() Disables the Youtube video player $AC$$AC$ Youtube PElement.enable() Enables the Youtube video player (again) $AC$$AC$ Youtube PElement.once() Will disable the Youtube video player after the video has played once $AC$$AC$ Youtube PElement.log() Will log play and/or stop events in the results file $AC$$AC$ Youtube PElement.test.hasPlayed() Checks that the video has ever played through before $AC$$AC$ Youtube PElement.test.playing() Checks that the video is currently playing $AC$ */
/*! $AC$ PennController.newVideo(name,file) Creates a new Video element using the specified file $AC$$AC$ PennController.getVideo(name) Retrieves an existing Video element $AC$$AC$ Video PElement.play() Starts playing the video (visible only if print was called) $AC$$AC$ Video PElement.pause() Pauses the video $AC$$AC$ Video PElement.print() Shows a video player $AC$$AC$ Video PElement.stop() Stops playing the video $AC$$AC$ Video PElement.wait() Waits untils the video reaches the end before proceeding $AC$$AC$ Video PElement.disable(opacity) Disable controls on the Video element $AC$$AC$ Video PElement.once() Will disable the video player after the video has played through once $AC$$AC$ Video PElement.log() Will log play and/or stop events in the results file $AC$$AC$ Video PElement.test.hasPlayed() Checks that the video has played through at least once before $AC$$AC$ Video PElement.test.playing() Checks that the video is currently playing $AC$ */
/*! $AC$ PennController.newVar(name,value) Creates a new Var element $AC$$AC$ PennController.getVar(name) Retrieves an existing Var element $AC$$AC$ Var PElement.set(value) Sets the value (can be a function, e.g. v=>v+1 will increment the value) $AC$$AC$ Var PElement.local() Ensures that the value of this Var element only affects the current trial $AC$$AC$ Var PElement.global() Shares the value with all Var elements with the same name across trials $AC$$AC$ Var PElement.test.is(value) Checks the value of the Var element (can be a function, e.g. v=>v<10) $AC$$AC$ all PElements.setVar(var) Sets the value of the specified Var element with the current value of the element $AC$ */
/*! $AC$ PennController.newTooltip(name,text) Creates a new Tooltip element $AC$$AC$ PennController.getTooltip(name) Retrieves an existing Tooltip element $AC$$AC$ Tooltip PElement.print(element) Prints the tooltip attached to the specified element $AC$$AC$ Tooltip PElement.wait() Waits until the tooltip gets validated before proceeding $AC$$AC$ Tooltip PElement.css(css) Applies the specified CSS to the frame around the target element $AC$$AC$ Tooltip PElement.key(key) Will validate (and remove) the tooltip whenever the specified key is pressed $AC$$AC$ Tooltip PElement.label(text) Defines the text used for the validation label $AC$$AC$ Tooltip PElement.log() Will log when the tooltip is validated in the results file $AC$$AC$ Tooltip PElement.position(position) Will show the tooltip at the top, at the bottom, to the left or to the right of the element it attaches to $AC$$AC$ Tooltip PElement.text(value) Redefines the text of the tooltip $AC$ */
/*! $AC$ PennController.newTimer(name,duration) Creates a new Timer element $AC$$AC$ PennController.getTimer(name) Retrieves an existing Timer element $AC$$AC$ Timer PElement.start() Starts the timer $AC$$AC$ Timer PElement.stop() Stops the timer $AC$$AC$ Timer PElement.wait() Waits until the timer elapses before proceeding $AC$$AC$ Timer PElement.callback(commands) Will execute the specified command(s) whenever the timer elapses $AC$$AC$ Timer PElement.log() Will log when the timer starts and ends in the results file $AC$$AC$ Timer PElement.test.ended() Checks that the timer has ever elapsed before $AC$$AC$ Timer PElement.test.running() Checks that the timer is currently running $AC$ */
/*! $AC$ PennController.newTextInput(name,text) Creates a new TextInput element $AC$$AC$ PennController.getTextInput(name) Retrieves an existing TextInput element $AC$$AC$ TextInput PElement.wait() Waits until Enter is pressed in the input box before proceeding $AC$$AC$ TextInput PElement.length(number) Limits the maximum number of characters in the input box to the specified number $AC$$AC$ TextInput PElement.lines(number) Limits the maximum number of lines in the input box to the specified number $AC$$AC$ TextInput PElement.log() Will log the text from the input box in the results file $AC$$AC$ TextInput PElement.once() Will disable the input box after the first keypress on Enter/Return $AC$$AC$ TextInput PElement.text(value) Replaces whatever is in the input box with the specified value $AC$$AC$ TextInput PElement.test.text(value) Checks that the content of the input box corresponds to the specified value $AC$ */
/*! $AC$ PennController.newText(name,text) Creates a new Text element $AC$$AC$ PennController.getText(name) Retrieves an existing Text element $AC$$AC$ Text PElement.unfold(duration) Unfolds the text in duration milliseconds $AC$$AC$ Text PElement.text(text) Redefines the text of the element $AC$$AC$ Text PElement.test.text(value) Checks that the text of the element corresponds to the specified value $AC$ */
/*! $AC$ PennController.newSelector(name) Creates a new Selector element $AC$$AC$ PennController.getSelector(name) Retrieves an existing Selector element $AC$$AC$ Selector PElement.select(element) Selects the specified element $AC$$AC$ Selector PElement.shuffle() Shuffles the positions on the page of the selector's elements $AC$$AC$ Selector PElement.unselect() Unselects the element that is currently selected $AC$$AC$ Selector PElement.wait() Waits until a selection happens before proceeding $AC$$AC$ Selector PElement.add(elements) Adds one or more elements to the selector $AC$$AC$ Selector PElement.callback(commands) Will execute the specified command(s) whenever selection happens $AC$$AC$ Selector PElement.disableClicks() Disables selection by click $AC$$AC$ Selector PElement.enableClicks() Enables selection by click (again) $AC$$AC$ Selector PElement.frame(css) Attributes the CSS style to the selection frame $AC$$AC$ Selector PElement.keys(keys) Associates the elements in the selector (in the order they were added) with the specified keys $AC$$AC$ Selector PElement.log() Will log any selection to the results file $AC$$AC$ Selector PElement.once() Will disable the selector after the first selection $AC$$AC$ Selector PElement.test.selected(element) Checks that the specified element, or any element if non specified, is selected $AC$$AC$ Selector PElement.test.index(element,index) Checks that the specified element is at the specified index position in the selector $AC$$AC$ all PElements.selector(selector) Adds the element to the specified selector $AC$ */
/*! $AC$ PennController.newScale(name,numberOrValues) Creates a new Scale element $AC$$AC$ PennController.getScale(name) Retrieves an existing Scale element $AC$$AC$ Scale PElement.select(option) Selects the specified option on the scale $AC$$AC$ Scale PElement.wait() Waits until a selection happens before proceeding $AC$$AC$ Scale PElement.button() Transforms the scale options into buttons $AC$$AC$ Scale PElement.callback(commands) Will execute the specified command(s) whenever selection happens $AC$$AC$ Scale PElement.default(value) Sets the specified value to be selected by default $AC$$AC$ Scale PElement.horizontal() Aligns the scale's options horizontally (again) $AC$$AC$ Scale PElement.keys(keys) Associates the scale's options with the specified keys for selection $AC$$AC$ Scale PElement.label(index,label) Gives the specified label to the option at the specified index on the scale $AC$$AC$ Scale PElement.labelsPosition(position) Will show the labels on top, at the bottom, to the left or to the right of the options $AC$$AC$ Scale PElement.log() Will log the selected option in the results file $AC$$AC$ Scale PElement.once() Will disable the scale after the first selection $AC$$AC$ Scale PElement.radio() Will show the scale's options as radio buttons $AC$$AC$ Scale PElement.slider() Will show the scale as a slider $AC$$AC$ Scale PElement.horizontal() Aligns the scale's options vertically $AC$$AC$ Scale PElement.test.selected(option) Checks that the option, or any option if none specified, is selected $AC$ */
/*! $AC$ PennController.newPalette(name) Creates a new Palette element $AC$$AC$ PennController.getPalette(name) Retrieves an existing Palette element $AC$$AC$ Palette PElement.brush(element,color) Colors the specified element with the specified color $AC$$AC$ Palette PElement.clear() Makes all the elements of the palette transparent $AC$$AC$ Palette PElement.unselect() Unselects the color from the palette that was currently selected $AC$$AC$ Palette PElement.wait() Waits until an element is clicked and colored before proceeding $AC$$AC$ Palette PElement.addColor(color,element) Adds the specified color to the palette, to be selected by clicking on the specified element $AC$$AC$ Palette PElement.addElement(elements) Adds the specified element(s) as targets for coloration $AC$$AC$ Palette PElement.callback(commands) Will execute the specified command(s) whenever an element is colored $AC$$AC$ Palette PElement.enable() Enables the palette $AC$$AC$ Palette PElement.disable() Disables the palette $AC$$AC$ Palette PElement.log() Will log any coloration to the results file $AC$$AC$ Palette PElement.once() Will disable the palette after the first coloration $AC$$AC$ Palette PElement.remove(color) Removes the specified color from the palette (leaving any associated element on the page) $AC$$AC$ Palette PElement.test.color(element,color) Checks that the specified element has been colored with the specified color $AC$ */
/*! $AC$ PennController.newMouseTracker(name) Creates a new MouseTracker element $AC$$AC$ PennController.getMouseTracker(name) Retrieves an existing MouseTracker element $AC$$AC$ Mouse PElement.start() Starts listening to mouse movements $AC$$AC$ Mouse PElement.stop() Stops listening to mouse movements $AC$$AC$ Mouse PElement.callback( commands ) Runs the specified command(s) when the mouse moves $AC$$AC$ Mouse PElement.log() Logs the X and Y positions of the mouse $AC$ */
/*! $AC$ PennController.newMediaRecorder(name,type) Creates a new MediaRecorder element of type "audio" or "video" $AC$$AC$ PennController.getMediaRecorder(name) Retrieves an existing MediaRecorder element $AC$$AC$ global.PennController.InitiateRecorder(url,warning,consent) Sets the URL where to upload the recordings and creates a trial inviting the user to activate their microphone $AC$$AC$ global.PennController.UploadRecordings(label,noblock) Creates a trial that sends the recordings to the server $AC$$AC$ MediaRecorder PElement.play() Starts playing back the recording $AC$$AC$ MediaRecorder PElement.record() Starts recording $AC$$AC$ MediaRecorder PElement.stop() Stops playback or recording $AC$$AC$ MediaRecorder PElement.wait() Waits until recording stops before proceeding $AC$$AC$ MediaRecorder PElement.once() Will disable the recording interface after the first recording is complete $AC$$AC$ MediaRecorder PElement.log() Will log events in the results file $AC$$AC$ MediaRecorder PElement.test.hasPlayed() Checks that the recording was fully played back before $AC$$AC$ MediaRecorder PElement.test.playing() Checks that the recording is currently being played back $AC$$AC$ MediaRecorder PElement.test.recorded() Checks that recording has happened $AC$$AC$ global.PennController.DownloadRecordingButton(text) Returns an HTML string representing a button to download an archive of the recordings $AC$ */
/*! $AC$ PennController.newKey(name,key) Creates a new Key element $AC$$AC$ PennController.getKey(name) Retrieves an existing Key element $AC$$AC$ Key PElement.wait() Waits until the key, or one of the keys, is pressed before proceeding $AC$$AC$ Key PElement.callback(commands) Will run the specified command(s) whenever a valid keypress happens $AC$$AC$ Key PElement.disable() Stops listening to keypresses $AC$$AC$ Key PElement.enable() Starts listening to keypresses (again) $AC$$AC$ Key PElement.log() Will log any valid keypress in the results file $AC$$AC$ Key PElement.test.pressed(key) Checks that the key, or any key if none specified, has been pressed before $AC$ */
/*! $AC$ PennController.newImage(name,file) Creates a new Image element $AC$$AC$ PennController.getImage(name) Retrieves an existing Image element $AC$ */
/*! $AC$ PennController.newHtml(name,file) Creates a new Html element $AC$$AC$ PennController.getHtml(name) Retrieves an existing Html element $AC$$AC$ Html PElement.warn() Displays warning messages if some obligatory fields were not filled $AC$$AC$ Html PElement.checkboxWarning(message) Defines the warning message displayed when an obligatory checkbox group is not checked $AC$$AC$ Html PElement.inputWarning(message) Defines the warning message displayed when an obligatory input is not filled $AC$$AC$ Html PElement.log() Logs the values of the fields from the Html in the results file $AC$$AC$ Html PElement.radioWarning(message) Defines the warning message displayed when an radio button group input is not selected $AC$$AC$ Html PElement.test.complete() Checks that all the obligatory fields have been filled $AC$ */
/*! $AC$ PennController.newGroup(name,elements) Creates a new Group element $AC$$AC$ PennController.getGroup(name) Retrieves an existing Group element $AC$$AC$ Group PElement.shuffle() Shuffles the positions of the elements on the page $AC$$AC$ Group PElement.add(elements) Adds one or more elements to the group $AC$$AC$ Group PElement.remove(elements) Removes one or more elements from the group $AC$$AC$ Group PElement.test.index(element,index) Checks the index of the specified element in the group $AC$$AC$ all PElements.group(name) Adds the element to the Group element with the specified name $AC$ */
/*! $AC$ PennController.newFunction(name,function) Creates a new Function element $AC$$AC$ PennController.getFunction(name) Retrieves an existing Function element $AC$$AC$ Function PElement.call() Executes the function $AC$$AC$ Function PElement.test.is(value) Checks that the function returns the specified value $AC$ */
/*! $AC$ PennController.newEyeTracker(name) Creates a new EyeTracker element $AC$$AC$ PennController.getEyeTracker(name) Retrieves an existing EyeTracker element $AC$$AC$ PennController.EyeTrackerURL(url) Will send eye-tracking data to specified URL $AC$$AC$ EyeTracker PElement.calibrate(threshold,attempts) Starts a sequence of calibration $AC$$AC$ EyeTracker PElement.hideFeedback() Hides the red dot estimating the position of the eyes on the page $AC$$AC$ EyeTracker PElement.start() Starts parsing eye movements $AC$$AC$ EyeTracker PElement.stop() Stops parsing eye movements $AC$$AC$ EyeTracker PElement.stopTraining() Stop training the model whenever the mouse moves or clicks $AC$$AC$ EyeTracker PElement.showFeedback() Shows the red dot estimating the position of the eyes on the page $AC$$AC$ EyeTracker PElement.train() Starts training the model on every click and mouse movement (default) $AC$$AC$ EyeTracker PElement.add(elements) Adds one or more elements of interest to the EyeTracker $AC$$AC$ EyeTracker PElement.callback(function) Runs the specified javascript function whenever the eyes look at an element of interest $AC$$AC$ EyeTracker PElement.log() Logs the X and Y positions of the eyes every N milliseconds (see documentation) $AC$$AC$ EyeTracker PElement.trainOnMouseMove(true) Tells the model whether to use mouse movements to improve its estimations $AC$ */
/*! $AC$ PennController.newDropDown(name,text) Creates a new DropDown element $AC$$AC$ PennController.getDropDown(name) Retrieves an existing DropDown element $AC$$AC$ DropDown PElement.shuffle() Shuffles the options currently in the drop-down $AC$$AC$ DropDown PElement.select(option) Selects the specified option $AC$$AC$ DropDown PElement.wait() Wait until an option is selectd before proceeding $AC$$AC$ DropDown PElement.add(options) Adds one or more options to the drop-down $AC$$AC$ DropDown PElement.remove(option) Removes the specified option from the drop-down $AC$$AC$ DropDown PElement.test.selected(option) Checks that the specified option, or any if none specified, is selected $AC$ */
/*! $AC$ PennController.newController(name,controller,options) Creates a new Controller element $AC$$AC$ PennController.getController(name) Retrieves an existing Controller element $AC$$AC$ Controller PElement.wait() Waits until the controller has been completed before proceeding $AC$ */
/*! $AC$ PennController.newCanvas(name,width,height) Creates a new Canvas element $AC$$AC$ PennController.getCanvas(name) Retrieves an existing Canvas element $AC$$AC$ Canvas PElement.add(x,y,element) Places an element at (X,Y) on the canvas $AC$ */
/*! $AC$ PennController.newButton(name,text) Creates a new Button element $AC$$AC$ PennController.getButton(name) Retrieves an existing Button element $AC$$AC$ Button PElement.click() Simulates a click on the button $AC$$AC$ Button PElement.wait() Waits until the button is clicked before proceeding $AC$$AC$ Button PElement.callback(commands) Tell the button to run a (series of) command(s) whenever it is clicked $AC$$AC$ Button PElement.log() Logs clicks on the button in the results file $AC$$AC$ Button PElement.once() Will disable the button after the first click $AC$$AC$ Button PElement.test.clicked() Checks that the button has been clicked before $AC$ */
/*! $AC$ PennController.newAudio(name,file) Creates a new Audio element $AC$$AC$ PennController.getAudio(name) Retrieves an existing Audio element $AC$$AC$ Audio PElement.play() Starts the audio playback $AC$$AC$ Audio PElement.pause() Pauses the audio playback $AC$$AC$ Audio PElement.print() Prints an interface to control the audio playback $AC$$AC$ Audio PElement.stop() Stops the audio playback $AC$$AC$ Audio PElement.wait() Waits until the audio playback has ended $AC$$AC$ Audio PElement.disable(opacity) Disables the interface $AC$$AC$ Audio PElement.enable() Enables the interface $AC$$AC$ Audio PElement.once() The interface will be disabled after the first playback $AC$$AC$ Audio PElement.log() Logs playback events $AC$$AC$ Audio PElement.test.hasPlayed() Checks whether the audio has ever been played fully $AC$$AC$ Audio PElement.test.playing() Checks whether the audio is currently playing $AC$ */
/*! $AC$ PennController().label(label) Assigns a label to the generated PennController trial $AC$$AC$ PennController().log(name,value) Adds value to each line of this trial in the results file $AC$$AC$ PennController().noHeader() Will not run commands from the header at the beginning of this trial $AC$$AC$ PennController().noFooter() Will not run commands from the footer at the end of this trial $AC$$AC$ PennController().setOption(option,value) Sets options for the controller (see Ibex manual) $AC$$AC$ global.PennController.Debug() Enables the debug mode for testing your experiment $AC$$AC$ global.PennController.DebugOff() Disables the debug mode; use before making public $AC$$AC$ global.PennController.Sequence(sequence) Defines the running order of your trials, based on their labels (see documentation) $AC$$AC$ global.PennController.GetURLParameter(parameter) Returns the value of the parameter from the URL $AC$$AC$ global.PennController.AddHost(url) Will look resources at the specified URL $AC$$AC$ global.PennController.CheckPreloaded() Creates a trial that is validated when the resources are preloaded $AC$$AC$ global.PennController.SendResults(label) Creates a trial that sends the results to the server $AC$$AC$ global.PennController.SetCounter(value) Set Ibex's internal counter to a specified value (see Ibex manual) $AC$$AC$ global.PennController.Header(commands) Will run the commands at the beginning of every PennController trial $AC$$AC$ global.PennController.Footer(commands) Will run the commands at the end of every PennController trial $AC$$AC$ all PElements.print() Prints the element $AC$$AC$ all PElements.refresh() Reprints the element where it is $AC$$AC$ all PElements.remove() Removes the element from the page $AC$$AC$ all PElement.wait() Waits until the element has been validated before proceeding $AC$$AC$ all PElements.after(element) Prints an element to the right of the current element $AC$$AC$ all PElements.before(element) Prints an element to the left of the current element $AC$$AC$ all PElements.bold() Prints the text, if any, as boldfaced $AC$$AC$ all PElements.center() Centers the element on the page $AC$$AC$ all PElements.color(color) Prints the text, if any, in the color specified $AC$$AC$ all PElements.cssContainer(option,value) Applies the CSS to the container of the element $AC$$AC$ all PElements.css(option,value) Applies the CSS to the element $AC$$AC$ all PElements.disable() Disables the element $AC$$AC$ all PElements.enable() Enables the element $AC$$AC$ all PElements.hidden() Hides the element (will still leave a blank space) $AC$$AC$ all PElements.italic() Prints the text, if any, as italicized $AC$$AC$ all PElements.left() Aligns the element with the left edge of the printing area $AC$$AC$ all PElements.right() Aligns the element with the right edge of the printing area $AC$$AC$ all PElements.size(width,height) Gives the element a specific width and/or height $AC$$AC$ all PElements.visible() Makes the element visible (again) $AC$$AC$ all PElements.test.printed() Checks that the element is printed on the page $AC$$AC$ Special Command.fullscreen() Makes the page fullscreen $AC$$AC$ Special Command.exitFullscreen() Goes back to non-fullscreen $AC$$AC$ Special Command.clear() Removes all the PElements currently on the page $AC$$AC$ Special Command.end() Ends the trial immediately $AC$$AC$ global.PennController.ResetPrefix(prefix) Resets the prefix for the new* and get* commands; pass null to make them global $AC$$AC$ global.PennController.Template(table,penncontroller) Generates trials from a table $AC$$AC$ global.PennController.PreloadZip() Silently downloads a ZIP file containing resources $AC$ */!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=140)}([function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n(1);let r=[],s={keypress:[]};class o{constructor(e,t){this.name=e,this.value=e,this.creator=t,this.controllers=[],this.object=null,this.status="void"}create(){this.status="pending",this.creator.apply(this,[()=>this.resolve()])}resolve(){this.status="ready",a.debug.log("<div style='color: purple;'>Successfully preloaded resource "+this.name+"</div>")}}var a={resources:{list:[],fetch:function(e,t,n){n=null==n|1==n;var i=a.resources.list.filter(t=>t.name==e&&t.controllers.indexOf(a.controllers.underConstruction.id)<0);if((i=i.length?i[0]:new o(e,t)).controllers.push(a.controllers.underConstruction.id),a.controllers.underConstruction.resources.push(i),"void"!=i.status)return i;if(i.creator=t,i.create(),n)for(let t in a.URLs)i.create.apply($.extend({},i,{value:a.URLs[t]+e,resolve:function(){"ready"!=i.status&&(i.object=this.object,i.resolve())}}));return a.resources.list.push(i),i}},controllers:{list:[],running:null,underConstruction:null},elements:{list:[]},events:{keypress:e=>{let t=[e,a.controllers.running||a.controllers.underConstruction];if(s.keypress.push(t),a.controllers.running){let e=a.controllers._endTrial;a.controllers.running._endTrial=async function(){await e.apply(a.controllers.running),t[0]=(()=>{})}}else{let e=a.controllers.underConstruction.sequence;a.controllers.underConstruction.sequence=Object(i.d)([e,e=>{t[0]=(()=>{}),e()}])}}},URLs:[],utils:{guidGenerator:i.b,parseCoordinates:i.g,levensthein:i.e},tmpItems:[],tables:{},Prerun:function(e){r.push(e)}};let l=window.ibex_controller_set_properties;window.ibex_controller_set_properties=function(e,t){if(l(e,t),"__SendResults__"==e){document.addEventListener("keydown",e=>{if(!e.repeat&&a.controllers.running)for(let t=0;t<s.keypress.length;t++)a.controllers.running!=s.keypress[t][1]&&a.controllers.running.id!=s.keypress[t][1]||s.keypress[t][0].apply(this,[e])});for(let e in r)r[e]instanceof Function&&r[e].call()}}},function(e,t,n){"use strict";function i(e){return()=>new Promise(async function(t){for(let t in e)if(e[t]instanceof Function)var n=await e[t]();t(n)})}function r(e){const t=new Uint8Array(e);let n=[];return t.forEach(e=>{n.push(e.toString(16))}),n.join("").toUpperCase()}function s(e,t){if(e.match(/^00000[12]00/i))return"image/x-icon";if(e.match(/424D/i))return"image/bmp";if(e.match(/^89504E470?D0?A1A0?A/i))return"image/png";if(e.match(/^474946383[79]61/i))return"image/gif";if(e.match(/^52494646........574542505650/i))return"image/webp";if(e.match(/^FFD8FF/i))return"image/jpeg";if(e.match(/^2E736E64/i))return"audio/basic";if(e.match(/^464F524D........41494646/i))return"audio/aiff";if(e.match(/^(fff[b3a2]|494433)/i))return"audio/mpeg";if(e.match(/^4F67675300/i))return"application/ogg";if(e.match(/^4D546864......06/i))return"audio/midi";if(e.match(/^52494646........41564920/i))return"video/avi";if(e.match(/^52494646.{4,8}57415645/i))return"audio/wave";if(e.match(/^1A45DFA3/i))return"video/webm";if(e.match(/^25504446/i))return"application/pdf";if(e.match(/^504B0304/i))return"application/zip";{let e=t.match(/\.([^.]+)$/);if(!e)return"";switch(e[1].toLowerCase()){case"bmp":return"image/bmp";case"png":return"image/png";case"gif":return"image/gif";case"webp":return"image/webp";case"jpg":case"jpeg":return"image/jpeg";case"mp3":return"audio/mpeg";case"ogg":case"oga":return"audio/ogg";case"midi":case"mid":return"audio/midi";case"wav":return"audio/wave";case"webm":return"video/webm";case"avi":return"video/avi";case"mp4":return"video/mp4";case"ogv":return"video/ogg";case"mov":return"video/quicktime";default:return""}}}function o(e){let t=e/1e3%60,n=Math.trunc(e/6e4);return(n>0?n+"min":"")+(t>0?t+"s":"")}function a(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function l(e){return e.map(e=>e instanceof Object&&e.hasOwnProperty("_promises")?e.type+":"+e._element.id:e)}function u(e,t,n){let i=String(e).match(/^(.+)\s+at\s+(.+)$/i),r=String(t).match(/^(.+)\s+at\s+(.+)$/i);return i&&i[2].match(/^\d+(\.\d+)?$/)&&(i[2]=String(i[2])+"px"),r&&r[2].match(/^\d+(\.\d+)?$/)&&(r[2]=String(r[2])+"px"),i&&(e=i[1].match(/center|middle/i)?"calc("+i[2]+" - "+n.width()/2+"px)":i[1].match(/right/i)?"calc("+i[2]+" - "+n.width()+"px)":i[2]),r&&(t=r[1].match(/center|middle/i)?"calc("+r[2]+" - "+n.height()/2+"px)":r[1].match(/bottom/i)?"calc("+r[2]+" - "+n.height()+"px)":r[2]),{x:e,y:t}}function h(e,t){let n=[];n[0]=("a"+t).split("").map((e,t)=>t);for(let i=1;i<e.length+1;i++)n[i]=[i,...t.split("").map(()=>0)];for(let i=1;i<t.length+1;i++)for(let r=1;r<e.length+1;r++){let s=e.charAt(r)!=t.charAt(i),o=n[r-1][i]+1,a=n[r][i-1]+1,l=n[r-1][i-1]+s;n[r][i]=o<a&&o<l?o:a<o&&a<l?a:l}return n[e.length][t.length]}n.d(t,"d",function(){return i}),n.d(t,"c",function(){return r}),n.d(t,"a",function(){return s}),n.d(t,"f",function(){return o}),n.d(t,"b",function(){return a}),n.d(t,"h",function(){return l}),n.d(t,"g",function(){return u}),n.d(t,"e",function(){return h});let c=["Unidentified","Alt","AltGraph","CapsLock","Control","Fn","FnLock","Meta","NumLock","ScrollLock","Shift","Symbol","SymbolLock","Hyper","Super","Enter","Tab","ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Home","PageDown","PageUp","Backspace","Clear","Copy","CrSel","Cut","Delete","EraseEof","ExSel","Insert","Paste","Redo","Undo","Accept","Again","Attn","Cancel","ContextMenu","Escape","Execute","Find","Help","Pause","Play","Props","Select","ZoomIn","ZoomOut","BrightnessDown","BrightnessUp","Eject","LogOff","Power","PowerOff","PrintScreen","Hibernate","Standby","WakeUp","AllCandidates","Alphanumeric","CodeInput","Compose","Convert","Dead","FinalMode","GroupFirst","GroupLast","GroupNext","GroupPrevious","ModeChange","NextCandidate","NonConvert","PreviousCandidate","Process","SingleCandidate","HangulMode","HanjaMode","JunjaMode","Eisu","Hankaku","Hiragana","HiraganaKatakana","KanaMode","KanjiMode","Katakana","Romaji","Zenkaku","ZenkakuHankaku","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Soft1","Soft2","Soft3","Soft4","ChannelDown","ChannelUp","Close","MailForward","MailReply","MailSend","MediaClose","MediaFastForward","MediaPause","MediaPlay","MediaPlayPause","MediaRecord","MediaRewind","MediaStop","MediaTrackNext","MediaTrackPrevious","New","Open","Print","Save","SpellCheck","Key11","Key12","AudioBalanceLeft","AudioBalanceRight","AudioBassBoostDown","AudioBassBoostToggle","AudioBassBoostUp","AudioFaderFront","AudioFaderRear","AudioSurroundModeNext","AudioTrebleDown","AudioTrebleUp","AudioVolumeDown","AudioVolumeUp","AudioVolumeMute","MicrophoneToggle","MicrophoneVolumeDown","MicrophoneVolumeUp","MicrophoneVolumeMute","SpeechCorrectionList","SpeechInputToggle","LaunchApplication1","LaunchApplication2","LaunchCalendar","LaunchContacts","LaunchMail","LaunchMediaPlayer","LaunchMusicPlayer","LaunchPhone","LaunchScreenSaver","LaunchSpreadsheet","LaunchWebBrowser","LaunchWebCam","LaunchWordProcessor","BrowserBack","BrowserFavorites","BrowserForward","BrowserHome","BrowserRefresh","BrowserSearch","BrowserStop","AppSwitch","Call","Camera","CameraFocus","EndCall","GoBack","GoHome","HeadsetHook","LastNumberRedial","Notification","MannerMode","VoiceDial","TV","TV3DMode","TVAntennaCable","TVAudioDescription","TVAudioDescriptionMixDown","TVAudioDescriptionMixUp","TVContentsMenu","TVDataService","TVInput","TVInputComponent1","TVInputComponent2","TVInputComposite1","TVInputComposite2","TVInputHDMI1","TVInputHDMI2","TVInputHDMI3","TVInputHDMI4","TVInputVGA1","TVMediaContext","TVNetwork","TVNumberEntry","TVPower","TVRadioService","TVSatellite","TVSatelliteBS","TVSatelliteCS","TVSatelliteToggle","TVTerrestrialAnalog","TVTerrestrialDigital","TVTimer","AVRInput","AVRPower","ColorF0Red","ColorF1Green","ColorF2Yellow","ColorF3Blue","ColorF4Grey","ColorF5Brown","ClosedCaptionToggle","Dimmer","DisplaySwap","DVR","Exit","FavoriteClear0","FavoriteClear1","FavoriteClear2","FavoriteClear3","FavoriteRecall0","FavoriteRecall1","FavoriteRecall2","FavoriteRecall3","FavoriteStore0","FavoriteStore1","FavoriteStore2","FavoriteStore3","Guide","GuideNextDay","GuidePreviousDay","Info","InstantReplay","Link","ListProgram","LiveContent","Lock","MediaApps","MediaAudioTrack","MediaLast","MediaSkipBackward","MediaSkipForward","MediaStepBackward","MediaStepForward","MediaTopMenu","NavigateIn","NavigateNext","NavigateOut","NavigatePrevious","NextFavoriteChannel","NextUserProfile","OnDemand","Pairing","PinPDown","PinPMove","PinPToggle","PinPUp","PlaySpeedDown","PlaySpeedReset","PlaySpeedUp","RandomToggle","RcLowBattery","RecordSpeedNext","RfBypass","ScanChannelsToggle","ScreenModeNext","Settings","SplitScreenToggle","STBInput","STBPower","Subtitle","Teletext","VideoModeNext","Wink","ZoomToggle","AudioVolumeDown","AudioVolumeUp","AudioVolumeMute","BrowserBack","BrowserForward","ChannelDown","ChannelUp","ContextMenu","Eject","End","Enter","Home","MediaFastForward","MediaPlay","MediaPlayPause","MediaRecord","MediaRewind","MediaStop","MediaNextTrack","MediaPause","MediaPreviousTrack","Power"],d=c.map(e=>e.toUpperCase());String.prototype.isSpecialKey=function(e){return e?c.indexOf(this)>-1:d.indexOf(this.toUpperCase())>-1},jQuery.fn.printed=function(){let e=this.parent();for(;e.length;){if(e[0]==document.body)return!0;e=e.parent()}return!1}},function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"b",function(){return h});var i=n(0),r=n(1);const s=6e4;let o=null,a=null,l=[];class u{constructor(){if(this.id=i.a.controllers.list.length,this.useLabel=!1,this.addToItems=!0,this.appendResultLine=[],this.linesToSave=[],this.resources=[],this.elements={},this.preloadDelay=s,i.a.controllers.list.push(this),this.defaultCommands={},this.headerDefaultCommands={},o&&o.defaultCommands)for(let e in o.defaultCommands)this.defaultCommands[e]=[].concat(o.defaultCommands[e])}_addElement(e){if(!e.hasOwnProperty("type")||!e.hasOwnProperty("id"))return i.a.debug.error("Attempted to create an invalid element");this.elements.hasOwnProperty(e.type)||(this.elements[e.type]={}),this.elements[e.type].hasOwnProperty(e.id)&&i.a.debug.error("Overwrting another "+e.type+" element with the same name ("+e.id+")"),this.elements[e.type][e.id]=e}_getElement(e,t){if("string"!=typeof e||e.length<1||"string"!=typeof t||t.length<1)return i.a.debug.error("Attempted to get an invalid element",e,t);if(!this.elements.hasOwnProperty(t))return i.a.debug.error("Attempted to get an element of an invalid type ("+t+")",e);if(!this.elements[t].hasOwnProperty(e)){let n=[];for(let t in this.elements)this.elements[t].hasOwnProperty(e)&&n.push(t);return i.a.debug.error("No "+t+" element named &quot;"+e+"&quot; found",n.length?"Found &quot;"+e+"&quot; of type "+n.join(","):null)}return this.elements[t][e]}label(e){return this.useLabel=e,this}logAppend(e,t,n){return this.linesToSave.push(["PennController",this.id,e,t,Date.now(),n]),this}log(e,t){return null==t&&(t=e),this.appendResultLine.push([csv_url_encode(e),t]),this}noHeader(){return this.runHeader=!1,this}noFooter(){return this.runFooter=!1,this}setOption(e,t){return this[e]=t,this}}i.a.controllers.underConstruction=new u,i.a.controllers.new=(()=>new u);var h=function(...e){let t=i.a.controllers.underConstruction;if(window.items)for(let e in window.items)i.a.tmpItems.indexOf(window.items[e])<0&&i.a.tmpItems.push(window.items[e]);i.a.tmpItems.push(t),e.length&&"string"==typeof e[0]&&(t.useLabel=e[0]);let n=[];return function e(...t){for(let n in t)t[n]&&t[n]._promises?this.push(Object(r.d)(t[n]._promises)):t[n]&&t[n]instanceof Array&&e.apply(this,t[n])}.apply(n,e),t.sequence=Object(r.d)(n),i.a.controllers.underConstruction=new u,t};h.newTrial=h,h.Debug=function(e){i.a.debug.on=null==e||e},h.DebugOff=(()=>h.Debug(!1)),h.Sequence=function(...e){for(let t=0;t<e.length;t++)if(e[t]._item&&e[t]._item instanceof Array&&e[t]._item.length>1&&"__SendResults__"==e[t]._item[1]){let n="sendResults-"+Object(r.b)();e[t].label(n),e[t]=n}window.shuffleSequence=window.seq(...e)};let c={};h.GetURLParameter=function(e){if(!Object.keys(c).length){let e=window.location.search.replace("?","").split("&");for(let t in e)c[e[t].split("=")[0]]=e[t].split("=")[1]}if(c.hasOwnProperty(e))return c[e]},h.AddHost=function(...e){for(let t in e)"string"==typeof e[t]&&e[t].match(/^https?:\/\//i)?i.a.URLs.push(e[t]):i.a.debug.error("URL #"+t+" is not a valid URL (PennController.AddHost).",e[t])},h.CheckPreloaded=function(...e){let t=new u;t.id="Preloader-"+l.length,t.runHeader=!1,t.runFooter=!1,l.push(t),i.a.controllers.list.pop(),t.sequence=(()=>new Promise(e=>e())),t.ignoreWhenCheckingPreload=!0,i.a.tmpItems.push(t),e.length&&Number(e[e.length-1])>0&&(t.preloadDelay=Number(e[e.length-1]),e.pop());let n=[];if(e.length)for(let t in e){let i=e[t];"string"==typeof i&&(i=(n=>n==e[t])),i instanceof Function&&n.push(i)}else n=[e=>!0];return i.a.Prerun(()=>{let e=window.conf_modifyRunningOrder;window.conf_modifyRunningOrder=function(i){e instanceof Function&&(i=e.call(this,i));for(let e=0;e<i.length;e++){let r=i[e].filter(e=>{let t=!1;for(let i=0;i<n.length;i++)t=t||n[i](e.type);return t=(t=t&&"PennController"==e.controller)&&!e.options.ignoreWhenCheckingPreload});for(let e=0;e<r.length;e++)t.resources=t.resources.concat(r[e].options.resources.filter(e=>t.resources.indexOf(e)<0))}return i}}),t},h.SendResults=function(e){null==window.items&&(window.items=[]),null!=window.manualSendResults&&0==window.manualSendResults||(window.manualSendResults=!0);let t={},n=[e||"sendResults","__SendResults__",t],s=()=>new Promise(e=>{let t={_finishedCallback:()=>e(),_cssPrefix:"",_utils:i.a.controllers.running.utils},n=window.$("<p>").addClass("PennController-SendResults");i.a.controllers.running.element.append(n),addSafeBindMethodPair("__SendResults__"),n.__SendResults__(t)}),o={label:e=>(n[0]=e,o),setOption:(e,n)=>(t[e]=n,o)};return o._item=n,o.type="__SendResults__",o._element={id:"SendResults"},Object.defineProperty(o,"_promises",{get:()=>{let e=window.items.indexOf(n);return e>=0&&window.items.splice(e,1),[s]}}),Object.defineProperty(o,"_runPromises",{get:()=>{let e=window.items.indexOf(n);return e>=0&&window.items.splice(e,1),()=>Object(r.d)([s])()}}),window.items.push(n),o},h.SetCounter=function(...e){null==window.items&&(window.items=[]);let t="setCounter",n={};e.length&&(isNaN(Number(e[0]))?1==e.length?isNaN(Number(e[0]))?t=e[0]:n.set=Number(e[0]):2!=e.length||isNaN(Number(e[1]))?e.length>2&&!isNaN(Number(e[2]))?(t=e[0],e[1].match(/\s*inc\s*$/i)?n.inc=e[2]:n.set=e[2]):t=e[0]:e[0].match(/\s*inc\s*$/i)?n.inc=e[1]:(n.set=e[1],e[0].match(/\s*set\s*$/i)||(t=e[0])):n.set=Number(e[0]));let i=[t,"__SetCounter__",n];return n.label=(e=>(i[0]=e,n)),n.setOption=((e,t)=>(n[e]=t,n)),window.items.push(i),n},h.Header=function(...e){let t=i.a.controllers.underConstruction;t.id="Header",t.addToItems=!1,i.a.controllers.list.pop(),t.sequence=Object(r.d)(e.map(e=>Object(r.d)(e._promises)));for(let e in t.defaultCommands)for(let n in t.defaultCommands[e])t.defaultCommands[e][n].push("header");return o?(o.resources=o.resources.concat(t.resources),$.extend(!0,o.elements,t.elements),o.headerDefaultCommands=t.headerDefaultCommands,o.sequence=Object(r.d)([o.sequence,t.sequence])):o=t,i.a.controllers.underConstruction=new u,o},h.Footer=function(...e){let t=i.a.controllers.underConstruction;return t.id="Footer",t.addToItems=!1,i.a.controllers.list.pop(),t.sequence=Object(r.d)(e.map(e=>Object(r.d)(e._promises))),a?(a.resources=a.resources.concat(t.resources),$.extend(!0,a.elements,t.elements),a.headerDefaultCommands=t.headerDefaultCommands,a.sequence=Object(r.d)([a.sequence,t.sequence])):a=t,i.a.controllers.underConstruction=new u,a},define_ibex_controller({name:"PennController",jqueryWidget:{_init:function(){var e=this;i.a.controllers.running=e,e.cssPrefix=e.options._cssPrefix,e.utils=e.options._utils,e.finishedCallback=e.options._finishedCallback,e.id=e.options.id,"string"==typeof e.id&&e.id.match(/^Preloader-/)?e.controller=l[Number(e.id.replace(/Preloader-/,""))]:"Header"==e.id?e.controller=o:"Footer"==e.id?e.controller=a:Number(e.id)>=0&&Number(e.id)<i.a.controllers.list.length?e.controller=i.a.controllers.list[e.id]:e.controller=e.options,e.runHeader=null==e.controller.runHeader||e.controller.runHeader,e.runFooter=null==e.controller.runFooter||e.controller.runFooter,void 0===e.controller.appendResultLine&&(e.controller.appendResultLine=[]);let t=e.controller.preloadDelay;if(e.runHeader&&o instanceof u&&!e.controller.inheritedHeader){e.controller.resources=e.controller.resources.concat(o.resources.filter(t=>e.controller.resources.indexOf(t)<0)),$.extend(!0,e.controller.elements,o.elements);for(let t=0;t<o.appendResultLine.length;t++)e.controller.appendResultLine.unshift(o.appendResultLine[t]);e.controller.inheritedHeader=!0}if(e.runFooter&&a instanceof u&&!e.controller.inheritedFooter){e.controller.resources=e.controller.resources.concat(a.resources.filter(t=>e.controller.resources.indexOf(t)<0)),$.extend(!0,e.controller.elements,a.elements);for(let t=0;t<a.appendResultLine.length;t++)e.controller.appendResultLine.push(a.appendResultLine[t]);e.controller.inheritedFooter=!0}let n=[];e.save=function(t,i,r,s,o,...a){a.length||(a=["NULL"]);let l=[["PennElementType",t],["PennElementName",i],["Parameter",r],["Value",s],["EventTime",o]];for(let t=0;t<e.controller.appendResultLine.length;t++){let n=[e.controller.appendResultLine[t][0],e.controller.appendResultLine[t][1]];n instanceof Array&&2==n.length&&l.push(n)}l.push(["Comments",a.join(",")]),n.push(l)};for(let t in e.controller.linesToSave)e.save(e.controller.linesToSave[t]);let s=!1,h=async function(){if(!s){s=!0,e.runFooter&&a instanceof u&&(e.save("PennController",e.id,"_Footer_","Start",Date.now(),"NULL"),a._getElement=((t,n)=>e.controller._getElement(t,n)),await a.sequence(),e.save("PennController",e.id,"_Footer_","End",Date.now(),"NULL"));for(let t in e.controller.elements)for(let n in e.controller.elements[t])e.controller.elements[t][n].end();e.save("PennController",e.id,"_Trial_","End",Date.now(),"NULL"),n.sort((e,t)=>e[4][1]>t[4][1]),n.map(e=>{for(let t in e){e[t][1]instanceof Function&&(e[t][1]=e[t][1]());let n=[];for(;e[t][1].value&&e[t][1].value._element;)n.indexOf(e[t][1]._element)<0?(n.push(e[t][1]._element),e[t][1]=e[t][1].value):e[t][1]=e[t][1]._element.id;e[t][1]._element&&e[t][1]._element.id&&(e[t][1]=e[t][1]._element.value),e[t][1]=csv_url_encode(""+e[t][1])}}),e.finishedCallback(n)}};e.endTrial=h;let c=!1,d=async function(t){if(!c){if(c=!0,t)for(let t in e.controller.resources.filter(e=>"ready"!=e.status))e.save("PennController",e.id,"_PreloadFailed_",csv_url_encode(e.controller.resources[t].name),Date.now(),"NULL");f.remove(),e.save("PennController",e.id,"_Trial_","Start",Date.now(),"NULL"),e.runHeader&&o instanceof u&&(e.save("PennController",e.id,"_Header_","Start",Date.now(),"NULL"),await o.sequence(),e.save("PennController",e.id,"_Header_","End",Date.now(),"NULL")),e.controller.sequence().then(h)}},f=$("<div><p>Please wait while the resources are preloading</p><p>This may take up to "+Object(r.f)(t)+".</p></div>");e.element.append(f);for(let t in e.controller.resources){let n=e.controller.resources[t],i=n.resolve;"ready"!=n.status&&(n.resolve=function(){i.apply(n),0==e.controller.resources.filter(e=>"ready"!=e.status).length&&d()})}0==e.controller.resources.filter(e=>"ready"!=e.status).length?d():setTimeout(function(){d(!0)},t)}},properties:{obligatory:[],countsForProgressBar:!0,htmlDescription:null}}),window.PennController=new Proxy(h,{get:(e,t)=>{if(t in e)return e[t];i.a.debug.error("Unknown global PennController command: &lsquo;"+t+"&rsquo;")}})},function(e,t,n){"use strict";var i=n(5),r=n(35),s=n(17),o=n(76),a=n(13);function l(e){return e}function u(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}t.newBlob=function(e,n){t.checkSupport("blob");try{return new Blob([e],{type:n})}catch(t){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return i.append(e),i.getBlob(n)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var h={stringifyByChunk:function(e,t,n){var i=[],r=0,s=e.length;if(s<=n)return String.fromCharCode.apply(null,e);for(;r<s;)"array"===t||"nodebuffer"===t?i.push(String.fromCharCode.apply(null,e.slice(r,Math.min(r+n,s)))):i.push(String.fromCharCode.apply(null,e.subarray(r,Math.min(r+n,s)))),r+=n;return i.join("")},stringifyByChar:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&1===String.fromCharCode.apply(null,s.allocBuffer(1)).length}catch(e){return!1}}()}};function c(e){var n=65536,i=t.getTypeOf(e),r=!0;if("uint8array"===i?r=h.applyCanBeUsed.uint8array:"nodebuffer"===i&&(r=h.applyCanBeUsed.nodebuffer),r)for(;n>1;)try{return h.stringifyByChunk(e,i,n)}catch(e){n=Math.floor(n/2)}return h.stringifyByChar(e)}function d(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}t.applyFromCharCode=c;var f={};f.string={string:l,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return f.string.uint8array(e).buffer},uint8array:function(e){return u(e,new Uint8Array(e.length))},nodebuffer:function(e){return u(e,s.allocBuffer(e.length))}},f.array={string:c,array:l,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return s.newBufferFrom(e)}},f.arraybuffer={string:function(e){return c(new Uint8Array(e))},array:function(e){return d(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:l,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return s.newBufferFrom(new Uint8Array(e))}},f.uint8array={string:c,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:l,nodebuffer:function(e){return s.newBufferFrom(e)}},f.nodebuffer={string:c,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return f.nodebuffer.uint8array(e).buffer},uint8array:function(e){return d(e,new Uint8Array(e.length))},nodebuffer:l},t.transformTo=function(e,n){if(n||(n=""),!e)return n;t.checkSupport(e);var i=t.getTypeOf(n);return f[i][e](n)},t.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":i.nodebuffer&&s.isBuffer(e)?"nodebuffer":i.uint8array&&e instanceof Uint8Array?"uint8array":i.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},t.checkSupport=function(e){if(!i[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},t.MAX_VALUE_16BITS=65535,t.MAX_VALUE_32BITS=-1,t.pretty=function(e){var t,n,i="";for(n=0;n<(e||"").length;n++)i+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return i},t.delay=function(e,t,n){o(function(){e.apply(n||null,t||[])})},t.inherits=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n},t.extend=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},t.prepareContent=function(e,n,s,o,l){return a.Promise.resolve(n).then(function(e){return i.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new a.Promise(function(t,n){var i=new FileReader;i.onload=function(e){t(e.target.result)},i.onerror=function(e){n(e.target.error)},i.readAsArrayBuffer(e)}):e}).then(function(n){var h,c=t.getTypeOf(n);return c?("arraybuffer"===c?n=t.transformTo("uint8array",n):"string"===c&&(l?n=r.decode(n):s&&!0!==o&&(n=u(h=n,i.uint8array?new Uint8Array(h.length):new Array(h.length)))),n):a.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},function(e,t,n){"use strict";function i(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var e=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},e.exports=i},function(e,t,n){"use strict";(function(e){if(t.base64=!0,t.array=!0,t.string=!0,t.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,t.nodebuffer=void 0!==e,t.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)t.blob=!1;else{var i=new ArrayBuffer(0);try{t.blob=0===new Blob([i],{type:"application/zip"}).size}catch(e){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);r.append(i),t.blob=0===r.getBlob("application/zip").size}catch(e){t.blob=!1}}}try{t.nodestream=!!n(29).Readable}catch(e){t.nodestream=!1}}).call(this,n(11).Buffer)},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)r(n,i)&&(e[i]=n[i])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var s={arraySet:function(e,t,n,i,r){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+i),r);else for(var s=0;s<i;s++)e[r+s]=t[n+s]},flattenChunks:function(e){var t,n,i,r,s,o;for(i=0,t=0,n=e.length;t<n;t++)i+=e[t].length;for(o=new Uint8Array(i),r=0,t=0,n=e.length;t<n;t++)s=e[t],o.set(s,r),r+=s.length;return o}},o={arraySet:function(e,t,n,i,r){for(var s=0;s<i;s++)e[r+s]=t[n+s]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,s)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,o))},t.setTyped(i)},function(e,t,n){"use strict";var i=n(15),r=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=c;var s=n(12);s.inherits=n(10);var o=n(30),a=n(21);s.inherits(c,o);for(var l=r(a.prototype),u=0;u<l.length;u++){var h=l[u];c.prototype[h]||(c.prototype[h]=a.prototype[h])}function c(e){if(!(this instanceof c))return new c(e);o.call(this,e),a.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",d)}function d(){this.allowHalfOpen||this._writableState.ended||i.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),c.prototype._destroy=function(e,t){this.push(null),this.end(),i.nextTick(t,e)}},function(e,t,n){"use strict";for(var i=n(3),r=n(5),s=n(17),o=n(4),a=new Array(256),l=0;l<256;l++)a[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;a[254]=a[254]=1;function u(){o.call(this,"utf-8 decode"),this.leftOver=null}function h(){o.call(this,"utf-8 encode")}t.utf8encode=function(e){return r.nodebuffer?s.newBufferFrom(e,"utf-8"):function(e){var t,n,i,s,o,a=e.length,l=0;for(s=0;s<a;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(i=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(i-56320),s++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=r.uint8array?new Uint8Array(l):new Array(l),o=0,s=0;o<l;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(i=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(i-56320),s++),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t}(e)},t.utf8decode=function(e){return r.nodebuffer?i.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,n,r,s,o=e.length,l=new Array(2*o);for(n=0,t=0;t<o;)if((r=e[t++])<128)l[n++]=r;else if((s=a[r])>4)l[n++]=65533,t+=s-1;else{for(r&=2===s?31:3===s?15:7;s>1&&t<o;)r=r<<6|63&e[t++],s--;s>1?l[n++]=65533:r<65536?l[n++]=r:(r-=65536,l[n++]=55296|r>>10&1023,l[n++]=56320|1023&r)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),i.applyFromCharCode(l)}(e=i.transformTo(r.uint8array?"uint8array":"array",e))},i.inherits(u,o),u.prototype.processChunk=function(e){var n=i.transformTo(r.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var s=n;(n=new Uint8Array(s.length+this.leftOver.length)).set(this.leftOver,0),n.set(s,this.leftOver.length)}else n=this.leftOver.concat(n);this.leftOver=null}var o=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0?t:0===n?t:n+a[e[n]]>t?n:t}(n),l=n;o!==n.length&&(r.uint8array?(l=n.subarray(0,o),this.leftOver=n.subarray(o,n.length)):(l=n.slice(0,o),this.leftOver=n.slice(o,n.length))),this.push({data:t.utf8decode(l),meta:e.meta})},u.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:t.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},t.Utf8DecodeWorker=u,i.inherits(h,o),h.prototype.processChunk=function(e){this.push({data:t.utf8encode(e.data),meta:e.meta})},t.Utf8EncodeWorker=h},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var i=n(62),r=n(63),s=n(28);function o(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(o()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}return u(this,e,t,n)}function u(e,t,n,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i);l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=d(e,t);return e}(e,t,n,i):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|p(t,n),r=(e=a(e,i)).write(t,n);r!==i&&(e=e.slice(0,r));return e}(e,t,n):function(e,t){if(l.isBuffer(t)){var n=0|f(t.length);return 0===(e=a(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?a(e,0):d(e,t);if("Buffer"===t.type&&s(t.data))return d(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function h(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function c(e,t){if(h(t),e=a(e,t<0?0:0|f(t)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function d(e,t){var n=t.length<0?0:0|f(t.length);e=a(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function f(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function p(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return M(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return U(e).length;default:if(i)return M(e).length;t=(""+t).toLowerCase(),i=!0}}function m(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function g(e,t,n,i,r){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=l.from(t,i)),l.isBuffer(t))return 0===t.length?-1:y(e,t,n,i,r);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,i,r);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,i,r){var s,o=1,a=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;o=2,a/=2,l/=2,n/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(r){var h=-1;for(s=n;s<a;s++)if(u(e,s)===u(t,-1===h?0:s-h)){if(-1===h&&(h=s),s-h+1===l)return h*o}else-1!==h&&(s-=s-h),h=-1}else for(n+l>a&&(n=a-l),s=n;s>=0;s--){for(var c=!0,d=0;d<l;d++)if(u(e,s+d)!==u(t,d)){c=!1;break}if(c)return s}return-1}function b(e,t,n,i){n=Number(n)||0;var r=e.length-n;i?(i=Number(i))>r&&(i=r):i=r;var s=t.length;if(s%2!=0)throw new TypeError("Invalid hex string");i>s/2&&(i=s/2);for(var o=0;o<i;++o){var a=parseInt(t.substr(2*o,2),16);if(isNaN(a))return o;e[n+o]=a}return o}function v(e,t,n,i){return z(M(t,e.length-n),e,n,i)}function w(e,t,n,i){return z(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function _(e,t,n,i){return w(e,t,n,i)}function E(e,t,n,i){return z(U(t),e,n,i)}function k(e,t,n,i){return z(function(e,t){for(var n,i,r,s=[],o=0;o<e.length&&!((t-=2)<0);++o)n=e.charCodeAt(o),i=n>>8,r=n%256,s.push(r),s.push(i);return s}(t,e.length-n),e,n,i)}function C(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function x(e,t,n){n=Math.min(e.length,n);for(var i=[],r=t;r<n;){var s,o,a,l,u=e[r],h=null,c=u>239?4:u>223?3:u>191?2:1;if(r+c<=n)switch(c){case 1:u<128&&(h=u);break;case 2:128==(192&(s=e[r+1]))&&(l=(31&u)<<6|63&s)>127&&(h=l);break;case 3:s=e[r+1],o=e[r+2],128==(192&s)&&128==(192&o)&&(l=(15&u)<<12|(63&s)<<6|63&o)>2047&&(l<55296||l>57343)&&(h=l);break;case 4:s=e[r+1],o=e[r+2],a=e[r+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(l=(15&u)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&l<1114112&&(h=l)}null===h?(h=65533,c=1):h>65535&&(h-=65536,i.push(h>>>10&1023|55296),h=56320|1023&h),i.push(h),r+=c}return function(e){var t=e.length;if(t<=P)return String.fromCharCode.apply(String,e);var n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=P));return n}(i)}t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=o(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,n){return u(null,e,t,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,n){return function(e,t,n,i){return h(t),t<=0?a(e,t):void 0!==n?"string"==typeof i?a(e,t).fill(n,i):a(e,t).fill(n):a(e,t)}(null,e,t,n)},l.allocUnsafe=function(e){return c(null,e)},l.allocUnsafeSlow=function(e){return c(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,r=0,s=Math.min(n,i);r<s;++r)if(e[r]!==t[r]){n=e[r],i=t[r];break}return n<i?-1:i<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!s(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=l.allocUnsafe(t),r=0;for(n=0;n<e.length;++n){var o=e[n];if(!l.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(i,r),r+=o.length}return i},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?x(this,0,e):function(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return T(this,t,n);case"utf8":case"utf-8":return x(this,t,n);case"ascii":return j(this,t,n);case"latin1":case"binary":return S(this,t,n);case"base64":return C(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,n,i,r){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),t<0||n>e.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&t>=n)return 0;if(i>=r)return-1;if(t>=n)return 1;if(this===e)return 0;for(var s=(r>>>=0)-(i>>>=0),o=(n>>>=0)-(t>>>=0),a=Math.min(s,o),u=this.slice(i,r),h=e.slice(t,n),c=0;c<a;++c)if(u[c]!==h[c]){s=u[c],o=h[c];break}return s<o?-1:o<s?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},l.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return v(this,e,t,n);case"ascii":return w(this,e,t,n);case"latin1":case"binary":return _(this,e,t,n);case"base64":return E(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,e,t,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var P=4096;function j(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(127&e[r]);return i}function S(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(e[r]);return i}function T(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var r="",s=t;s<n;++s)r+=F(e[s]);return r}function O(e,t,n){for(var i=e.slice(t,n),r="",s=0;s<i.length;s+=2)r+=String.fromCharCode(i[s]+256*i[s+1]);return r}function A(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function Q(e,t,n,i,r,s){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<s)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function R(e,t,n,i){t<0&&(t=65535+t+1);for(var r=0,s=Math.min(e.length-n,2);r<s;++r)e[n+r]=(t&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function N(e,t,n,i){t<0&&(t=4294967295+t+1);for(var r=0,s=Math.min(e.length-n,4);r<s;++r)e[n+r]=t>>>8*(i?r:3-r)&255}function L(e,t,n,i,r,s){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function D(e,t,n,i,s){return s||L(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function I(e,t,n,i,s){return s||L(e,0,n,8),r.write(e,t,n,i,52,8),n+8}l.prototype.slice=function(e,t){var n,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=l.prototype;else{var r=t-e;n=new l(r,void 0);for(var s=0;s<r;++s)n[s]=this[s+e]}return n},l.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var i=this[e],r=1,s=0;++s<t&&(r*=256);)i+=this[e+s]*r;return i},l.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var i=this[e+--t],r=1;t>0&&(r*=256);)i+=this[e+--t]*r;return i},l.prototype.readUInt8=function(e,t){return t||A(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||A(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||A(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||A(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||A(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var i=this[e],r=1,s=0;++s<t&&(r*=256);)i+=this[e+s]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*t)),i},l.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var i=t,r=1,s=this[e+--i];i>0&&(r*=256);)s+=this[e+--i]*r;return s>=(r*=128)&&(s-=Math.pow(2,8*t)),s},l.prototype.readInt8=function(e,t){return t||A(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||A(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){t||A(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return t||A(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||A(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||A(e,4,this.length),r.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||A(e,4,this.length),r.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||A(e,8,this.length),r.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||A(e,8,this.length),r.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,i){(e=+e,t|=0,n|=0,i)||Q(this,e,t,n,Math.pow(2,8*n)-1,0);var r=1,s=0;for(this[t]=255&e;++s<n&&(r*=256);)this[t+s]=e/r&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,i){(e=+e,t|=0,n|=0,i)||Q(this,e,t,n,Math.pow(2,8*n)-1,0);var r=n-1,s=1;for(this[t+r]=255&e;--r>=0&&(s*=256);)this[t+r]=e/s&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||Q(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||Q(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||Q(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||Q(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):N(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||Q(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);Q(this,e,t,n,r-1,-r)}var s=0,o=1,a=0;for(this[t]=255&e;++s<n&&(o*=256);)e<0&&0===a&&0!==this[t+s-1]&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+n},l.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);Q(this,e,t,n,r-1,-r)}var s=n-1,o=1,a=0;for(this[t+s]=255&e;--s>=0&&(o*=256);)e<0&&0===a&&0!==this[t+s+1]&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||Q(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||Q(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||Q(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||Q(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):N(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||Q(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,n){return D(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return D(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return I(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return I(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,i){if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var r,s=i-n;if(this===e&&n<t&&t<i)for(r=s-1;r>=0;--r)e[r+t]=this[r+n];else if(s<1e3||!l.TYPED_ARRAY_SUPPORT)for(r=0;r<s;++r)e[r+t]=this[r+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+s),t);return s},l.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var r=e.charCodeAt(0);r<256&&(e=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var s;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(s=t;s<n;++s)this[s]=e;else{var o=l.isBuffer(e)?e:M(new l(e,i).toString()),a=o.length;for(s=0;s<n-t;++s)this[s+t]=o[s%a]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function F(e){return e<16?"0"+e.toString(16):e.toString(16)}function M(e,t){var n;t=t||1/0;for(var i=e.length,r=null,s=[],o=0;o<i;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===i){(t-=3)>-1&&s.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&s.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&s.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;s.push(n)}else if(n<2048){if((t-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function U(e){return i.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(B,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function z(e,t,n,i){for(var r=0;r<i&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}}).call(this,n(6))},function(e,t,n){(function(e){function n(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===n(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===n(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===n(e)},t.isError=function(e){return"[object Error]"===n(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=e.isBuffer}).call(this,n(11).Buffer)},function(e,t,n){"use strict";var i=null;i="undefined"!=typeof Promise?Promise:n(90),e.exports={Promise:i}},function(e,t){var n,i,r=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}}();var l,u=[],h=!1,c=-1;function d(){h&&l&&(h=!1,l.length?u=l.concat(u):c=-1,u.length&&f())}function f(){if(!h){var e=a(d);h=!0;for(var t=u.length;t;){for(l=u,u=[];++c<t;)l&&l[c].run();c=-1,t=u.length}l=null,h=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||h||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,n){"use strict";(function(t){!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports={nextTick:function(e,n,i,r){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var s,o,a=arguments.length;switch(a){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick(function(){e.call(null,n)});case 3:return t.nextTick(function(){e.call(null,n,i)});case 4:return t.nextTick(function(){e.call(null,n,i,r)});default:for(s=new Array(a-1),o=0;o<s.length;)s[o++]=arguments[o];return t.nextTick(function(){e.apply(null,s)})}}}:e.exports=t}).call(this,n(14))},function(e,t,n){var i=n(11),r=i.Buffer;function s(e,t){for(var n in e)t[n]=e[n]}function o(e,t,n){return r(e,t,n)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=i:(s(i,t),t.Buffer=o),s(r,o),o.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return r(e,t,n)},o.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=r(e);return void 0!==t?"string"==typeof n?i.fill(t,n):i.fill(t):i.fill(0),i},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},function(e,t,n){"use strict";(function(t){e.exports={isNode:void 0!==t,newBufferFrom:function(e,n){return new t(e,n)},allocBuffer:function(e){return t.alloc?t.alloc(e):new t(e)},isBuffer:function(e){return t.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}}).call(this,n(11).Buffer)},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){"use strict";var i,r="object"==typeof Reflect?Reflect:null,s=r&&"function"==typeof r.apply?r.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};i=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var l=10;function u(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function h(e,t,n,i){var r,s,o,a;if("function"!=typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n);if(void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),o=s[t]),void 0===o)o=s[t]=n,++e._eventsCount;else if("function"==typeof o?o=s[t]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),(r=u(e))>0&&o.length>r&&!o.warned){o.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=o.length,a=l,console&&console.warn&&console.warn(a)}return e}function c(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,s(this.listener,this.target,e))}.bind(i);return r.listener=n,i.wrapFn=r,r}function d(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):p(r,r.length)}function f(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return u(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=r[e];if(void 0===l)return!1;if("function"==typeof l)s(l,this,t);else{var u=l.length,h=p(l,u);for(n=0;n<u;++n)s(h[n],this,t)}return!0},a.prototype.addListener=function(e,t){return h(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return h(this,e,t,!0)},a.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,c(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,c(this,e,t)),this},a.prototype.removeListener=function(e,t){var n,i,r,s,o;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){o=n[s].listener,r=s;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,o||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,s=Object.keys(n);for(i=0;i<s.length;++i)"removeListener"!==(r=s[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},a.prototype.listeners=function(e){return d(this,e,!0)},a.prototype.rawListeners=function(e){return d(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},a.prototype.listenerCount=f,a.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},function(e,t,n){(t=e.exports=n(30)).Stream=t,t.Readable=t,t.Writable=n(21),t.Duplex=n(8),t.Transform=n(34),t.PassThrough=n(71)},function(e,t,n){"use strict";(function(t,i,r){var s=n(15);function o(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var i=e.entry;e.entry=null;for(;i;){var r=i.callback;t.pendingcb--,r(n),i=i.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=b;var a,l=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?i:s.nextTick;b.WritableState=y;var u=n(12);u.inherits=n(10);var h={deprecate:n(70)},c=n(31),d=n(16).Buffer,f=r.Uint8Array||function(){};var p,m=n(32);function g(){}function y(e,t){a=a||n(8),e=e||{};var i=t instanceof a;this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,u=e.writableHighWaterMark,h=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:i&&(u||0===u)?u:h,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var c=!1===e.decodeStrings;this.decodeStrings=!c,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,i=n.sync,r=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,i,r){--t.pendingcb,n?(s.nextTick(r,i),s.nextTick(C,e,t),e._writableState.errorEmitted=!0,e.emit("error",i)):(r(i),e._writableState.errorEmitted=!0,e.emit("error",i),C(e,t))}(e,n,i,t,r);else{var o=E(n);o||n.corked||n.bufferProcessing||!n.bufferedRequest||_(e,n),i?l(w,e,n,o,r):w(e,n,o,r)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function b(e){if(a=a||n(8),!(p.call(b,this)||this instanceof a))return new b(e);this._writableState=new y(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),c.call(this)}function v(e,t,n,i,r,s,o){t.writelen=i,t.writecb=o,t.writing=!0,t.sync=!0,n?e._writev(r,t.onwrite):e._write(r,s,t.onwrite),t.sync=!1}function w(e,t,n,i){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,i(),C(e,t)}function _(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var i=t.bufferedRequestCount,r=new Array(i),s=t.corkedRequestsFree;s.entry=n;for(var a=0,l=!0;n;)r[a]=n,n.isBuf||(l=!1),n=n.next,a+=1;r.allBuffers=l,v(e,t,!0,t.length,r,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new o(t),t.bufferedRequestCount=0}else{for(;n;){var u=n.chunk,h=n.encoding,c=n.callback;if(v(e,t,!1,t.objectMode?1:u.length,u,h,c),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function E(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function k(e,t){e._final(function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),C(e,t)})}function C(e,t){var n=E(t);return n&&(!function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,s.nextTick(k,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}u.inherits(b,c),y.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(y.prototype,"buffer",{get:h.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(p=Function.prototype[Symbol.hasInstance],Object.defineProperty(b,Symbol.hasInstance,{value:function(e){return!!p.call(this,e)||this===b&&(e&&e._writableState instanceof y)}})):p=function(e){return e instanceof this},b.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},b.prototype.write=function(e,t,n){var i,r=this._writableState,o=!1,a=!r.objectMode&&(i=e,d.isBuffer(i)||i instanceof f);return a&&!d.isBuffer(e)&&(e=function(e){return d.from(e)}(e)),"function"==typeof t&&(n=t,t=null),a?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof n&&(n=g),r.ended?function(e,t){var n=new Error("write after end");e.emit("error",n),s.nextTick(t,n)}(this,n):(a||function(e,t,n,i){var r=!0,o=!1;return null===n?o=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),s.nextTick(i,o),r=!1),r}(this,r,e,n))&&(r.pendingcb++,o=function(e,t,n,i,r,s){if(!n){var o=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=d.from(t,n));return t}(t,i,r);i!==o&&(n=!0,r="buffer",i=o)}var a=t.objectMode?1:i.length;t.length+=a;var l=t.length<t.highWaterMark;l||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:r,isBuf:n,callback:s,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else v(e,t,!1,a,i,r,s);return l}(this,r,a,e,t,n)),o},b.prototype.cork=function(){this._writableState.corked++},b.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||_(this,e))},b.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(b.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),b.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},b.prototype._writev=null,b.prototype.end=function(e,t,n){var i=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||function(e,t,n){t.ending=!0,C(e,t),n&&(t.finished?s.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,i,n)},Object.defineProperty(b.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),b.prototype.destroy=m.destroy,b.prototype._undestroy=m.undestroy,b.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,n(14),n(68).setImmediate,n(6))},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=!n(38)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,n){"use strict";var i=n(13),r=n(42),s=n(43),o=n(44);s=n(43);function a(e,t,n,i,r){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=i,this.compressedContent=r}a.prototype={getContentWorker:function(){var e=new r(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new s("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new r(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},a.createWorkerFrom=function(e,t,n){return e.pipe(new o).pipe(new s("uncompressedSize")).pipe(t.compressWorker(n)).pipe(new s("compressedSize")).withStreamInfo("compression",t)},e.exports=a},function(e,t,n){"use strict";var i=n(3);var r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();e.exports=function(e,t){return void 0!==e&&e.length?"string"!==i.getTypeOf(e)?function(e,t,n,i){var s=r,o=i+n;e^=-1;for(var a=i;a<o;a++)e=e>>>8^s[255&(e^t[a])];return-1^e}(0|t,e,e.length,0):function(e,t,n,i){var s=r,o=i+n;e^=-1;for(var a=i;a<o;a++)e=e>>>8^s[255&(e^t.charCodeAt(a))];return-1^e}(0|t,e,e.length,0):0}},function(e,t,n){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(e,t,n){"use strict";var i={};function r(){try{return new window.XMLHttpRequest}catch(e){}}i._getBinaryFromXHR=function(e){return e.response||e.responseText};var s=window.ActiveXObject?function(){return r()||function(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}()}:r;i.getBinaryContent=function(e,t){try{var n=s();n.open("GET",e,!0),"responseType"in n&&(n.responseType="arraybuffer"),n.overrideMimeType&&n.overrideMimeType("text/plain; charset=x-user-defined"),n.onreadystatechange=function(r){var s,o;if(4===n.readyState)if(200===n.status||0===n.status){s=null,o=null;try{s=i._getBinaryFromXHR(n)}catch(e){o=new Error(e)}t(o,s)}else t(new Error("Ajax error for "+e+" : "+this.status+" "+this.statusText),null)},n.send()}catch(e){t(new Error(e),null)}},e.exports=i},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){e.exports=n(64)},function(e,t,n){"use strict";(function(t,i){var r=n(15);e.exports=v;var s,o=n(28);v.ReadableState=b;n(19).EventEmitter;var a=function(e,t){return e.listeners(t).length},l=n(31),u=n(16).Buffer,h=t.Uint8Array||function(){};var c=n(12);c.inherits=n(10);var d=n(65),f=void 0;f=d&&d.debuglog?d.debuglog("stream"):function(){};var p,m=n(66),g=n(32);c.inherits(v,l);var y=["error","close","destroy","pause","resume"];function b(e,t){e=e||{};var i=t instanceof(s=s||n(8));this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,o=e.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:i&&(o||0===o)?o:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(p||(p=n(33).StringDecoder),this.decoder=new p(e.encoding),this.encoding=e.encoding)}function v(e){if(s=s||n(8),!(this instanceof v))return new v(e);this._readableState=new b(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),l.call(this)}function w(e,t,n,i,r){var s,o=e._readableState;null===t?(o.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,C(e)}(e,o)):(r||(s=function(e,t){var n;i=t,u.isBuffer(i)||i instanceof h||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));var i;return n}(o,t)),s?e.emit("error",s):o.objectMode||t&&t.length>0?("string"==typeof t||o.objectMode||Object.getPrototypeOf(t)===u.prototype||(t=function(e){return u.from(e)}(t)),i?o.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):_(e,o,t,!0):o.ended?e.emit("error",new Error("stream.push() after EOF")):(o.reading=!1,o.decoder&&!n?(t=o.decoder.write(t),o.objectMode||0!==t.length?_(e,o,t,!1):P(e,o)):_(e,o,t,!1))):i||(o.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(o)}function _(e,t,n,i){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&C(e)),P(e,t)}Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),v.prototype.destroy=g.destroy,v.prototype._undestroy=g.undestroy,v.prototype._destroy=function(e,t){this.push(null),t(e)},v.prototype.push=function(e,t){var n,i=this._readableState;return i.objectMode?n=!0:"string"==typeof e&&((t=t||i.defaultEncoding)!==i.encoding&&(e=u.from(e,t),t=""),n=!0),w(this,e,t,!1,n)},v.prototype.unshift=function(e){return w(this,e,null,!0,!1)},v.prototype.isPaused=function(){return!1===this._readableState.flowing},v.prototype.setEncoding=function(e){return p||(p=n(33).StringDecoder),this._readableState.decoder=new p(e),this._readableState.encoding=e,this};var E=8388608;function k(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=E?e=E:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function C(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(f("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?r.nextTick(x,e):x(e))}function x(e){f("emit readable"),e.emit("readable"),O(e)}function P(e,t){t.readingMore||(t.readingMore=!0,r.nextTick(j,e,t))}function j(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(f("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function S(e){f("readable nexttick read 0"),e.read(0)}function T(e,t){t.reading||(f("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),O(e),t.flowing&&!t.reading&&e.read(0)}function O(e){var t=e._readableState;for(f("flow",t.flowing);t.flowing&&null!==e.read(););}function A(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var i;e<t.head.data.length?(i=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):i=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,i=1,r=n.data;e-=r.length;for(;n=n.next;){var s=n.data,o=e>s.length?s.length:e;if(o===s.length?r+=s:r+=s.slice(0,e),0===(e-=o)){o===s.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=s.slice(o));break}++i}return t.length-=i,r}(e,t):function(e,t){var n=u.allocUnsafe(e),i=t.head,r=1;i.data.copy(n),e-=i.data.length;for(;i=i.next;){var s=i.data,o=e>s.length?s.length:e;if(s.copy(n,n.length-e,0,o),0===(e-=o)){o===s.length?(++r,i.next?t.head=i.next:t.head=t.tail=null):(t.head=i,i.data=s.slice(o));break}++r}return t.length-=r,n}(e,t);return i}(e,t.buffer,t.decoder),n);var n}function Q(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,r.nextTick(R,t,e))}function R(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function N(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1}v.prototype.read=function(e){f("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return f("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?Q(this):C(this),null;if(0===(e=k(e,t))&&t.ended)return 0===t.length&&Q(this),null;var i,r=t.needReadable;return f("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&f("length less than watermark",r=!0),t.ended||t.reading?f("reading or ended",r=!1):r&&(f("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=k(n,t))),null===(i=e>0?A(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&Q(this)),null!==i&&this.emit("data",i),i},v.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},v.prototype.pipe=function(e,t){var n=this,s=this._readableState;switch(s.pipesCount){case 0:s.pipes=e;break;case 1:s.pipes=[s.pipes,e];break;default:s.pipes.push(e)}s.pipesCount+=1,f("pipe count=%d opts=%j",s.pipesCount,t);var l=(!t||!1!==t.end)&&e!==i.stdout&&e!==i.stderr?h:v;function u(t,i){f("onunpipe"),t===n&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,f("cleanup"),e.removeListener("close",y),e.removeListener("finish",b),e.removeListener("drain",c),e.removeListener("error",g),e.removeListener("unpipe",u),n.removeListener("end",h),n.removeListener("end",v),n.removeListener("data",m),d=!0,!s.awaitDrain||e._writableState&&!e._writableState.needDrain||c())}function h(){f("onend"),e.end()}s.endEmitted?r.nextTick(l):n.once("end",l),e.on("unpipe",u);var c=function(e){return function(){var t=e._readableState;f("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,O(e))}}(n);e.on("drain",c);var d=!1;var p=!1;function m(t){f("ondata"),p=!1,!1!==e.write(t)||p||((1===s.pipesCount&&s.pipes===e||s.pipesCount>1&&-1!==N(s.pipes,e))&&!d&&(f("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,p=!0),n.pause())}function g(t){f("onerror",t),v(),e.removeListener("error",g),0===a(e,"error")&&e.emit("error",t)}function y(){e.removeListener("finish",b),v()}function b(){f("onfinish"),e.removeListener("close",y),v()}function v(){f("unpipe"),n.unpipe(e)}return n.on("data",m),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?o(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",g),e.once("close",y),e.once("finish",b),e.emit("pipe",n),s.flowing||(f("pipe resume"),n.resume()),e},v.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n),this);if(!e){var i=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<r;s++)i[s].emit("unpipe",this,n);return this}var o=N(t.pipes,e);return-1===o?this:(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n),this)},v.prototype.on=function(e,t){var n=l.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&C(this):r.nextTick(S,this))}return n},v.prototype.addListener=v.prototype.on,v.prototype.resume=function(){var e=this._readableState;return e.flowing||(f("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,r.nextTick(T,e,t))}(this,e)),this},v.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this},v.prototype.wrap=function(e){var t=this,n=this._readableState,i=!1;for(var r in e.on("end",function(){if(f("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(r){(f("wrapped data"),n.decoder&&(r=n.decoder.write(r)),n.objectMode&&null==r)||(n.objectMode||r&&r.length)&&(t.push(r)||(i=!0,e.pause()))}),e)void 0===this[r]&&"function"==typeof e[r]&&(this[r]=function(t){return function(){return e[t].apply(e,arguments)}}(r));for(var s=0;s<y.length;s++)e.on(y[s],this.emit.bind(this,y[s]));return this._read=function(t){f("wrapped _read",t),i&&(i=!1,e.resume())},this},Object.defineProperty(v.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),v._fromList=A}).call(this,n(6),n(14))},function(e,t,n){e.exports=n(19).EventEmitter},function(e,t,n){"use strict";var i=n(15);function r(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var n=this,s=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;return s||o?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||i.nextTick(r,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(i.nextTick(r,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t&&t(e)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,n){"use strict";var i=n(16).Buffer,r=i.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(i.isEncoding===r||!r(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=u,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=h,this.end=c,t=3;break;default:return this.write=d,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(t)}function o(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var i=n.charCodeAt(n.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function h(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function c(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.StringDecoder=s,s.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},s.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},s.prototype.text=function(e,t){var n=function(e,t,n){var i=t.length-1;if(i<n)return 0;var r=o(t[i]);if(r>=0)return r>0&&(e.lastNeed=r-1),r;if(--i<n||-2===r)return 0;if((r=o(t[i]))>=0)return r>0&&(e.lastNeed=r-2),r;if(--i<n||-2===r)return 0;if((r=o(t[i]))>=0)return r>0&&(2===r?r=0:e.lastNeed=r-3),r;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var i=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,n){"use strict";e.exports=o;var i=n(8),r=n(12);function s(e,t){var n=this._transformState;n.transforming=!1;var i=n.writecb;if(!i)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=t&&this.push(t),i(e);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}function o(e){if(!(this instanceof o))return new o(e);i.call(this,e),this._transformState={afterTransform:s.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",a)}function a(){var e=this;"function"==typeof this._flush?this._flush(function(t,n){l(e,t,n)}):l(this,null,null)}function l(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}r.inherits=n(10),r.inherits(o,i),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,i.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},o.prototype._write=function(e,t,n){var i=this._transformState;if(i.writecb=n,i.writechunk=e,i.writeencoding=t,!i.transforming){var r=this._readableState;(i.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},o.prototype._destroy=function(e,t){var n=this;i.prototype._destroy.call(this,e,function(e){t(e),n.emit("close")})}},function(e,t,n){"use strict";var i=n(3),r=n(5),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.encode=function(e){for(var t,n,r,o,a,l,u,h=[],c=0,d=e.length,f=d,p="string"!==i.getTypeOf(e);c<e.length;)f=d-c,p?(t=e[c++],n=c<d?e[c++]:0,r=c<d?e[c++]:0):(t=e.charCodeAt(c++),n=c<d?e.charCodeAt(c++):0,r=c<d?e.charCodeAt(c++):0),o=t>>2,a=(3&t)<<4|n>>4,l=f>1?(15&n)<<2|r>>6:64,u=f>2?63&r:64,h.push(s.charAt(o)+s.charAt(a)+s.charAt(l)+s.charAt(u));return h.join("")},t.decode=function(e){var t,n,i,o,a,l,u=0,h=0;if("data:"===e.substr(0,"data:".length))throw new Error("Invalid base64 input, it looks like a data url.");var c,d=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(e.charAt(e.length-1)===s.charAt(64)&&d--,e.charAt(e.length-2)===s.charAt(64)&&d--,d%1!=0)throw new Error("Invalid base64 input, bad content length.");for(c=r.uint8array?new Uint8Array(0|d):new Array(0|d);u<e.length;)t=s.indexOf(e.charAt(u++))<<2|(o=s.indexOf(e.charAt(u++)))>>4,n=(15&o)<<4|(a=s.indexOf(e.charAt(u++)))>>2,i=(3&a)<<6|(l=s.indexOf(e.charAt(u++))),c[h++]=t,64!==a&&(c[h++]=n),64!==l&&(c[h++]=i);return c}},function(e,t){var n=e.exports={version:"2.3.0"};"number"==typeof __e&&(__e=n)},function(e,t,n){var i=n(79);e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var i=n(22),r=n(18).document,s=i(r)&&i(r.createElement);e.exports=function(e){return s?r.createElement(e):{}}},function(e,t,n){"use strict";(function(t){var i=n(3),r=n(92),s=n(4),o=n(35),a=n(5),l=n(13),u=null;if(a.nodestream)try{u=n(93)}catch(e){}function h(e,n){return new l.Promise(function(r,s){var a=[],l=e._internalType,u=e._outputType,h=e._mimeType;e.on("data",function(e,t){a.push(e),n&&n(t)}).on("error",function(e){a=[],s(e)}).on("end",function(){try{var e=function(e,t,n){switch(e){case"blob":return i.newBlob(i.transformTo("arraybuffer",t),n);case"base64":return o.encode(t);default:return i.transformTo(e,t)}}(u,function(e,n){var i,r=0,s=null,o=0;for(i=0;i<n.length;i++)o+=n[i].length;switch(e){case"string":return n.join("");case"array":return Array.prototype.concat.apply([],n);case"uint8array":for(s=new Uint8Array(o),i=0;i<n.length;i++)s.set(n[i],r),r+=n[i].length;return s;case"nodebuffer":return t.concat(n);default:throw new Error("concat : unsupported type '"+e+"'")}}(l,a),h);r(e)}catch(e){s(e)}a=[]}).resume()})}function c(e,t,n){var o=t;switch(t){case"blob":case"arraybuffer":o="uint8array";break;case"base64":o="string"}try{this._internalType=o,this._outputType=t,this._mimeType=n,i.checkSupport(o),this._worker=e.pipe(new r(o)),e.lock()}catch(e){this._worker=new s("error"),this._worker.error(e)}}c.prototype={accumulate:function(e){return h(this,e)},on:function(e,t){var n=this;return"data"===e?this._worker.on(e,function(e){t.call(n,e.data,e.meta)}):this._worker.on(e,function(){i.delay(t,arguments,n)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(i.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:"nodebuffer"!==this._outputType},e)}},e.exports=c}).call(this,n(11).Buffer)},function(e,t,n){"use strict";t.base64=!1,t.binary=!1,t.dir=!1,t.createFolders=!0,t.date=null,t.compression=null,t.compressionOptions=null,t.comment=null,t.unixPermissions=null,t.dosPermissions=null},function(e,t,n){"use strict";var i=n(3),r=n(4);function s(e){r.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=i.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}i.inherits(s,r),s.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},e.exports=s},function(e,t,n){"use strict";var i=n(3),r=n(4);function s(e){r.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}i.inherits(s,r),s.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}r.prototype.processChunk.call(this,e)},e.exports=s},function(e,t,n){"use strict";var i=n(4),r=n(25);function s(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n(3).inherits(s,i),s.prototype.processChunk=function(e){this.streamInfo.crc32=r(e.data,this.streamInfo.crc32||0),this.push(e)},e.exports=s},function(e,t,n){"use strict";var i=n(4);t.STORE={magic:"\0\0",compressWorker:function(e){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},t.DEFLATE=n(96)},function(e,t,n){"use strict";e.exports=function(e,t,n,i){for(var r=65535&e|0,s=e>>>16&65535|0,o=0;0!==n;){n-=o=n>2e3?2e3:n;do{s=s+(r=r+t[i++]|0)|0}while(--o);r%=65521,s%=65521}return r|s<<16|0}},function(e,t,n){"use strict";var i=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();e.exports=function(e,t,n,r){var s=i,o=r+n;e^=-1;for(var a=r;a<o;a++)e=e>>>8^s[255&(e^t[a])];return-1^e}},function(e,t,n){"use strict";var i=n(7),r=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(e){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){s=!1}for(var o=new i.Buf8(256),a=0;a<256;a++)o[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1;function l(e,t){if(t<65534&&(e.subarray&&s||!e.subarray&&r))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var n="",o=0;o<t;o++)n+=String.fromCharCode(e[o]);return n}o[254]=o[254]=1,t.string2buf=function(e){var t,n,r,s,o,a=e.length,l=0;for(s=0;s<a;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(r=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(r-56320),s++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new i.Buf8(l),o=0,s=0;o<l;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(r=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(r-56320),s++),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},t.buf2binstring=function(e){return l(e,e.length)},t.binstring2buf=function(e){for(var t=new i.Buf8(e.length),n=0,r=t.length;n<r;n++)t[n]=e.charCodeAt(n);return t},t.buf2string=function(e,t){var n,i,r,s,a=t||e.length,u=new Array(2*a);for(i=0,n=0;n<a;)if((r=e[n++])<128)u[i++]=r;else if((s=o[r])>4)u[i++]=65533,n+=s-1;else{for(r&=2===s?31:3===s?15:7;s>1&&n<a;)r=r<<6|63&e[n++],s--;s>1?u[i++]=65533:r<65536?u[i++]=r:(r-=65536,u[i++]=55296|r>>10&1023,u[i++]=56320|1023&r)}return l(u,i)},t.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0?t:0===n?t:n+o[e[n]]>t?n:t}},function(e,t,n){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(e,t,n){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(e,t,n){"use strict";t.LOCAL_FILE_HEADER="PK",t.CENTRAL_FILE_HEADER="PK",t.CENTRAL_DIRECTORY_END="PK",t.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",t.ZIP64_CENTRAL_DIRECTORY_END="PK",t.DATA_DESCRIPTOR="PK\b"},function(e,t,n){"use strict";var i=n(3),r=n(5),s=n(53),o=n(110),a=n(111),l=n(55);e.exports=function(e){var t=i.getTypeOf(e);return i.checkSupport(t),"string"!==t||r.uint8array?"nodebuffer"===t?new a(e):r.uint8array?new l(i.transformTo("uint8array",e)):new s(i.transformTo("array",e)):new o(e)}},function(e,t,n){"use strict";var i=n(54);function r(e){i.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}n(3).inherits(r,i),r.prototype.byteAt=function(e){return this.data[this.zero+e]},r.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),i=e.charCodeAt(2),r=e.charCodeAt(3),s=this.length-4;s>=0;--s)if(this.data[s]===t&&this.data[s+1]===n&&this.data[s+2]===i&&this.data[s+3]===r)return s-this.zero;return-1},r.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),i=e.charCodeAt(2),r=e.charCodeAt(3),s=this.readData(4);return t===s[0]&&n===s[1]&&i===s[2]&&r===s[3]},r.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=r},function(e,t,n){"use strict";var i=n(3);function r(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}r.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return i.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readAndCheckSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},e.exports=r},function(e,t,n){"use strict";var i=n(53);function r(e){i.call(this,e)}n(3).inherits(r,i),r.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=r},function(e,t,n){(function(n){var i,r,s;r=[],void 0===(s="function"==typeof(i=function(){"use strict";function t(e,t,n){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){o(i.response,t,n)},i.onerror=function(){console.error("could not download file")},i.send()}function i(e){var t=new XMLHttpRequest;return t.open("HEAD",e,!1),t.send(),200<=t.status&&299>=t.status}function r(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var s="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,o=s.saveAs||"object"!=typeof window||window!==s?function(){}:"download"in HTMLAnchorElement.prototype?function(e,n,o){var a=s.URL||s.webkitURL,l=document.createElement("a");n=n||e.name||"download",l.download=n,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?r(l):i(l.href)?t(e,n,o):r(l,l.target="_blank")):(l.href=a.createObjectURL(e),setTimeout(function(){a.revokeObjectURL(l.href)},4e4),setTimeout(function(){r(l)},0))}:"msSaveOrOpenBlob"in navigator?function(e,n,s){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Depricated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,s),n);else if(i(e))t(e,n,s);else{var o=document.createElement("a");o.href=e,o.target="_blank",setTimeout(function(){r(o)})}}:function(e,n,i,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,i);var o="application/octet-stream"===e.type,a=/constructor/i.test(s.HTMLElement)||s.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||o&&a)&&"object"==typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=l?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=e:location=e,r=null},u.readAsDataURL(e)}else{var h=s.URL||s.webkitURL,c=h.createObjectURL(e);r?r.location=c:location.href=c,r=null,setTimeout(function(){h.revokeObjectURL(c)},4e4)}};s.saveAs=o.saveAs=o,e.exports=o})?i.apply(t,r):i)||(e.exports=s)}).call(this,n(6))},function(e,t,n){"use strict";var i=n(0),r=n(1);class s{constructor(e,t,n,i,r){let s=this;this.title=e,this.width=t,this.height=n,this.x=i,this.y=r,this.tabs=[],this.container=$("<div>").css({width:t,height:n,position:"fixed","border-radius":"5px","background-color":"floralwhite","min-height":"2em","min-width":"3em"}),this.titleBar=$("<div>").css({width:"100%",height:"1.5em",margin:0,padding:0,"background-color":"gray",cursor:"move",color:"white","border-radius":"5px 5px 0px 0px"}),this.titleSpan=$("<span>"+e+"</span>").css({display:"inline-block",padding:"2px","line-height":"1.3em",overflow:"hidden"}),this.titleBar.append(this.titleSpan).append($("<span>X</span>").css({width:"1.3em",height:"1.3em",margin:"0.1em","line-height":"1.3em","border-radius":"2px","text-align":"center",position:"absolute",right:0,cursor:"pointer",overflow:"hidden"}).click(function(){s.popOut()}).mouseenter(function(){$(this).css({border:"solid 1px lightgray","border-radius":"2px"})}).mouseleave(function(){$(this).css({border:"none"})})).mousedown(function(e){s.updatePosition=!0,s.offsetX=e.clientX-s.x,s.offsetY=e.clientY-s.y,e.preventDefault()}),this.tabBar=$("<div>").css({width:"calc(100% - 10px)",height:"1.5em","margin-bottom":"0px",overflow:"hidden",display:"flex","margin-left":"5px","margin-right":"5px"}),this.tabBar.append($("<div>").css({width:"100%","border-bottom":"solid 1px lightgray"})),this.newTab=((e,t)=>{e instanceof jQuery||(e=$("<span>").append(e)),t instanceof jQuery||(t=$("<div>").append(t));let n={title:e,content:t,jQuery:$("<div>").append(e).css({border:"solid 1px lightgray","border-top-right-radius":"5px","border-top-left-radius":"5px","padding-left":"5px","padding-right":"5px",cursor:"pointer"}).click(()=>{this.content.children().detach(),this.content.append(n.content),this.tabBar.children().css({background:"linen",color:"darkgray","border-bottom":"solid 1px lightgray"}),n.jQuery.css({color:"black",background:"inherit","border-bottom":"none"})}),remove:()=>this.jQuery.remove()};return this.tabs.push(n),this.tabBar.prepend(n.jQuery),n.jQuery.click(),n}),this.container.append($("<div>").css({display:"inline-block",width:"1.3em",height:"1.3em",position:"absolute",bottom:0,right:0,cursor:"se-resize",background:"repeating-linear-gradient(135deg,rgba(255,255,255,.5),rgba(255,255,255,.5) 2px,#777 2px,#777 4px)","clip-path":"polygon(90% 0,90% 90%,0 90%)",opacity:"0.5"}).mousedown(function(e){s.updateSize=!0,s.offsetRight=e.clientX-(s.x+s.width),s.offsetBottom=e.clientY-(s.y+s.height),e.preventDefault()})),this.content=$("<div>").css({border:"solid 1px lightgray","font-family":"monospace","font-size":"0.9em",margin:"0px 5px 5px 5px",padding:"2px",height:"calc(100% - 4.5em - 30px)",overflow:"auto","border-top":"none"}),this.container.append(this.titleBar),this.container.append($("<div>Use <tt>DebugOff()</tt> before publishing.</div>").css({height:"1.5em","overflow-x":"hidden"})),this.container.append(this.tabBar),this.container.append(this.content),this.container.css({left:i,top:r}),$(document).mousemove(function(e){s.updatePosition&&(s.x=e.clientX-s.offsetX,s.y=e.clientY-s.offsetY,s.container.css({left:s.x,top:s.y})),s.updateSize&&(s.width=e.clientX-s.x-s.offsetRight,s.height=e.clientY-s.y-s.offsetBottom,s.container.css({width:s.width,height:s.height}))}).mouseup(function(){s.updatePosition=!1,s.updateSize=!1})}popIn(){$(document.body).append(this.container)}popOut(){this.container.detach()}}let o=!1,a={popin:{},tablePopin:{},infoTab:null,runningOrder:null,runningIndex:-1,runningElement:-1,currentController:null,currentTable:null};i.a.debug={on:!0,currentPromise:null,forceResolve:()=>{i.a.debug.currentPromise instanceof Function&&i.a.debug.currentPromise()},addToTab:(e,...t)=>{if(!i.a.debug.on)return;let n;null==(n=i.a.controllers.running?i.a.controllers.list[i.a.controllers.running.id]:i.a.controllers.underConstruction)&&(n={id:"NA"});let r=new Date;e.prepend($("<div>["+[r.getHours(),r.getMinutes(),r.getSeconds()].join(":")+"] "+t.join(";")+" (PennController: "+n.id+")</div>").css({"border-bottom":"dotted 1px gray","margin-bottom":"1px","padding-bottom":"1px"}))},log:(...e)=>i.a.debug.addToTab(a.logTab.log,...e),error:(...e)=>{i.a.debug.on&&(i.a.debug.addToTab(a.errorsTab.content,...e),a.errorsTab.title.css("color","red"),a.errorsTab.content.find(".PennController-debug-noerrors").css("display","none"))}},a.popin=new s("Debug (PennController 1.8-dev)",440,240,window.innerWidth-450,window.innerHeight-250),a.logTab=a.popin.newTab("Log"),a.logTab.controls=$("<div>").append($("<button>Next screen</button>").click(()=>a.currentController._finishedCallback())).append($("<button>Next command</button>").click(()=>i.a.debug.forceResolve())).css({background:"lightgray","border-bottom":"dotted 1px black"}).appendTo(a.logTab.content),a.logTab.log=$("<div>").appendTo(a.logTab.content),a.errorsTab=a.popin.newTab("Errors"),a.errorsTab.content.prepend($("<div>No errors found</div>").css({"font-style":"italic","text-align":"center",margin:"5px"}).addClass("PennController-debug-noerrors"));let l=()=>{a.currentTable&&a.currentTable.debug&&(a.currentTable.debug.content.find("tr").css("background-color","transparent"),$(a.currentTable.debug.content.find("tr")[a.currentRow+1]).css("background-color","pink"),a.tablePopin.titleSpan.after(u),a.currentTable.hasOwnProperty("group")&&a.currentTable.table[0].hasOwnProperty(a.currentTable.group)&&u.after(c))},u=$("<a title='Jump to current row'>&#9755;</a>").click(function(){a.currentTable.debug.jQuery.click();let e=$(a.currentTable.debug.content.find("tr")[a.currentRow+1]).position().top;a.currentTable.debug.content.children()[2].scrollTop+=e}).css({display:"inline-block",padding:"2px 5px","line-height":"1.3em",overflow:"hidden"}),h=!1,c=$("<a title='Show/Hide rows from other groups'>&#128065;</a>").click(function(){if(h)a.currentTable.debug.content.find("tr").css("display","table-row");else{let e=a.currentTable.table[a.currentRow][a.currentTable.group],t=a.currentTable.debug.content.find("tr");for(let n=0;n<a.currentTable.table.length;n++)a.currentTable.table[n][a.currentTable.group]!=e&&$(t[n+1]).css("display","none")}h=!h}).css({display:"inline-block",padding:"4px 5px 0px 5px","line-height":"1.3em",overflow:"hidden"}),d=e=>{let t=Object.keys(e.table[0]),n=$("<table>").css({display:"table","table-layout":"fixed",height:"100%",width:70*(t.length+1)}),i=$("<table>").css({display:"table","table-layout":"fixed",height:"100%",width:70*(t.length+1)}),r=$("<tr>");r.append($("<th>").html("<em>#</em>").css({width:70,overflow:"hidden"}));for(let e=0;e<t.length;e++)r.append($("<th>").html(t[e]).css({width:70,overflow:"hidden"}));i.append(r);for(let i=0;i<e.table.length;i++){let r=$("<tr>");r.append($("<td>").html("<em>"+Number(i+1)+".</em>").css({width:70,overflow:"hidden"}));for(let n=0;n<t.length;n++)r.append($("<td>").html(e.table[i][t[n]]).css({width:70,overflow:"hidden"}));n.append(r)}let s=$("<div>").css({height:"calc(100% - 1.5em)",overflow:"auto"}).append(n),o=$("<div>").css({height:"1.5em",width:"100%"}),a=$("<div>").css({width:"100%",position:"absolute",left:0,top:0}).append(i);return s.scroll(()=>a.css("margin-left",-1*s[0].scrollLeft)),$("<div>").css({width:"100%",height:"100%","white-space":"nowrap",position:"relative",overflow:"hidden"}).append(a).append(o).append(s)},f=e=>{if(a.tablePopin.hasOwnProperty("container"))a.tablePopin.container.parent().length>0?a.tablePopin.tabs[e].jQuery.click():$(document.body).append(a.tablePopin.container);else{a.tablePopin=new s("Tables",window.innerWidth-320,190,10,window.innerHeight-200);let t=Object.keys(i.a.tables);for(let e=0;e<t.length;e++)i.a.tables[t[e]].debug=a.tablePopin.newTab(t[e],d(i.a.tables[t[e]]));a.tablePopin.content.css("overflow","hidden"),a.tablePopin.tabs[e].jQuery.click()}l()},p=()=>{if(a.runningIndex<0)a.runningIndex=0;else if(i.a.debug.on){let e=$(a.sequenceTab.content.find("li")[a.runningIndex]);e.css("color","gray"),e.find("button").attr("disabled",!0)}if(a.runningElement<0?a.runningElement=0:(a.runningElement++,a.runningElement>=a.runningOrder[a.runningIndex].length&&(a.runningElement=0,a.runningIndex++)),"__SendResults__"==a.runningOrder[a.runningIndex][a.runningElement].controller&&(o=!0),!i.a.debug.on)return void(window.items=void 0);if(u.detach(),c.detach(),a.currentTable=null,a.currentTableName="<em>NA</em>",a.currentRow=-1,a.currentController=a.runningOrder[a.runningIndex][a.runningElement].options,a.currentController.hasOwnProperty("_PennController")){a.currentTable=a.currentController._PennController.table;for(let e in i.a.tables)i.a.tables[e]==a.currentTable&&(a.currentTableName=e);a.currentRow=Number(a.currentController._PennController.row),l()}let e=a.runningOrder[a.runningIndex][a.runningElement];a.infoTab.content.empty(),a.infoTab.content.append($("<div><strong>Trial in sequence</strong> "+Number(a.runningIndex+1)+" / "+a.runningOrder.length+"</div>")).append($("<div><strong>Element in trial</strong> "+Number(a.runningElement+1)+" / "+a.runningOrder[a.runningIndex].length+"</div>")).append($("<div><strong>Trial's label:</strong> "+e.type+"</div>")).append($("<div><strong>Trial's type (controller):</strong> "+e.controller+"</div>")).append($("<div><strong>Trial's index:</strong> "+e.itemNumber+" / "+window.items.length+"</div>")).append($("<div><strong>From table:</strong> "+a.currentTableName+"</div>")),a.sequenceTab.content.find("li").css("background-color","transparent"),$(a.sequenceTab.content.find("li")[a.runningIndex]).css("background-color","pink"),"PennController"==e.controller?$(a.logTab.controls.children()[1]).css("display","inline-block"):$(a.logTab.controls.children()[1]).css("display","none")},m=window.dget;window.dget=((...e)=>{let t=m(...e);return e[1]&&"displayMode"==e[1]&&e[2]&&"overwrite"==e[2]&&p(),t});let g=window.$.ajax;window.$.ajax=((...e)=>(i.a.debug.on&&e[0]&&e[0].url&&e[0].url.match(/\?allchunks=1$/)&&a.popin.popIn(),g(...e))),i.a.Prerun(()=>{window.onbeforeunload=function(){if(!o)return"Your results have not been sent yet. Do you really want to leave the page?"};let e=!1;PennController.version="1.8-dev";let t=window.assert;window.assert=function(...n){if(e||"There must be some items in the running order!"!=n[1])return t.apply(this,n);e=!0;let r=window.conf_modifyRunningOrder;return window.conf_modifyRunningOrder=function(e){return r instanceof Function?a.runningOrder=r.call(this,e):a.runningOrder=e,i.a.debug.on&&(()=>{let e=Object.keys(i.a.tables);if(e.length>0){let t=$("<ul>");for(let n=0;n<e.length;n++)t.append($("<li>").html(e[n]).click(()=>f(n)).css("cursor","pointer"));a.popin.newTab("Tables",t)}a.sequenceTab=a.popin.newTab("Sequence"),a.infoTab=a.popin.newTab("Info");let t=e=>{a.runningIndex<e&&(a.currentController._finishedCallback(),setTimeout(()=>t(e),1))},n=$("<ol>");for(let e=0;e<a.runningOrder.length;e++){let i=a.runningOrder[e],r=[];for(let e=0;e<i.length;e++)r.push(i[e].controller);let s=[];i[0].options.hasOwnProperty("_PennController")&&(s=[":",i[0].options._PennController.table.id,i[0].options._PennController.row+1]);let o=i[0].type+" ("+r.join(",")+s.join(":")+")";n.append($("<li>").append(o).append($("<button>Reach</button>").click(()=>t(e))))}a.sequenceTab.content.append(n),a.errorsTab.jQuery.click(),$(window.document).bind("keyup keydown",function(e){if(e.ctrlKey&&68==e.keyCode){let e=window.innerWidth-450,t=window.innerHeight-250;$(window.document.body).append(a.popin.container),a.popin.x=e,a.popin.y=t,a.popin.container.css({top:t,left:e})}})})(),p(),a.runningOrder},t.apply(this,n)}}),window.onerror=function(e,t,n){if(!t.match(/include=data$/))return;let s=e.match(/ReferenceError: (.+) is not defined/);if(s)if(s[1].match(/^(new|get|default)/)&&PennController.Elements[s[1]])i.a.debug.error("Tried to use &lsquo;"+s[1]+"&rsquo; without a prefix on line "+n+"; did you forget to use PennController.ResetPrefix?");else{let e={score:1,command:""},t=Object.getOwnPropertyNames(PennController.Elements);for(let n=0;n<t.length;n++){let i=Object(r.e)(s[1],t[n])/s[1].length;i<e.score&&(e.score=i,e.command=t[n])}e.score<.5?i.a.debug.error("Wrong command &lsquo;"+s[1]+"&rsquo; on line "+n+". Did you mean to type &lsquo;<strong>"+e.command+"</strong>&rsquo;?"):i.a.debug.error("Unrecognized expression &lsquo;"+s[1]+"&rsquo; (line "+n+")")}else i.a.debug.error(e)};let y=window.ibex_controller_get_property;window.ibex_controller_get_property=((e,t)=>{let n=Object.getOwnPropertyNames($.ui);if(n.indexOf(e)>-1)return y(e,t);let s={score:1,controllerName:""};for(let t=0;t<n.length;t++){let i=Object(r.e)(e,n[t])/e.length;i<s.score&&(s.score=i,s.controllerName=n[t])}s.score<.5?i.a.debug.error("Invalid controller reference: &lsquo;"+e+"&rsquo;---Did you mean to type <strong>"+s.controllerName+"</strong>?"):i.a.debug.error("Invalid controller reference: &lsquo;"+e+"&rsquo;")})},function(e,t,n){"use strict";var i=n(1),r=n(2),s=n(0);r.b.Elements={};let o=function(e){return function(...t){let n=this;return new Promise(function(i){let r=s.a.controllers.running;s.a.debug.currentPromise=i;for(let e in t)t[e]instanceof h&&"Var"==t[e].type&&!t[e]._promises.length&&(t[e]._runPromises(),t[e]=t[e]._element.evaluate());e.apply(n,[(...e)=>s.a.controllers.running!=r||i(...e)].concat(t))})}},a=function(e){let t=[],n=()=>new Promise(e=>e()),r=()=>new Promise(e=>e()),o=function(...i){let o=this;return new Promise(async function(a){let l=s.a.controllers.running;s.a.debug.currentPromise=a;let u=(...e)=>s.a.controllers.running!=l||a(...e);for(let e=0;e<i.length;e++)i[e]instanceof h&&"Var"==i[e].type&&!i[e]._promises.length&&(i[e]._runPromises(),i[e]=i[e]._element.evaluate());let c=e.apply(o,i),d="and";for(let e=0;e<t.length;e++){let n=t[e];"and"==n?d="and":"or"==n?d="or":n&&n._runPromises&&n.success&&(n="success"==await n._runPromises(),"and"==d?c=c&&n:"or"==d&&(c=c||n))}c?(await n(),u("success")):(await r(),u("failure"))})};return o.and=(e=>{t.push("and"),t.push(e)}),o.or=(e=>{t.push("or"),t.push(e)}),o.success=((...e)=>n=Object(i.d)(e.map(e=>()=>e._runPromises()))),o.failure=((...e)=>r=Object(i.d)(e.map(e=>()=>e._runPromises()))),o};class l{constructor(e,t,n){let i=$("<PennElement>"),r=i.css,o=[];i.css=((...e)=>{o.push(e),r.apply(i,e)});let a=!1;Object.defineProperty(this,"jQueryElement",{set:function(t){if(!(t instanceof jQuery))return s.a.debug.error("Tried to assign a non jQuery element to PennElement named "+e);if(a)return i=t;let n=i.data("events");n&&$.each(n,function(){$.each(this,function(){t.bind(this.type,this.handler)})});for(let e in o)t.css(...o[e]);i=t,a=!0},get:function(){return i}}),this.jQueryContainer=$("<div>"),this.id=e,this.type=t,this.validate=(()=>this.hasValidated=!0),this._printCallback=[],n.hasOwnProperty("end")&&(this.end=function(){n.end.apply(this)})}}let u=(e,t,n,r)=>{let o="",a=e.replace(/^\.(settings|testNot|test)\./,"");Object(i.e)(a,"settings")/"settings".length<.5&&(o=" Did you mean to type &lsquo;<strong>settings</strong>&rsquo;?"),Object(i.e)(a,"test")/"test".length<.5&&(o=" Did you mean to type &lsquo;<strong>test</strong>&rsquo;?"),Object(i.e)(a,"testNot")/"testNot".length<.5&&(o=" Did you mean to type &lsquo;<strong>testNot</strong>&rsquo;?");let l={score:1,command:""};for(let e=0;e<r.length;e++){let t=Object(i.e)(a,r[e])/a.length;t<l.score&&(l.score=t,l.command=r[e])}l.score<.5&&(o=" Did you mean to type <strong>"+e.replace(a,l.command)+"</strong>?"),s.a.debug.error("Command &lsquo;"+e+"&rsquo; unknown on "+t+" element &lsquo;"+n+"&rsquo;."+o)};class h{constructor(e,t){let n=new Proxy(this,{get:(e,i)=>{if(i in this)return e[i];{if("_runPromises"==i)return()=>this._runPromises.call(this);let e;try{e=this[i]}catch(e){return u(i,this.type,this._element.id,Object.getOwnPropertyNames(t.actions)),n}return void 0===e&&"string"==typeof i&&"nodeType"!=i&&u(i,this.type,this._element.id,Object.getOwnPropertyNames(t.actions)),e}}});if(this._proxy=n,e instanceof l)n._element=e;else if("string"==typeof e){let i;i=s.a.controllers.running?s.a.controllers.list[s.a.controllers.running.id]:s.a.controllers.underConstruction,Object.defineProperty(n,"_element",{get:()=>i._getElement(e,t.name)})}n.type=t.name,n._promises=[];for(let e in t.actions)n[e]=function(...r){let a=o(function(...o){s.a.debug.on&&s.a.debug.log("<div style='color: lightsalmon'>"+n._element.id+" ("+t.name+") Action command '"+e+"' running, params: "+JSON.stringify(Object(i.h)(r))+"</div>"),t.actions[e].apply(this,o)});return n._promises.push(()=>a.apply(n._element,r)),n};n.settings=new Proxy({},{get:(e,n)=>{if(n in e)return e[n];u(".settings."+n,this.type,this._element.id,Object.getOwnPropertyNames(t.settings))}});for(let e in t.settings)n.settings[e]=function(...r){let a=o(function(...o){s.a.debug.on&&s.a.debug.log("<div style='color: salmon'>"+n._element.id+" ("+t.name+") Settings command '"+e+"' running, params: "+JSON.stringify(Object(i.h)(r))+"</div>"),t.settings[e].apply(this,o)});return n._promises.push(()=>a.apply(n._element,r)),n};n.test=new Proxy({},{get:(e,n)=>{if(n in e)return e[n];u(".test."+n,this.type,this._element.id,Object.getOwnPropertyNames(t.test))}}),n.testNot=new Proxy({},{get:(e,n)=>{if(n in e)return e[n];u(".testNot."+n,this.type,this._element.id,Object.getOwnPropertyNames(t.test))}});for(let e in t.test)n.test[e]=function(...r){let o=a(function(...o){return s.a.debug.on&&s.a.debug.log("<div style='color: darksalmon'>"+n._element.id+" ("+t.name+") Test command '"+e+"' running, params: "+JSON.stringify(Object(i.h)(r))+"</div>"),t.test[e].apply(this,o)});return n._promises.push(()=>o.apply(n._element,r)),n.success=((...e)=>(o.success.apply(n._element,e),n)),n.failure=((...e)=>(o.failure.apply(n._element,e),n)),n.and=(e=>(o.and.call(n._element,e),n)),n.or=(e=>(o.or.call(n._element,e),n)),n},n.testNot[e]=function(...r){let o=a(function(...n){return s.a.debug.on&&s.a.debug.log(t.name+" testNot command "+e+" running, params: "+JSON.stringify(Object(i.h)(r))),!t.test[e].apply(this,n)});return n._promises.push(()=>o.apply(n._element,r)),n.success=((...e)=>(o.success.apply(n._element,e),n)),n.failure=((...e)=>(o.failure.apply(n._element,e),n)),n.and=(e=>(o.and.call(n._element,e),n)),n.or=(e=>(o.or.call(n._element,e),n)),n};t.value&&Object.defineProperty(n,"value",{get:()=>t.value.apply(n._element)})}_runPromises(){return Object(i.d)(this._promises)()}}let c={actions:{print:async function(e,t,n,o){if(o&&"string"==typeof o&&(o=r.b.Elements.getCanvas(o)),o&&o instanceof h&&"Canvas"==o.type)o.settings.add(t,n,r.b.Elements["get"+this.type](this.id))._runPromises().then(()=>e());else{if(this.jQueryElement&&this.jQueryElement instanceof jQuery){this.jQueryContainer.detach(),this.jQueryContainer.empty(),this.jQueryElement.addClass("PennController-"+this.type.replace(/[\s_]/g,"")),this.jQueryElement.addClass("PennController-"+this.id.replace(/[\s_]/g,""));let e=this.jQueryContainer;if(e.css("display","inherit"),"string"==typeof this.jQueryAlignment&&e.css("text-align",this.jQueryAlignment),e.addClass("PennController-elementContainer").addClass("PennController-"+this.type.replace(/[\s_]+/g,"")+"-container").addClass("PennController-"+this.id.replace(/[\s_]+/g,"")+"-container").append(this.jQueryElement),t instanceof jQuery)t.append(e);else if(n){e.appendTo($("body")).css("display","inline-block");let r=Object(i.g)(t,n,e);e.css({position:"absolute",left:r.x,top:r.y})}else s.a.controllers.running.element.append(e.css("width","100%"));if(this.cssContainer instanceof Array&&this.cssContainer.length)for(let t=0;t<this.cssContainer.length;t++)e.css.apply(e,this.cssContainer[t]);e.css({"min-width":this.jQueryElement.width(),"min-height":this.jQueryElement.height()});let r=$("<div>").css("display","inline-block").addClass("PennController-before").addClass("PennController-"+this.type.replace(/[\s_]/g,"")+"-before").addClass("PennController-"+this.id.replace(/[\s_]/g,"")+"-before"),o=$("<div>").css("display","inline-block").addClass("PennController-after").addClass("PennController-"+this.type.replace(/[\s_]/g,"")+"-after").addClass("PennController-"+this.id.replace(/[\s_]/g,"")+"-after");this.jQueryElement.before(r),this.jQueryElement.after(o);for(let e in this.jQueryBefore)this.jQueryBefore[e]&&this.jQueryBefore[e]._element&&await new Promise(t=>c.actions.print.call(this.jQueryBefore[e]._element,t,r));for(let e in this.jQueryAfter)this.jQueryAfter[e]&&this.jQueryAfter[e]._element&&await new Promise(t=>c.actions.print.call(this.jQueryAfter[e]._element,t,o))}else s.a.debug.error("No jQuery instance to print for element "+this.id);this.printTime=Date.now();for(let e=0;e<this._printCallback.length;e++)this._printCallback[e]instanceof Function&&await this._printCallback[e].call(this);e()}},refresh:function(e){let t=this.jQueryElement.parent();if(!(t instanceof jQuery&&t.parent().length))return e();let n=$("<span>");t.before(n),r.b.Elements["get"+this.type](this.id).print(n)._runPromises().then(()=>{n.before(this.jQueryElement.parent()),n.remove(),e()})},remove:function(e){if(this.jQueryContainer instanceof jQuery&&this.jQueryContainer.detach(),this.jQueryElement instanceof jQuery?this.jQueryElement.detach():s.a.debug.error("No jQuery instance to remove for element "+this.id),this.jQueryBefore&&this.jQueryBefore.length)for(let e in this.jQueryBefore)this.jQueryBefore[e]._element&&this.jQueryBefore[e]._element.jQueryElement instanceof jQuery&&this.jQueryBefore[e]._element.jQueryElement.detach();if(this.jQueryAfter&&this.jQueryAfter.length)for(let e in this.jQueryAfter)this.jQueryAfter[e]._element&&this.jQueryAfter[e]._element.jQueryElement instanceof jQuery&&this.jQueryAfter[e]._element.jQueryElement.detach();e()},wait:function(e,t){if("first"==t&&this.hasValidated)e();else{let n=!1,i=this.validate;if(this.validate=(()=>{if(i.apply(this),!n)if(t instanceof Object&&t._runPromises&&t.success){let i=this.disabled;this.jQueryElement.attr("disabled",!0),this.disabled="tmp",t._runPromises().then(t=>{"success"==t&&(n=!0,e()),"tmp"==this.disabled&&(this.disabled=i,this.jQueryElement.attr("disabled",i))})}else n=!0,e()}),"number"==typeof t&&t>0){let e=Date.now(),t=()=>{Date.now()-e<=0?this.validate():window.requestAnimationFrame(t)};window.requestAnimationFrame(t)}}}},settings:{after:function(e,t){t._element&&t._element.jQueryElement instanceof jQuery?(this.jQueryElement instanceof jQuery&&this.jQueryElement.printed()&&t.print(this.jQueryContainer.find(".PennController-"+this.type+"-after")),t._runPromises().then(()=>{this.jQueryAfter.push(t),e()})):(s.a.debug.error("Tried to add an invalid element after element named "+this.id),e())},before:function(e,t){t._element&&t._element.jQueryElement instanceof jQuery?(this.jQueryElement instanceof jQuery&&this.jQueryElement.printed()&&t.print(this.jQueryContainer.find(".PennController-"+this.type+"-before")),t._runPromises().then(()=>{this.jQueryBefore.push(t),e()})):(s.a.debug.error("Tried to add an invalid element before element named "+this.id),e())},bold:function(e){this.jQueryElement instanceof jQuery?this.jQueryElement.css("font-weight","bold"):s.a.debug.error("Element named "+this.id+" has not jQuery element to render as bold"),e()},center:function(e){this.jQueryElement instanceof jQuery?(this.jQueryElement.css({"text-align":"center",margin:"auto"}),this.jQueryAlignment="center",this.jQueryElement.parent().length&&this.jQueryContainer.css("text-align","center")):s.a.debug.error("Element named "+this.id+" has not jQuery element to render as centered"),e()},color:function(e,t){this.jQueryElement&&"string"==typeof t?this.jQueryElement.css("color",t):s.a.debug.error("Element named "+this.id+" has not jQuery element to render as "+t),e()},cssContainer:function(e,...t){this.cssContainer||(this.cssContainer=[]),this.cssContainer.push(t),this.jQueryContainer.printed()&&this.jQueryContainer.css(...t),e()},css:function(e,...t){this.jQueryElement instanceof jQuery?this.jQueryElement.css(...t):s.a.debug.error("Element named "+this.id+" has not jQuery element on which to apply the CSS"),e()},disable:function(e){this.hasOwnProperty("jQueryElement")&&this.jQueryElement instanceof jQuery?this.jQueryElement.attr("disabled",!0).addClass("PennController-disabled"):s.a.debug.error("No jQuery instance to disable for element "+this.id),e()},enable:function(e){this.hasOwnProperty("jQueryElement")&&this.jQueryElement instanceof jQuery?this.jQueryElement.removeAttr("disabled").removeClass("PennController-disabled"):s.a.debug.error("No jQuery instance to enable for element "+this.id),e()},hidden:function(e){this.hasOwnProperty("jQueryElement")&&this.jQueryElement instanceof jQuery?this.jQueryElement.css({visibility:"hidden"}):s.a.debug.error("No jQuery instance to hide for element "+this.id),e()},italic:function(e){this.jQueryElement instanceof jQuery?this.jQueryElement.css("font-style","italic"):s.a.debug.error("Element named "+this.id+" has not jQuery element to render in italic"),e()},left:function(e){this.jQueryElement instanceof jQuery?(this.jQueryElement.css("text-align","left"),this.jQueryAlignment="left",this.jQueryElement.parent().length&&this.jQueryContainer.css("text-align","left")):s.a.debug.error("Element named "+this.id+" has not jQuery element to render as aligned to the left"),e()},log:function(e,t){this.log=void 0===t||t,e()},once:function(e){if(this.hasValidated)this.disabled=!0,this.jQueryElement.attr("disabled",!0);else{let e=this.validate;this.validate=(()=>{e.apply(this),this.disabled=!0,this.jQueryElement.attr("disabled",!0)})}e()},right:function(e){this.jQueryElement instanceof jQuery?(this.jQueryElement.css("text-align","right"),this.jQueryAlignment="right",this.jQueryElement.parent().length&&this.jQueryContainer.css("text-align","right")):s.a.debug.error("Element named "+this.id+" has not jQuery element to render as aligned to the right"),e()},size:function(e,t,n){if(this.jQueryElement instanceof jQuery){if(this.jQueryElement.width(t),this.jQueryElement.height(n),this.jQueryContainer&&this.jQueryContainer.parent().length){let e=this.jQueryElement.width(),t=this.jQueryElement.height();e>this.jQueryContainer.width()&&this.jQueryContainer.width(e),e>this.jQueryContainer.height()&&this.jQueryContainer.height(t)}}else s.a.debug.error("Element named "+this.id+" has not jQuery element to render as aligned to the right");e()},visible:function(e){this.hasOwnProperty("jQueryElement")&&this.jQueryElement instanceof jQuery?this.jQueryElement.css({visibility:"visible"}):s.a.debug.error("No jQuery instance to make visible for element "+this.id),e()}},test:{printed:function(){return!!(this.hasOwnProperty("jQueryElement")&&this.jQueryElement instanceof jQuery)&&this.jQueryElement.printed()}}};s.a.elements.standardCommands=c,r.b.Elements.fullscreen=function(){return{_promises:[()=>new Promise(function(e){document.documentElement.requestFullscreen().then(e).catch(e)})],_runPromises:()=>Object(i.d)(this._promises)()}},r.b.Elements.exitFullscreen=function(){return{_promises:[()=>new Promise(function(e){document.exitFullscreen().then(e).catch(e)})],_runPromises:()=>Object(i.d)(this._promises)()}},r.b.Elements.clear=function(){let e={_element:$("<p></p>"),_promises:[()=>new Promise(async function(e){let t=s.a.controllers.list[s.a.controllers.running.id];for(let e in t.elements)for(let n in t.elements[e]){let i=t.elements[e][n],s=r.b.Elements["get"+i.type](i.id);await s.remove()._runPromises()}e()})],_runPromises:()=>Object(i.d)(e._promises)()};return e},r.b.Elements.end=function(){let e={_element:$("<p></p>"),_promises:[()=>new Promise(async function(e){await s.a.controllers.running.endTrial(),e()})],_runPromises:()=>Object(i.d)(e._promises)()};return e};let d={};r.b._AddElementType=function(e,t){d.hasOwnProperty(e)&&s.a.debug.error("Element type "+e+" defined more than once"),d[e]=function(t){let n=new t(s.a);n.hasOwnProperty("actions")||(n.actions={}),n.hasOwnProperty("settings")||(n.settings={}),n.hasOwnProperty("test")||(n.test={});for(let e in c.actions)n.actions.hasOwnProperty(e)||(n.actions[e]=c.actions[e]);for(let e in c.settings)n.settings.hasOwnProperty(e)||(n.settings[e]=c.settings[e]);for(let e in c.test)n.test.hasOwnProperty(e)||(n.test[e]=c.test[e]);for(let e in n.settings)n.actions.hasOwnProperty(e)||(n.actions[e]=n.settings[e]);let i=n.uponCreation;n.uponCreation=function(e){this.jQueryAfter=[],this.jQueryBefore=[],this.jQueryElement&&this.jQueryElement instanceof jQuery&&this.jQueryElement.removeAttr("style"),this.jQuerycontainer&&this.jQueryContainer instanceof jQuery&&(this.jQuerycontainer=$("<div>")),i instanceof Function?i.apply(this,[e]):e()};let r=n.end;return n.end=function(){this.jQueryElement instanceof jQuery&&this.jQueryElement.remove();for(let e in this.jQueryBefore)this.jQueryBefore[e]._element&&this.jQueryBefore[e]._element.jQueryElement instanceof jQuery&&this.jQueryBefore[e]._element.jQueryElement.remove();for(let e in this.jQueryAfter)this.jQueryAfter[e]._element&&this.jQueryAfter[e]._element.jQueryElement instanceof jQuery&&this.jQueryAfter[e]._element.jQueryElement.remove();this.jQueryContainer instanceof jQuery&&this.jQueryContainer.remove(),r instanceof Function&&r.apply(this)},n.name=e,n}(t),r.b.Elements["new"+e]=function(...t){for(let e in t)t[e]instanceof h&&"Var"==t[e].type&&!t[e]._promises.length&&(t[e]=t[e]._element.evaluate());let n=d[e],i=s.a.controllers.underConstruction;s.a.controllers.running&&(i=s.a.controllers.list[s.a.controllers.running.id]);let r="unnamed-"+e;t.length<1?t=[r]:"string"==typeof t[0]&&t[0].length>0&&(r=t[0]);let o=new l(r,e,n);n.hasOwnProperty("immediate")&&n.immediate instanceof Function&&n.immediate.apply(o,t);let a=o.id;for(let t=2;i.elements.hasOwnProperty(e)&&i.elements[e].hasOwnProperty(o.id);t++)o.id=a+String(t);a!=o.id&&s.a.debug.log("Found an existing "+o.type+" element named &ldquo;"+a+"&rdquo;--using name &ldquo;"+o.id+"&rdquo; instead for new element"),i._addElement(o);let u=new h(o,n);if((u=u._proxy)._promises.push(()=>new Promise(e=>{o.printTime=0,o.log=!1,e()})),u._promises.push(()=>new Promise(e=>n.uponCreation.apply(o,[e]))),i.defaultCommands.hasOwnProperty(e))for(let t in i.defaultCommands[e]){let n=i.defaultCommands[e][t];u._promises.push(()=>new Promise(e=>{"header"==n[2]&&0==s.a.controllers.running.options.runHeader?e():n[0].apply(o,[e,...n[1]])}))}return u},r.b.Elements["get"+e]=function(t){let n=d[e];return new h(t,n)._proxy},Object.defineProperty(r.b.Elements,"default"+e,{get:function(){let t=d[e],n={},i=function(){s.a.controllers.underConstruction.hasOwnProperty("defaultCommands")||(s.a.controllers.underConstruction.defaultCommands={}),s.a.controllers.underConstruction.defaultCommands.hasOwnProperty(e)||(s.a.controllers.underConstruction.defaultCommands[e]=[])};for(let r in t.actions)n[r]=function(...o){return i(),s.a.controllers.underConstruction.defaultCommands[e].push([t.actions[r],o]),n};n.settings={};for(let r in t.settings)n.settings[r]=function(...o){return i(),s.a.controllers.underConstruction.defaultCommands[e].push([t.settings[r],o]),n};return n}})},r.b._AddStandardCommands=function(e){let t=new e(s.a);for(let e in t)if(e.match(/^(actions|settings|test)$/))for(let n in t[e]){let i=t[e][n];if(c[e].hasOwnProperty(n))s.a.debug.error("There already is a standard "+e+" command named "+n);else if(i instanceof Function){c[e][n]=i;for(let t in d)d[t][e].hasOwnProperty(n)||(d[t][e][n]=i),"settings"!=e||d[t].actions.hasOwnProperty(n)||(d[t].actions[n]=i)}else s.a.debug.error("Standard "+e+" command "+n+" should be a function")}else s.a.debug.error("Standard command type unknown",e)}},function(e,t,n){"use strict";var i=n(27),r=n(1),s=n(2),o=n(0),a=n(56),l=n(60);let u=[];o.a.utils.JSZip=l,o.a.utils.JSZip.getBinaryContent=i.getBinaryContent,o.a.utils.saveAs=a.saveAs,s.b.PreloadZip=function(){for(let e in arguments)u.push(arguments[e])},$(document).ready(function(){!function(){if(u.length){var e=function(e){function t(){let t=u.indexOf(e);t>=0&&u.splice(t,1)}var n=new l;Object(i.getBinaryContent)(e,function(i,s){if(i)throw t(),i;n.loadAsync(s).then(function(){o.a.debug.log("Download of "+e+" complete");var i=0;n.forEach(function(e,s){s.async("arraybuffer").then(function(s){if(!e.match(/__MACOS.+\/\.[^\/]+$/)){let t=e.replace(/^.*?([^\/]+)$/,"$1"),n=Object(r.a)(Object(r.c)(s.slice(0,28)),t);if(n){let e=URL.createObjectURL(new Blob([s],{type:n}));var a=!1;for(let n in o.a.resources.list){let i=o.a.resources.list[n];i.name==t&&"ready"!=i.status&&(i.create.apply($.extend({},i,{value:e,resolve:function(){"ready"!=i.status&&(i.object=this.object,i.resolve())}})),a=!0)}a||o.a.resources.list.push({name:t,value:e,controllers:[],object:null,status:"void",create:function(){this.status="pending"},resolve:function(){this.status="ready"}})}}++i>=Object.keys(n.files).length&&t()})})})})};for(let t in u){let n=u[t],i=n.match(/^https?:\/\/.+\.(zip)$/i);"string"==typeof n&&i?"zip"==i[1].toLowerCase()&&e(n):o.a.debug.log("Preload: entry #"+t+" is not a valid URL, ignoring it")}}}()})},function(e,t,n){"use strict";function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var e=new i;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}i.prototype=n(61),i.prototype.loadAsync=n(108),i.support=n(5),i.defaults=n(41),i.version="3.1.5",i.loadAsync=function(e,t){return(new i).loadAsync(e,t)},i.external=n(13),e.exports=i},function(e,t,n){"use strict";var i=n(9),r=n(3),s=n(4),o=n(40),a=n(41),l=n(24),u=n(94),h=n(95),c=n(17),d=n(107),f=function(e,t,n){var i,o=r.getTypeOf(t),h=r.extend(n||{},a);h.date=h.date||new Date,null!==h.compression&&(h.compression=h.compression.toUpperCase()),"string"==typeof h.unixPermissions&&(h.unixPermissions=parseInt(h.unixPermissions,8)),h.unixPermissions&&16384&h.unixPermissions&&(h.dir=!0),h.dosPermissions&&16&h.dosPermissions&&(h.dir=!0),h.dir&&(e=m(e)),h.createFolders&&(i=p(e))&&g.call(this,i,!0);var f="string"===o&&!1===h.binary&&!1===h.base64;n&&void 0!==n.binary||(h.binary=!f),(t instanceof l&&0===t.uncompressedSize||h.dir||!t||0===t.length)&&(h.base64=!1,h.binary=!0,t="",h.compression="STORE",o="string");var y=null;y=t instanceof l||t instanceof s?t:c.isNode&&c.isStream(t)?new d(e,t):r.prepareContent(e,t,h.binary,h.optimizedBinaryString,h.base64);var b=new u(e,y,h);this.files[e]=b},p=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""},m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},g=function(e,t){return t=void 0!==t?t:a.createFolders,e=m(e),this.files[e]||f.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function y(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var b={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,n,i;for(t in this.files)this.files.hasOwnProperty(t)&&(i=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,i))},filter:function(e){var t=[];return this.forEach(function(n,i){e(n,i)&&t.push(i)}),t},file:function(e,t,n){if(1===arguments.length){if(y(e)){var i=e;return this.filter(function(e,t){return!t.dir&&i.test(e)})}var r=this.files[this.root+e];return r&&!r.dir?r:null}return e=this.root+e,f.call(this,e,t,n),this},folder:function(e){if(!e)return this;if(y(e))return this.filter(function(t,n){return n.dir&&e.test(t)});var t=this.root+e,n=g.call(this,t),i=this.clone();return i.root=n.name,i},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter(function(t,n){return n.name.slice(0,e.length)===e}),i=0;i<n.length;i++)delete this.files[n[i].name];return this},generate:function(e){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,n={};try{if((n=r.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");r.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var a=n.comment||this.comment||"";t=h.generateWorker(this,n,a)}catch(e){(t=new s("error")).error(e)}return new o(t,n.type||"string",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};e.exports=b},function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],i=t[1];return 3*(n+i)/4-i},t.toByteArray=function(e){for(var t,n=u(e),i=n[0],o=n[1],a=new s(function(e,t,n){return 3*(t+n)/4-n}(0,i,o)),l=0,h=o>0?i-4:i,c=0;c<h;c+=4)t=r[e.charCodeAt(c)]<<18|r[e.charCodeAt(c+1)]<<12|r[e.charCodeAt(c+2)]<<6|r[e.charCodeAt(c+3)],a[l++]=t>>16&255,a[l++]=t>>8&255,a[l++]=255&t;2===o&&(t=r[e.charCodeAt(c)]<<2|r[e.charCodeAt(c+1)]>>4,a[l++]=255&t);1===o&&(t=r[e.charCodeAt(c)]<<10|r[e.charCodeAt(c+1)]<<4|r[e.charCodeAt(c+2)]>>2,a[l++]=t>>8&255,a[l++]=255&t);return a},t.fromByteArray=function(e){for(var t,n=e.length,r=n%3,s=[],o=0,a=n-r;o<a;o+=16383)s.push(h(e,o,o+16383>a?a:o+16383));1===r?(t=e[n-1],s.push(i[t>>2]+i[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],s.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"="));return s.join("")};for(var i=[],r=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,l=o.length;a<l;++a)i[a]=o[a],r[o.charCodeAt(a)]=a;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function h(e,t,n){for(var r,s,o=[],a=t;a<n;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(i[(s=r)>>18&63]+i[s>>12&63]+i[s>>6&63]+i[63&s]);return o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,i,r){var s,o,a=8*r-i-1,l=(1<<a)-1,u=l>>1,h=-7,c=n?r-1:0,d=n?-1:1,f=e[t+c];for(c+=d,s=f&(1<<-h)-1,f>>=-h,h+=a;h>0;s=256*s+e[t+c],c+=d,h-=8);for(o=s&(1<<-h)-1,s>>=-h,h+=i;h>0;o=256*o+e[t+c],c+=d,h-=8);if(0===s)s=1-u;else{if(s===l)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,i),s-=u}return(f?-1:1)*o*Math.pow(2,s-i)},t.write=function(e,t,n,i,r,s){var o,a,l,u=8*s-r-1,h=(1<<u)-1,c=h>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:s-1,p=i?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=h):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+c>=1?d/l:d*Math.pow(2,1-c))*l>=2&&(o++,l/=2),o+c>=h?(a=0,o=h):o+c>=1?(a=(t*l-1)*Math.pow(2,r),o+=c):(a=t*Math.pow(2,c-1)*Math.pow(2,r),o=0));r>=8;e[n+f]=255&a,f+=p,a/=256,r-=8);for(o=o<<r|a,u+=r;u>0;e[n+f]=255&o,f+=p,o/=256,u-=8);e[n+f-p]|=128*m}},function(e,t,n){e.exports=r;var i=n(19).EventEmitter;function r(){i.call(this)}n(10)(r,i),r.Readable=n(20),r.Writable=n(72),r.Duplex=n(73),r.Transform=n(74),r.PassThrough=n(75),r.Stream=r,r.prototype.pipe=function(e,t){var n=this;function r(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function s(){n.readable&&n.resume&&n.resume()}n.on("data",r),e.on("drain",s),e._isStdio||t&&!1===t.end||(n.on("end",a),n.on("close",l));var o=!1;function a(){o||(o=!0,e.end())}function l(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){if(h(),0===i.listenerCount(this,"error"))throw e}function h(){n.removeListener("data",r),e.removeListener("drain",s),n.removeListener("end",a),n.removeListener("close",l),n.removeListener("error",u),e.removeListener("error",u),n.removeListener("end",h),n.removeListener("close",h),e.removeListener("close",h)}return n.on("error",u),e.on("error",u),n.on("end",h),n.on("close",h),e.on("close",h),e.emit("pipe",n),e}},function(e,t){},function(e,t,n){"use strict";var i=n(16).Buffer,r=n(67);e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},e.prototype.concat=function(e){if(0===this.length)return i.alloc(0);if(1===this.length)return this.head.data;for(var t,n,r,s=i.allocUnsafe(e>>>0),o=this.head,a=0;o;)t=o.data,n=s,r=a,t.copy(n,r),a+=o.data.length,o=o.next;return s},e}(),r&&r.inspect&&r.inspect.custom&&(e.exports.prototype[r.inspect.custom]=function(){var e=r.inspect({length:this.length});return this.constructor.name+" "+e})},function(e,t){},function(e,t,n){(function(e){var i=void 0!==e&&e||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function s(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new s(r.call(setTimeout,i,arguments),clearTimeout)},t.setInterval=function(){return new s(r.call(setInterval,i,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(i,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(69),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(6))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var i,r,s,o,a,l=1,u={},h=!1,c=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?i=function(e){t.nextTick(function(){p(e)})}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((s=new MessageChannel).port1.onmessage=function(e){p(e.data)},i=function(e){s.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(r=c.documentElement,i=function(e){var t=c.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):i=function(e){setTimeout(p,0,e)}:(o="setImmediate$"+Math.random()+"$",a=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&p(+t.data.slice(o.length))},e.addEventListener?e.addEventListener("message",a,!1):e.attachEvent("onmessage",a),i=function(t){e.postMessage(o+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return u[l]=r,i(l),l++},d.clearImmediate=f}function f(e){delete u[e]}function p(e){if(h)setTimeout(p,0,e);else{var t=u[e];if(t){h=!0;try{!function(e){var t=e.callback,i=e.args;switch(i.length){case 0:t();break;case 1:t(i[0]);break;case 2:t(i[0],i[1]);break;case 3:t(i[0],i[1],i[2]);break;default:t.apply(n,i)}}(t)}finally{f(e),h=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(6),n(14))},function(e,t,n){(function(t){function n(e){try{if(!t.localStorage)return!1}catch(e){return!1}var n=t.localStorage[e];return null!=n&&"true"===String(n).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var i=!1;return function(){if(!i){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),i=!0}return e.apply(this,arguments)}}}).call(this,n(6))},function(e,t,n){"use strict";e.exports=s;var i=n(34),r=n(12);function s(e){if(!(this instanceof s))return new s(e);i.call(this,e)}r.inherits=n(10),r.inherits(s,i),s.prototype._transform=function(e,t,n){n(null,e)}},function(e,t,n){e.exports=n(21)},function(e,t,n){e.exports=n(8)},function(e,t,n){e.exports=n(20).Transform},function(e,t,n){e.exports=n(20).PassThrough},function(e,t,n){n(77),e.exports=n(36).setImmediate},function(e,t,n){var i=n(78),r=n(86);i(i.G+i.B,{setImmediate:r.set,clearImmediate:r.clear})},function(e,t,n){var i=n(18),r=n(36),s=n(37),o=n(80),a=function(e,t,n){var l,u,h,c=e&a.F,d=e&a.G,f=e&a.S,p=e&a.P,m=e&a.B,g=e&a.W,y=d?r:r[t]||(r[t]={}),b=y.prototype,v=d?i:f?i[t]:(i[t]||{}).prototype;for(l in d&&(n=t),n)(u=!c&&v&&void 0!==v[l])&&l in y||(h=u?v[l]:n[l],y[l]=d&&"function"!=typeof v[l]?n[l]:m&&u?s(h,i):g&&v[l]==h?function(e){var t=function(t,n,i){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,i)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(h):p&&"function"==typeof h?s(Function.call,h):h,p&&((y.virtual||(y.virtual={}))[l]=h,e&a.R&&b&&!b[l]&&o(b,l,h)))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,e.exports=a},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var i=n(81),r=n(85);e.exports=n(23)?function(e,t,n){return i.f(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var i=n(82),r=n(83),s=n(84),o=Object.defineProperty;t.f=n(23)?Object.defineProperty:function(e,t,n){if(i(e),t=s(t,!0),i(n),r)try{return o(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var i=n(22);e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){e.exports=!n(23)&&!n(38)(function(){return 7!=Object.defineProperty(n(39)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var i=n(22);e.exports=function(e,t){if(!i(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!i(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var i,r,s,o=n(37),a=n(87),l=n(88),u=n(39),h=n(18),c=h.process,d=h.setImmediate,f=h.clearImmediate,p=h.MessageChannel,m=0,g={},y=function(){var e=+this;if(g.hasOwnProperty(e)){var t=g[e];delete g[e],t()}},b=function(e){y.call(e.data)};d&&f||(d=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return g[++m]=function(){a("function"==typeof e?e:Function(e),t)},i(m),m},f=function(e){delete g[e]},"process"==n(89)(c)?i=function(e){c.nextTick(o(y,e,1))}:p?(s=(r=new p).port2,r.port1.onmessage=b,i=o(s.postMessage,s,1)):h.addEventListener&&"function"==typeof postMessage&&!h.importScripts?(i=function(e){h.postMessage(e+"","*")},h.addEventListener("message",b,!1)):i="onreadystatechange"in u("script")?function(e){l.appendChild(u("script")).onreadystatechange=function(){l.removeChild(this),y.call(e)}}:function(e){setTimeout(o(y,e,1),0)}),e.exports={set:d,clear:f}},function(e,t){e.exports=function(e,t,n){var i=void 0===n;switch(t.length){case 0:return i?e():e.call(n);case 1:return i?e(t[0]):e.call(n,t[0]);case 2:return i?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){e.exports=n(18).document&&document.documentElement},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){"use strict";var i=n(91);function r(){}var s={},o=["REJECTED"],a=["FULFILLED"],l=["PENDING"];function u(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==r&&f(this,e)}function h(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function c(e,t,n){i(function(){var i;try{i=t(n)}catch(t){return s.reject(e,t)}i===e?s.reject(e,new TypeError("Cannot resolve promise with itself")):s.resolve(e,i)})}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var n=!1;function i(t){n||(n=!0,s.reject(e,t))}function r(t){n||(n=!0,s.resolve(e,t))}var o=p(function(){t(r,i)});"error"===o.status&&i(o.value)}function p(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}e.exports=u,u.prototype.catch=function(e){return this.then(null,e)},u.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===o)return this;var n=new this.constructor(r);this.state!==l?c(n,this.state===a?e:t,this.outcome):this.queue.push(new h(n,e,t));return n},h.prototype.callFulfilled=function(e){s.resolve(this.promise,e)},h.prototype.otherCallFulfilled=function(e){c(this.promise,this.onFulfilled,e)},h.prototype.callRejected=function(e){s.reject(this.promise,e)},h.prototype.otherCallRejected=function(e){c(this.promise,this.onRejected,e)},s.resolve=function(e,t){var n=p(d,t);if("error"===n.status)return s.reject(e,n.value);var i=n.value;if(i)f(e,i);else{e.state=a,e.outcome=t;for(var r=-1,o=e.queue.length;++r<o;)e.queue[r].callFulfilled(t)}return e},s.reject=function(e,t){e.state=o,e.outcome=t;for(var n=-1,i=e.queue.length;++n<i;)e.queue[n].callRejected(t);return e},u.resolve=function(e){if(e instanceof this)return e;return s.resolve(new this(r),e)},u.reject=function(e){var t=new this(r);return s.reject(t,e)},u.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,i=!1;if(!n)return this.resolve([]);var o=new Array(n),a=0,l=-1,u=new this(r);for(;++l<n;)h(e[l],l);return u;function h(e,r){t.resolve(e).then(function(e){o[r]=e,++a!==n||i||(i=!0,s.resolve(u,o))},function(e){i||(i=!0,s.reject(u,e))})}},u.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,i=!1;if(!n)return this.resolve([]);var o=-1,a=new this(r);for(;++o<n;)l=e[o],t.resolve(l).then(function(e){i||(i=!0,s.resolve(a,e))},function(e){i||(i=!0,s.reject(a,e))});var l;return a}},function(e,t,n){"use strict";(function(t){var n,i,r=t.MutationObserver||t.WebKitMutationObserver;if(r){var s=0,o=new r(h),a=t.document.createTextNode("");o.observe(a,{characterData:!0}),n=function(){a.data=s=++s%2}}else if(t.setImmediate||void 0===t.MessageChannel)n="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){h(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(h,0)};else{var l=new t.MessageChannel;l.port1.onmessage=h,n=function(){l.port2.postMessage(0)}}var u=[];function h(){var e,t;i=!0;for(var n=u.length;n;){for(t=u,u=[],e=-1;++e<n;)t[e]();n=u.length}i=!1}e.exports=function(e){1!==u.push(e)||i||n()}}).call(this,n(6))},function(e,t,n){"use strict";var i=n(4),r=n(3);function s(e){i.call(this,"ConvertWorker to "+e),this.destType=e}r.inherits(s,i),s.prototype.processChunk=function(e){this.push({data:r.transformTo(this.destType,e.data),meta:e.meta})},e.exports=s},function(e,t,n){"use strict";var i=n(29).Readable;function r(e,t,n){i.call(this,t),this._helper=e;var r=this;e.on("data",function(e,t){r.push(e)||r._helper.pause(),n&&n(t)}).on("error",function(e){r.emit("error",e)}).on("end",function(){r.push(null)})}n(3).inherits(r,i),r.prototype._read=function(){this._helper.resume()},e.exports=r},function(e,t,n){"use strict";var i=n(40),r=n(42),s=n(9),o=n(24),a=n(4),l=function(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}};l.prototype={internalStream:function(e){var t=null,n="string";try{if(!e)throw new Error("No output type specified.");var r="string"===(n=e.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),t=this._decompressWorker();var o=!this._dataBinary;o&&!r&&(t=t.pipe(new s.Utf8EncodeWorker)),!o&&r&&(t=t.pipe(new s.Utf8DecodeWorker))}catch(e){(t=new a("error")).error(e)}return new i(t,n,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof o&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new s.Utf8EncodeWorker)),o.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof o?this._data.getContentWorker():this._data instanceof a?this._data:new r(this._data)}};for(var u=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},c=0;c<u.length;c++)l.prototype[u[c]]=h;e.exports=l},function(e,t,n){"use strict";var i=n(45),r=n(106);t.generateWorker=function(e,t,n){var s=new r(t.streamFiles,n,t.platform,t.encodeFileName),o=0;try{e.forEach(function(e,n){o++;var r=function(e,t){var n=e||t,r=i[n];if(!r)throw new Error(n+" is not a valid compression method !");return r}(n.options.compression,t.compression),a=n.options.compressionOptions||t.compressionOptions||{},l=n.dir,u=n.date;n._compressWorker(r,a).withStreamInfo("file",{name:e,dir:l,date:u,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(s)}),s.entriesCount=o}catch(e){s.error(e)}return s}},function(e,t,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,r=n(97),s=n(3),o=n(4),a=i?"uint8array":"array";function l(e,t){o.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}t.magic="\b\0",s.inherits(l,o),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(s.transformTo(a,e.data),!1)},l.prototype.flush=function(){o.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new r[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},t.compressWorker=function(e){return new l("Deflate",e)},t.uncompressWorker=function(){return new l("Inflate",{})}},function(e,t,n){"use strict";var i={};(0,n(7).assign)(i,n(98),n(101),n(50)),e.exports=i},function(e,t,n){"use strict";var i=n(99),r=n(7),s=n(48),o=n(26),a=n(49),l=Object.prototype.toString,u=0,h=-1,c=0,d=8;function f(e){if(!(this instanceof f))return new f(e);this.options=r.assign({level:h,method:d,chunkSize:16384,windowBits:15,memLevel:8,strategy:c,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var n=i.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==u)throw new Error(o[n]);if(t.header&&i.deflateSetHeader(this.strm,t.header),t.dictionary){var p;if(p="string"==typeof t.dictionary?s.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=i.deflateSetDictionary(this.strm,p))!==u)throw new Error(o[n]);this._dict_set=!0}}function p(e,t){var n=new f(t);if(n.push(e,!0),n.err)throw n.msg||o[n.err];return n.result}f.prototype.push=function(e,t){var n,o,a=this.strm,h=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:!0===t?4:0,"string"==typeof e?a.input=s.string2buf(e):"[object ArrayBuffer]"===l.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new r.Buf8(h),a.next_out=0,a.avail_out=h),1!==(n=i.deflate(a,o))&&n!==u)return this.onEnd(n),this.ended=!0,!1;0!==a.avail_out&&(0!==a.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(s.buf2binstring(r.shrinkBuf(a.output,a.next_out))):this.onData(r.shrinkBuf(a.output,a.next_out)))}while((a.avail_in>0||0===a.avail_out)&&1!==n);return 4===o?(n=i.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===u):2!==o||(this.onEnd(u),a.avail_out=0,!0)},f.prototype.onData=function(e){this.chunks.push(e)},f.prototype.onEnd=function(e){e===u&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Deflate=f,t.deflate=p,t.deflateRaw=function(e,t){return(t=t||{}).raw=!0,p(e,t)},t.gzip=function(e,t){return(t=t||{}).gzip=!0,p(e,t)}},function(e,t,n){"use strict";var i,r=n(7),s=n(100),o=n(46),a=n(47),l=n(26),u=0,h=1,c=3,d=4,f=5,p=0,m=1,g=-2,y=-3,b=-5,v=-1,w=1,_=2,E=3,k=4,C=0,x=2,P=8,j=9,S=15,T=8,O=286,A=30,Q=19,R=2*O+1,N=15,L=3,D=258,I=D+L+1,B=32,F=42,M=69,U=73,z=91,$=103,V=113,q=666,W=1,H=2,Y=3,Z=4,K=3;function G(e,t){return e.msg=l[t],t}function X(e){return(e<<1)-(e>4?9:0)}function J(e){for(var t=e.length;--t>=0;)e[t]=0}function ee(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(r.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function te(e,t){s._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,ee(e.strm)}function ne(e,t){e.pending_buf[e.pending++]=t}function ie(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function re(e,t){var n,i,r=e.max_chain_length,s=e.strstart,o=e.prev_length,a=e.nice_match,l=e.strstart>e.w_size-I?e.strstart-(e.w_size-I):0,u=e.window,h=e.w_mask,c=e.prev,d=e.strstart+D,f=u[s+o-1],p=u[s+o];e.prev_length>=e.good_match&&(r>>=2),a>e.lookahead&&(a=e.lookahead);do{if(u[(n=t)+o]===p&&u[n+o-1]===f&&u[n]===u[s]&&u[++n]===u[s+1]){s+=2,n++;do{}while(u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&s<d);if(i=D-(d-s),s=d-D,i>o){if(e.match_start=t,o=i,i>=a)break;f=u[s+o-1],p=u[s+o]}}}while((t=c[t&h])>l&&0!=--r);return o<=e.lookahead?o:e.lookahead}function se(e){var t,n,i,s,l,u,h,c,d,f,p=e.w_size;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=p+(p-I)){r.arraySet(e.window,e.window,p,p,0),e.match_start-=p,e.strstart-=p,e.block_start-=p,t=n=e.hash_size;do{i=e.head[--t],e.head[t]=i>=p?i-p:0}while(--n);t=n=p;do{i=e.prev[--t],e.prev[t]=i>=p?i-p:0}while(--n);s+=p}if(0===e.strm.avail_in)break;if(u=e.strm,h=e.window,c=e.strstart+e.lookahead,d=s,f=void 0,(f=u.avail_in)>d&&(f=d),n=0===f?0:(u.avail_in-=f,r.arraySet(h,u.input,u.next_in,f,c),1===u.state.wrap?u.adler=o(u.adler,h,f,c):2===u.state.wrap&&(u.adler=a(u.adler,h,f,c)),u.next_in+=f,u.total_in+=f,f),e.lookahead+=n,e.lookahead+e.insert>=L)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+L-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<L)););}while(e.lookahead<I&&0!==e.strm.avail_in)}function oe(e,t){for(var n,i;;){if(e.lookahead<I){if(se(e),e.lookahead<I&&t===u)return W;if(0===e.lookahead)break}if(n=0,e.lookahead>=L&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+L-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-I&&(e.match_length=re(e,n)),e.match_length>=L)if(i=s._tr_tally(e,e.strstart-e.match_start,e.match_length-L),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=L){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+L-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(te(e,!1),0===e.strm.avail_out))return W}return e.insert=e.strstart<L-1?e.strstart:L-1,t===d?(te(e,!0),0===e.strm.avail_out?Y:Z):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?W:H}function ae(e,t){for(var n,i,r;;){if(e.lookahead<I){if(se(e),e.lookahead<I&&t===u)return W;if(0===e.lookahead)break}if(n=0,e.lookahead>=L&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+L-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=L-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-I&&(e.match_length=re(e,n),e.match_length<=5&&(e.strategy===w||e.match_length===L&&e.strstart-e.match_start>4096)&&(e.match_length=L-1)),e.prev_length>=L&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-L,i=s._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-L),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+L-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=L-1,e.strstart++,i&&(te(e,!1),0===e.strm.avail_out))return W}else if(e.match_available){if((i=s._tr_tally(e,0,e.window[e.strstart-1]))&&te(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return W}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=s._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<L-1?e.strstart:L-1,t===d?(te(e,!0),0===e.strm.avail_out?Y:Z):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?W:H}function le(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r}function ue(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=P,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*R),this.dyn_dtree=new r.Buf16(2*(2*A+1)),this.bl_tree=new r.Buf16(2*(2*Q+1)),J(this.dyn_ltree),J(this.dyn_dtree),J(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(N+1),this.heap=new r.Buf16(2*O+1),J(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*O+1),J(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function he(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=x,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?F:V,e.adler=2===t.wrap?0:1,t.last_flush=u,s._tr_init(t),p):G(e,g)}function ce(e){var t,n=he(e);return n===p&&((t=e.state).window_size=2*t.w_size,J(t.head),t.max_lazy_match=i[t.level].max_lazy,t.good_match=i[t.level].good_length,t.nice_match=i[t.level].nice_length,t.max_chain_length=i[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=L-1,t.match_available=0,t.ins_h=0),n}function de(e,t,n,i,s,o){if(!e)return g;var a=1;if(t===v&&(t=6),i<0?(a=0,i=-i):i>15&&(a=2,i-=16),s<1||s>j||n!==P||i<8||i>15||t<0||t>9||o<0||o>k)return G(e,g);8===i&&(i=9);var l=new ue;return e.state=l,l.strm=e,l.wrap=a,l.gzhead=null,l.w_bits=i,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=s+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+L-1)/L),l.window=new r.Buf8(2*l.w_size),l.head=new r.Buf16(l.hash_size),l.prev=new r.Buf16(l.w_size),l.lit_bufsize=1<<s+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new r.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=o,l.method=n,ce(e)}i=[new le(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(se(e),0===e.lookahead&&t===u)return W;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,te(e,!1),0===e.strm.avail_out))return W;if(e.strstart-e.block_start>=e.w_size-I&&(te(e,!1),0===e.strm.avail_out))return W}return e.insert=0,t===d?(te(e,!0),0===e.strm.avail_out?Y:Z):(e.strstart>e.block_start&&(te(e,!1),e.strm.avail_out),W)}),new le(4,4,8,4,oe),new le(4,5,16,8,oe),new le(4,6,32,32,oe),new le(4,4,16,16,ae),new le(8,16,32,32,ae),new le(8,16,128,128,ae),new le(8,32,128,256,ae),new le(32,128,258,1024,ae),new le(32,258,258,4096,ae)],t.deflateInit=function(e,t){return de(e,t,P,S,T,C)},t.deflateInit2=de,t.deflateReset=ce,t.deflateResetKeep=he,t.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?g:(e.state.gzhead=t,p):g},t.deflate=function(e,t){var n,r,o,l;if(!e||!e.state||t>f||t<0)return e?G(e,g):g;if(r=e.state,!e.output||!e.input&&0!==e.avail_in||r.status===q&&t!==d)return G(e,0===e.avail_out?b:g);if(r.strm=e,n=r.last_flush,r.last_flush=t,r.status===F)if(2===r.wrap)e.adler=0,ne(r,31),ne(r,139),ne(r,8),r.gzhead?(ne(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),ne(r,255&r.gzhead.time),ne(r,r.gzhead.time>>8&255),ne(r,r.gzhead.time>>16&255),ne(r,r.gzhead.time>>24&255),ne(r,9===r.level?2:r.strategy>=_||r.level<2?4:0),ne(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(ne(r,255&r.gzhead.extra.length),ne(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=a(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=M):(ne(r,0),ne(r,0),ne(r,0),ne(r,0),ne(r,0),ne(r,9===r.level?2:r.strategy>=_||r.level<2?4:0),ne(r,K),r.status=V);else{var y=P+(r.w_bits-8<<4)<<8;y|=(r.strategy>=_||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(y|=B),y+=31-y%31,r.status=V,ie(r,y),0!==r.strstart&&(ie(r,e.adler>>>16),ie(r,65535&e.adler)),e.adler=1}if(r.status===M)if(r.gzhead.extra){for(o=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>o&&(e.adler=a(e.adler,r.pending_buf,r.pending-o,o)),ee(e),o=r.pending,r.pending!==r.pending_buf_size));)ne(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>o&&(e.adler=a(e.adler,r.pending_buf,r.pending-o,o)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=U)}else r.status=U;if(r.status===U)if(r.gzhead.name){o=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>o&&(e.adler=a(e.adler,r.pending_buf,r.pending-o,o)),ee(e),o=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,ne(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>o&&(e.adler=a(e.adler,r.pending_buf,r.pending-o,o)),0===l&&(r.gzindex=0,r.status=z)}else r.status=z;if(r.status===z)if(r.gzhead.comment){o=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>o&&(e.adler=a(e.adler,r.pending_buf,r.pending-o,o)),ee(e),o=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,ne(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>o&&(e.adler=a(e.adler,r.pending_buf,r.pending-o,o)),0===l&&(r.status=$)}else r.status=$;if(r.status===$&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&ee(e),r.pending+2<=r.pending_buf_size&&(ne(r,255&e.adler),ne(r,e.adler>>8&255),e.adler=0,r.status=V)):r.status=V),0!==r.pending){if(ee(e),0===e.avail_out)return r.last_flush=-1,p}else if(0===e.avail_in&&X(t)<=X(n)&&t!==d)return G(e,b);if(r.status===q&&0!==e.avail_in)return G(e,b);if(0!==e.avail_in||0!==r.lookahead||t!==u&&r.status!==q){var v=r.strategy===_?function(e,t){for(var n;;){if(0===e.lookahead&&(se(e),0===e.lookahead)){if(t===u)return W;break}if(e.match_length=0,n=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(te(e,!1),0===e.strm.avail_out))return W}return e.insert=0,t===d?(te(e,!0),0===e.strm.avail_out?Y:Z):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?W:H}(r,t):r.strategy===E?function(e,t){for(var n,i,r,o,a=e.window;;){if(e.lookahead<=D){if(se(e),e.lookahead<=D&&t===u)return W;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=L&&e.strstart>0&&(i=a[r=e.strstart-1])===a[++r]&&i===a[++r]&&i===a[++r]){o=e.strstart+D;do{}while(i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&r<o);e.match_length=D-(o-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=L?(n=s._tr_tally(e,1,e.match_length-L),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(te(e,!1),0===e.strm.avail_out))return W}return e.insert=0,t===d?(te(e,!0),0===e.strm.avail_out?Y:Z):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?W:H}(r,t):i[r.level].func(r,t);if(v!==Y&&v!==Z||(r.status=q),v===W||v===Y)return 0===e.avail_out&&(r.last_flush=-1),p;if(v===H&&(t===h?s._tr_align(r):t!==f&&(s._tr_stored_block(r,0,0,!1),t===c&&(J(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),ee(e),0===e.avail_out))return r.last_flush=-1,p}return t!==d?p:r.wrap<=0?m:(2===r.wrap?(ne(r,255&e.adler),ne(r,e.adler>>8&255),ne(r,e.adler>>16&255),ne(r,e.adler>>24&255),ne(r,255&e.total_in),ne(r,e.total_in>>8&255),ne(r,e.total_in>>16&255),ne(r,e.total_in>>24&255)):(ie(r,e.adler>>>16),ie(r,65535&e.adler)),ee(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?p:m)},t.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==F&&t!==M&&t!==U&&t!==z&&t!==$&&t!==V&&t!==q?G(e,g):(e.state=null,t===V?G(e,y):p):g},t.deflateSetDictionary=function(e,t){var n,i,s,a,l,u,h,c,d=t.length;if(!e||!e.state)return g;if(2===(a=(n=e.state).wrap)||1===a&&n.status!==F||n.lookahead)return g;for(1===a&&(e.adler=o(e.adler,t,d,0)),n.wrap=0,d>=n.w_size&&(0===a&&(J(n.head),n.strstart=0,n.block_start=0,n.insert=0),c=new r.Buf8(n.w_size),r.arraySet(c,t,d-n.w_size,n.w_size,0),t=c,d=n.w_size),l=e.avail_in,u=e.next_in,h=e.input,e.avail_in=d,e.next_in=0,e.input=t,se(n);n.lookahead>=L;){i=n.strstart,s=n.lookahead-(L-1);do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[i+L-1])&n.hash_mask,n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++}while(--s);n.strstart=i,n.lookahead=L-1,se(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=L-1,n.match_available=0,e.next_in=u,e.input=h,e.avail_in=l,n.wrap=a,p},t.deflateInfo="pako deflate (from Nodeca project)"},function(e,t,n){"use strict";var i=n(7),r=4,s=0,o=1,a=2;function l(e){for(var t=e.length;--t>=0;)e[t]=0}var u=0,h=1,c=2,d=29,f=256,p=f+1+d,m=30,g=19,y=2*p+1,b=15,v=16,w=7,_=256,E=16,k=17,C=18,x=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],P=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],j=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],S=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],T=new Array(2*(p+2));l(T);var O=new Array(2*m);l(O);var A=new Array(512);l(A);var Q=new Array(256);l(Q);var R=new Array(d);l(R);var N,L,D,I=new Array(m);function B(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}function F(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function M(e){return e<256?A[e]:A[256+(e>>>7)]}function U(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function z(e,t,n){e.bi_valid>v-n?(e.bi_buf|=t<<e.bi_valid&65535,U(e,e.bi_buf),e.bi_buf=t>>v-e.bi_valid,e.bi_valid+=n-v):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function $(e,t,n){z(e,n[2*t],n[2*t+1])}function V(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function q(e,t,n){var i,r,s=new Array(b+1),o=0;for(i=1;i<=b;i++)s[i]=o=o+n[i-1]<<1;for(r=0;r<=t;r++){var a=e[2*r+1];0!==a&&(e[2*r]=V(s[a]++,a))}}function W(e){var t;for(t=0;t<p;t++)e.dyn_ltree[2*t]=0;for(t=0;t<m;t++)e.dyn_dtree[2*t]=0;for(t=0;t<g;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*_]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function H(e){e.bi_valid>8?U(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function Y(e,t,n,i){var r=2*t,s=2*n;return e[r]<e[s]||e[r]===e[s]&&i[t]<=i[n]}function Z(e,t,n){for(var i=e.heap[n],r=n<<1;r<=e.heap_len&&(r<e.heap_len&&Y(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!Y(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i}function K(e,t,n){var i,r,s,o,a=0;if(0!==e.last_lit)do{i=e.pending_buf[e.d_buf+2*a]<<8|e.pending_buf[e.d_buf+2*a+1],r=e.pending_buf[e.l_buf+a],a++,0===i?$(e,r,t):($(e,(s=Q[r])+f+1,t),0!==(o=x[s])&&z(e,r-=R[s],o),$(e,s=M(--i),n),0!==(o=P[s])&&z(e,i-=I[s],o))}while(a<e.last_lit);$(e,_,t)}function G(e,t){var n,i,r,s=t.dyn_tree,o=t.stat_desc.static_tree,a=t.stat_desc.has_stree,l=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=y,n=0;n<l;n++)0!==s[2*n]?(e.heap[++e.heap_len]=u=n,e.depth[n]=0):s[2*n+1]=0;for(;e.heap_len<2;)s[2*(r=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[r]=0,e.opt_len--,a&&(e.static_len-=o[2*r+1]);for(t.max_code=u,n=e.heap_len>>1;n>=1;n--)Z(e,s,n);r=l;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Z(e,s,1),i=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=i,s[2*r]=s[2*n]+s[2*i],e.depth[r]=(e.depth[n]>=e.depth[i]?e.depth[n]:e.depth[i])+1,s[2*n+1]=s[2*i+1]=r,e.heap[1]=r++,Z(e,s,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,i,r,s,o,a,l=t.dyn_tree,u=t.max_code,h=t.stat_desc.static_tree,c=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(s=0;s<=b;s++)e.bl_count[s]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<y;n++)(s=l[2*l[2*(i=e.heap[n])+1]+1]+1)>p&&(s=p,m++),l[2*i+1]=s,i>u||(e.bl_count[s]++,o=0,i>=f&&(o=d[i-f]),a=l[2*i],e.opt_len+=a*(s+o),c&&(e.static_len+=a*(h[2*i+1]+o)));if(0!==m){do{for(s=p-1;0===e.bl_count[s];)s--;e.bl_count[s]--,e.bl_count[s+1]+=2,e.bl_count[p]--,m-=2}while(m>0);for(s=p;0!==s;s--)for(i=e.bl_count[s];0!==i;)(r=e.heap[--n])>u||(l[2*r+1]!==s&&(e.opt_len+=(s-l[2*r+1])*l[2*r],l[2*r+1]=s),i--)}}(e,t),q(s,u,e.bl_count)}function X(e,t,n){var i,r,s=-1,o=t[1],a=0,l=7,u=4;for(0===o&&(l=138,u=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)r=o,o=t[2*(i+1)+1],++a<l&&r===o||(a<u?e.bl_tree[2*r]+=a:0!==r?(r!==s&&e.bl_tree[2*r]++,e.bl_tree[2*E]++):a<=10?e.bl_tree[2*k]++:e.bl_tree[2*C]++,a=0,s=r,0===o?(l=138,u=3):r===o?(l=6,u=3):(l=7,u=4))}function J(e,t,n){var i,r,s=-1,o=t[1],a=0,l=7,u=4;for(0===o&&(l=138,u=3),i=0;i<=n;i++)if(r=o,o=t[2*(i+1)+1],!(++a<l&&r===o)){if(a<u)do{$(e,r,e.bl_tree)}while(0!=--a);else 0!==r?(r!==s&&($(e,r,e.bl_tree),a--),$(e,E,e.bl_tree),z(e,a-3,2)):a<=10?($(e,k,e.bl_tree),z(e,a-3,3)):($(e,C,e.bl_tree),z(e,a-11,7));a=0,s=r,0===o?(l=138,u=3):r===o?(l=6,u=3):(l=7,u=4)}}l(I);var ee=!1;function te(e,t,n,r){z(e,(u<<1)+(r?1:0),3),function(e,t,n,r){H(e),r&&(U(e,n),U(e,~n)),i.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n,!0)}t._tr_init=function(e){ee||(function(){var e,t,n,i,r,s=new Array(b+1);for(n=0,i=0;i<d-1;i++)for(R[i]=n,e=0;e<1<<x[i];e++)Q[n++]=i;for(Q[n-1]=i,r=0,i=0;i<16;i++)for(I[i]=r,e=0;e<1<<P[i];e++)A[r++]=i;for(r>>=7;i<m;i++)for(I[i]=r<<7,e=0;e<1<<P[i]-7;e++)A[256+r++]=i;for(t=0;t<=b;t++)s[t]=0;for(e=0;e<=143;)T[2*e+1]=8,e++,s[8]++;for(;e<=255;)T[2*e+1]=9,e++,s[9]++;for(;e<=279;)T[2*e+1]=7,e++,s[7]++;for(;e<=287;)T[2*e+1]=8,e++,s[8]++;for(q(T,p+1,s),e=0;e<m;e++)O[2*e+1]=5,O[2*e]=V(e,5);N=new B(T,x,f+1,p,b),L=new B(O,P,0,m,b),D=new B(new Array(0),j,0,g,w)}(),ee=!0),e.l_desc=new F(e.dyn_ltree,N),e.d_desc=new F(e.dyn_dtree,L),e.bl_desc=new F(e.bl_tree,D),e.bi_buf=0,e.bi_valid=0,W(e)},t._tr_stored_block=te,t._tr_flush_block=function(e,t,n,i){var l,u,d=0;e.level>0?(e.strm.data_type===a&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return s;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return o;for(t=32;t<f;t++)if(0!==e.dyn_ltree[2*t])return o;return s}(e)),G(e,e.l_desc),G(e,e.d_desc),d=function(e){var t;for(X(e,e.dyn_ltree,e.l_desc.max_code),X(e,e.dyn_dtree,e.d_desc.max_code),G(e,e.bl_desc),t=g-1;t>=3&&0===e.bl_tree[2*S[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),l=e.opt_len+3+7>>>3,(u=e.static_len+3+7>>>3)<=l&&(l=u)):l=u=n+5,n+4<=l&&-1!==t?te(e,t,n,i):e.strategy===r||u===l?(z(e,(h<<1)+(i?1:0),3),K(e,T,O)):(z(e,(c<<1)+(i?1:0),3),function(e,t,n,i){var r;for(z(e,t-257,5),z(e,n-1,5),z(e,i-4,4),r=0;r<i;r++)z(e,e.bl_tree[2*S[r]+1],3);J(e,e.dyn_ltree,t-1),J(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,d+1),K(e,e.dyn_ltree,e.dyn_dtree)),W(e),i&&H(e)},t._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(Q[n]+f+1)]++,e.dyn_dtree[2*M(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function(e){z(e,h<<1,3),$(e,_,T),function(e){16===e.bi_valid?(U(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},function(e,t,n){"use strict";var i=n(102),r=n(7),s=n(48),o=n(50),a=n(26),l=n(49),u=n(105),h=Object.prototype.toString;function c(e){if(!(this instanceof c))return new c(e);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=i.inflateInit2(this.strm,t.windowBits);if(n!==o.Z_OK)throw new Error(a[n]);if(this.header=new u,i.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=s.string2buf(t.dictionary):"[object ArrayBuffer]"===h.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=i.inflateSetDictionary(this.strm,t.dictionary))!==o.Z_OK))throw new Error(a[n])}function d(e,t){var n=new c(t);if(n.push(e,!0),n.err)throw n.msg||a[n.err];return n.result}c.prototype.push=function(e,t){var n,a,l,u,c,d=this.strm,f=this.options.chunkSize,p=this.options.dictionary,m=!1;if(this.ended)return!1;a=t===~~t?t:!0===t?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof e?d.input=s.binstring2buf(e):"[object ArrayBuffer]"===h.call(e)?d.input=new Uint8Array(e):d.input=e,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new r.Buf8(f),d.next_out=0,d.avail_out=f),(n=i.inflate(d,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&p&&(n=i.inflateSetDictionary(this.strm,p)),n===o.Z_BUF_ERROR&&!0===m&&(n=o.Z_OK,m=!1),n!==o.Z_STREAM_END&&n!==o.Z_OK)return this.onEnd(n),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&n!==o.Z_STREAM_END&&(0!==d.avail_in||a!==o.Z_FINISH&&a!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(l=s.utf8border(d.output,d.next_out),u=d.next_out-l,c=s.buf2string(d.output,l),d.next_out=u,d.avail_out=f-u,u&&r.arraySet(d.output,d.output,l,u,0),this.onData(c)):this.onData(r.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(m=!0)}while((d.avail_in>0||0===d.avail_out)&&n!==o.Z_STREAM_END);return n===o.Z_STREAM_END&&(a=o.Z_FINISH),a===o.Z_FINISH?(n=i.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===o.Z_OK):a!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),d.avail_out=0,!0)},c.prototype.onData=function(e){this.chunks.push(e)},c.prototype.onEnd=function(e){e===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=c,t.inflate=d,t.inflateRaw=function(e,t){return(t=t||{}).raw=!0,d(e,t)},t.ungzip=d},function(e,t,n){"use strict";var i=n(7),r=n(46),s=n(47),o=n(103),a=n(104),l=0,u=1,h=2,c=4,d=5,f=6,p=0,m=1,g=2,y=-2,b=-3,v=-4,w=-5,_=8,E=1,k=2,C=3,x=4,P=5,j=6,S=7,T=8,O=9,A=10,Q=11,R=12,N=13,L=14,D=15,I=16,B=17,F=18,M=19,U=20,z=21,$=22,V=23,q=24,W=25,H=26,Y=27,Z=28,K=29,G=30,X=31,J=32,ee=852,te=592,ne=15;function ie(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function re(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function se(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=E,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new i.Buf32(ee),t.distcode=t.distdyn=new i.Buf32(te),t.sane=1,t.back=-1,p):y}function oe(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,se(e)):y}function ae(e,t){var n,i;return e&&e.state?(i=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?y:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,oe(e))):y}function le(e,t){var n,i;return e?(i=new re,e.state=i,i.window=null,(n=ae(e,t))!==p&&(e.state=null),n):y}var ue,he,ce=!0;function de(e){if(ce){var t;for(ue=new i.Buf32(512),he=new i.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(a(u,e.lens,0,288,ue,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;a(h,e.lens,0,32,he,0,e.work,{bits:5}),ce=!1}e.lencode=ue,e.lenbits=9,e.distcode=he,e.distbits=5}function fe(e,t,n,r){var s,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new i.Buf8(o.wsize)),r>=o.wsize?(i.arraySet(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((s=o.wsize-o.wnext)>r&&(s=r),i.arraySet(o.window,t,n-r,s,o.wnext),(r-=s)?(i.arraySet(o.window,t,n-r,r,0),o.wnext=r,o.whave=o.wsize):(o.wnext+=s,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=s))),0}t.inflateReset=oe,t.inflateReset2=ae,t.inflateResetKeep=se,t.inflateInit=function(e){return le(e,ne)},t.inflateInit2=le,t.inflate=function(e,t){var n,ee,te,ne,re,se,oe,ae,le,ue,he,ce,pe,me,ge,ye,be,ve,we,_e,Ee,ke,Ce,xe,Pe=0,je=new i.Buf8(4),Se=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return y;(n=e.state).mode===R&&(n.mode=N),re=e.next_out,te=e.output,oe=e.avail_out,ne=e.next_in,ee=e.input,se=e.avail_in,ae=n.hold,le=n.bits,ue=se,he=oe,ke=p;e:for(;;)switch(n.mode){case E:if(0===n.wrap){n.mode=N;break}for(;le<16;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}if(2&n.wrap&&35615===ae){n.check=0,je[0]=255&ae,je[1]=ae>>>8&255,n.check=s(n.check,je,2,0),ae=0,le=0,n.mode=k;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&ae)<<8)+(ae>>8))%31){e.msg="incorrect header check",n.mode=G;break}if((15&ae)!==_){e.msg="unknown compression method",n.mode=G;break}if(le-=4,Ee=8+(15&(ae>>>=4)),0===n.wbits)n.wbits=Ee;else if(Ee>n.wbits){e.msg="invalid window size",n.mode=G;break}n.dmax=1<<Ee,e.adler=n.check=1,n.mode=512&ae?A:R,ae=0,le=0;break;case k:for(;le<16;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}if(n.flags=ae,(255&n.flags)!==_){e.msg="unknown compression method",n.mode=G;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=G;break}n.head&&(n.head.text=ae>>8&1),512&n.flags&&(je[0]=255&ae,je[1]=ae>>>8&255,n.check=s(n.check,je,2,0)),ae=0,le=0,n.mode=C;case C:for(;le<32;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}n.head&&(n.head.time=ae),512&n.flags&&(je[0]=255&ae,je[1]=ae>>>8&255,je[2]=ae>>>16&255,je[3]=ae>>>24&255,n.check=s(n.check,je,4,0)),ae=0,le=0,n.mode=x;case x:for(;le<16;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}n.head&&(n.head.xflags=255&ae,n.head.os=ae>>8),512&n.flags&&(je[0]=255&ae,je[1]=ae>>>8&255,n.check=s(n.check,je,2,0)),ae=0,le=0,n.mode=P;case P:if(1024&n.flags){for(;le<16;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}n.length=ae,n.head&&(n.head.extra_len=ae),512&n.flags&&(je[0]=255&ae,je[1]=ae>>>8&255,n.check=s(n.check,je,2,0)),ae=0,le=0}else n.head&&(n.head.extra=null);n.mode=j;case j:if(1024&n.flags&&((ce=n.length)>se&&(ce=se),ce&&(n.head&&(Ee=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),i.arraySet(n.head.extra,ee,ne,ce,Ee)),512&n.flags&&(n.check=s(n.check,ee,ce,ne)),se-=ce,ne+=ce,n.length-=ce),n.length))break e;n.length=0,n.mode=S;case S:if(2048&n.flags){if(0===se)break e;ce=0;do{Ee=ee[ne+ce++],n.head&&Ee&&n.length<65536&&(n.head.name+=String.fromCharCode(Ee))}while(Ee&&ce<se);if(512&n.flags&&(n.check=s(n.check,ee,ce,ne)),se-=ce,ne+=ce,Ee)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=T;case T:if(4096&n.flags){if(0===se)break e;ce=0;do{Ee=ee[ne+ce++],n.head&&Ee&&n.length<65536&&(n.head.comment+=String.fromCharCode(Ee))}while(Ee&&ce<se);if(512&n.flags&&(n.check=s(n.check,ee,ce,ne)),se-=ce,ne+=ce,Ee)break e}else n.head&&(n.head.comment=null);n.mode=O;case O:if(512&n.flags){for(;le<16;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}if(ae!==(65535&n.check)){e.msg="header crc mismatch",n.mode=G;break}ae=0,le=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=R;break;case A:for(;le<32;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}e.adler=n.check=ie(ae),ae=0,le=0,n.mode=Q;case Q:if(0===n.havedict)return e.next_out=re,e.avail_out=oe,e.next_in=ne,e.avail_in=se,n.hold=ae,n.bits=le,g;e.adler=n.check=1,n.mode=R;case R:if(t===d||t===f)break e;case N:if(n.last){ae>>>=7&le,le-=7&le,n.mode=Y;break}for(;le<3;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}switch(n.last=1&ae,le-=1,3&(ae>>>=1)){case 0:n.mode=L;break;case 1:if(de(n),n.mode=U,t===f){ae>>>=2,le-=2;break e}break;case 2:n.mode=B;break;case 3:e.msg="invalid block type",n.mode=G}ae>>>=2,le-=2;break;case L:for(ae>>>=7&le,le-=7&le;le<32;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}if((65535&ae)!=(ae>>>16^65535)){e.msg="invalid stored block lengths",n.mode=G;break}if(n.length=65535&ae,ae=0,le=0,n.mode=D,t===f)break e;case D:n.mode=I;case I:if(ce=n.length){if(ce>se&&(ce=se),ce>oe&&(ce=oe),0===ce)break e;i.arraySet(te,ee,ne,ce,re),se-=ce,ne+=ce,oe-=ce,re+=ce,n.length-=ce;break}n.mode=R;break;case B:for(;le<14;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}if(n.nlen=257+(31&ae),ae>>>=5,le-=5,n.ndist=1+(31&ae),ae>>>=5,le-=5,n.ncode=4+(15&ae),ae>>>=4,le-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=G;break}n.have=0,n.mode=F;case F:for(;n.have<n.ncode;){for(;le<3;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}n.lens[Se[n.have++]]=7&ae,ae>>>=3,le-=3}for(;n.have<19;)n.lens[Se[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,Ce={bits:n.lenbits},ke=a(l,n.lens,0,19,n.lencode,0,n.work,Ce),n.lenbits=Ce.bits,ke){e.msg="invalid code lengths set",n.mode=G;break}n.have=0,n.mode=M;case M:for(;n.have<n.nlen+n.ndist;){for(;ye=(Pe=n.lencode[ae&(1<<n.lenbits)-1])>>>16&255,be=65535&Pe,!((ge=Pe>>>24)<=le);){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}if(be<16)ae>>>=ge,le-=ge,n.lens[n.have++]=be;else{if(16===be){for(xe=ge+2;le<xe;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}if(ae>>>=ge,le-=ge,0===n.have){e.msg="invalid bit length repeat",n.mode=G;break}Ee=n.lens[n.have-1],ce=3+(3&ae),ae>>>=2,le-=2}else if(17===be){for(xe=ge+3;le<xe;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}le-=ge,Ee=0,ce=3+(7&(ae>>>=ge)),ae>>>=3,le-=3}else{for(xe=ge+7;le<xe;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}le-=ge,Ee=0,ce=11+(127&(ae>>>=ge)),ae>>>=7,le-=7}if(n.have+ce>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=G;break}for(;ce--;)n.lens[n.have++]=Ee}}if(n.mode===G)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=G;break}if(n.lenbits=9,Ce={bits:n.lenbits},ke=a(u,n.lens,0,n.nlen,n.lencode,0,n.work,Ce),n.lenbits=Ce.bits,ke){e.msg="invalid literal/lengths set",n.mode=G;break}if(n.distbits=6,n.distcode=n.distdyn,Ce={bits:n.distbits},ke=a(h,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,Ce),n.distbits=Ce.bits,ke){e.msg="invalid distances set",n.mode=G;break}if(n.mode=U,t===f)break e;case U:n.mode=z;case z:if(se>=6&&oe>=258){e.next_out=re,e.avail_out=oe,e.next_in=ne,e.avail_in=se,n.hold=ae,n.bits=le,o(e,he),re=e.next_out,te=e.output,oe=e.avail_out,ne=e.next_in,ee=e.input,se=e.avail_in,ae=n.hold,le=n.bits,n.mode===R&&(n.back=-1);break}for(n.back=0;ye=(Pe=n.lencode[ae&(1<<n.lenbits)-1])>>>16&255,be=65535&Pe,!((ge=Pe>>>24)<=le);){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}if(ye&&0==(240&ye)){for(ve=ge,we=ye,_e=be;ye=(Pe=n.lencode[_e+((ae&(1<<ve+we)-1)>>ve)])>>>16&255,be=65535&Pe,!(ve+(ge=Pe>>>24)<=le);){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}ae>>>=ve,le-=ve,n.back+=ve}if(ae>>>=ge,le-=ge,n.back+=ge,n.length=be,0===ye){n.mode=H;break}if(32&ye){n.back=-1,n.mode=R;break}if(64&ye){e.msg="invalid literal/length code",n.mode=G;break}n.extra=15&ye,n.mode=$;case $:if(n.extra){for(xe=n.extra;le<xe;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}n.length+=ae&(1<<n.extra)-1,ae>>>=n.extra,le-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=V;case V:for(;ye=(Pe=n.distcode[ae&(1<<n.distbits)-1])>>>16&255,be=65535&Pe,!((ge=Pe>>>24)<=le);){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}if(0==(240&ye)){for(ve=ge,we=ye,_e=be;ye=(Pe=n.distcode[_e+((ae&(1<<ve+we)-1)>>ve)])>>>16&255,be=65535&Pe,!(ve+(ge=Pe>>>24)<=le);){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}ae>>>=ve,le-=ve,n.back+=ve}if(ae>>>=ge,le-=ge,n.back+=ge,64&ye){e.msg="invalid distance code",n.mode=G;break}n.offset=be,n.extra=15&ye,n.mode=q;case q:if(n.extra){for(xe=n.extra;le<xe;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}n.offset+=ae&(1<<n.extra)-1,ae>>>=n.extra,le-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=G;break}n.mode=W;case W:if(0===oe)break e;if(ce=he-oe,n.offset>ce){if((ce=n.offset-ce)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=G;break}ce>n.wnext?(ce-=n.wnext,pe=n.wsize-ce):pe=n.wnext-ce,ce>n.length&&(ce=n.length),me=n.window}else me=te,pe=re-n.offset,ce=n.length;ce>oe&&(ce=oe),oe-=ce,n.length-=ce;do{te[re++]=me[pe++]}while(--ce);0===n.length&&(n.mode=z);break;case H:if(0===oe)break e;te[re++]=n.length,oe--,n.mode=z;break;case Y:if(n.wrap){for(;le<32;){if(0===se)break e;se--,ae|=ee[ne++]<<le,le+=8}if(he-=oe,e.total_out+=he,n.total+=he,he&&(e.adler=n.check=n.flags?s(n.check,te,he,re-he):r(n.check,te,he,re-he)),he=oe,(n.flags?ae:ie(ae))!==n.check){e.msg="incorrect data check",n.mode=G;break}ae=0,le=0}n.mode=Z;case Z:if(n.wrap&&n.flags){for(;le<32;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}if(ae!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=G;break}ae=0,le=0}n.mode=K;case K:ke=m;break e;case G:ke=b;break e;case X:return v;case J:default:return y}return e.next_out=re,e.avail_out=oe,e.next_in=ne,e.avail_in=se,n.hold=ae,n.bits=le,(n.wsize||he!==e.avail_out&&n.mode<G&&(n.mode<Y||t!==c))&&fe(e,e.output,e.next_out,he-e.avail_out)?(n.mode=X,v):(ue-=e.avail_in,he-=e.avail_out,e.total_in+=ue,e.total_out+=he,n.total+=he,n.wrap&&he&&(e.adler=n.check=n.flags?s(n.check,te,he,e.next_out-he):r(n.check,te,he,e.next_out-he)),e.data_type=n.bits+(n.last?64:0)+(n.mode===R?128:0)+(n.mode===U||n.mode===D?256:0),(0===ue&&0===he||t===c)&&ke===p&&(ke=w),ke)},t.inflateEnd=function(e){if(!e||!e.state)return y;var t=e.state;return t.window&&(t.window=null),e.state=null,p},t.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?y:(n.head=t,t.done=!1,p):y},t.inflateSetDictionary=function(e,t){var n,i=t.length;return e&&e.state?0!==(n=e.state).wrap&&n.mode!==Q?y:n.mode===Q&&r(1,t,i,0)!==n.check?b:fe(e,t,i,i)?(n.mode=X,v):(n.havedict=1,p):y},t.inflateInfo="pako inflate (from Nodeca project)"},function(e,t,n){"use strict";e.exports=function(e,t){var n,i,r,s,o,a,l,u,h,c,d,f,p,m,g,y,b,v,w,_,E,k,C,x,P;n=e.state,i=e.next_in,x=e.input,r=i+(e.avail_in-5),s=e.next_out,P=e.output,o=s-(t-e.avail_out),a=s+(e.avail_out-257),l=n.dmax,u=n.wsize,h=n.whave,c=n.wnext,d=n.window,f=n.hold,p=n.bits,m=n.lencode,g=n.distcode,y=(1<<n.lenbits)-1,b=(1<<n.distbits)-1;e:do{p<15&&(f+=x[i++]<<p,p+=8,f+=x[i++]<<p,p+=8),v=m[f&y];t:for(;;){if(f>>>=w=v>>>24,p-=w,0===(w=v>>>16&255))P[s++]=65535&v;else{if(!(16&w)){if(0==(64&w)){v=m[(65535&v)+(f&(1<<w)-1)];continue t}if(32&w){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}_=65535&v,(w&=15)&&(p<w&&(f+=x[i++]<<p,p+=8),_+=f&(1<<w)-1,f>>>=w,p-=w),p<15&&(f+=x[i++]<<p,p+=8,f+=x[i++]<<p,p+=8),v=g[f&b];n:for(;;){if(f>>>=w=v>>>24,p-=w,!(16&(w=v>>>16&255))){if(0==(64&w)){v=g[(65535&v)+(f&(1<<w)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(E=65535&v,p<(w&=15)&&(f+=x[i++]<<p,(p+=8)<w&&(f+=x[i++]<<p,p+=8)),(E+=f&(1<<w)-1)>l){e.msg="invalid distance too far back",n.mode=30;break e}if(f>>>=w,p-=w,E>(w=s-o)){if((w=E-w)>h&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(k=0,C=d,0===c){if(k+=u-w,w<_){_-=w;do{P[s++]=d[k++]}while(--w);k=s-E,C=P}}else if(c<w){if(k+=u+c-w,(w-=c)<_){_-=w;do{P[s++]=d[k++]}while(--w);if(k=0,c<_){_-=w=c;do{P[s++]=d[k++]}while(--w);k=s-E,C=P}}}else if(k+=c-w,w<_){_-=w;do{P[s++]=d[k++]}while(--w);k=s-E,C=P}for(;_>2;)P[s++]=C[k++],P[s++]=C[k++],P[s++]=C[k++],_-=3;_&&(P[s++]=C[k++],_>1&&(P[s++]=C[k++]))}else{k=s-E;do{P[s++]=P[k++],P[s++]=P[k++],P[s++]=P[k++],_-=3}while(_>2);_&&(P[s++]=P[k++],_>1&&(P[s++]=P[k++]))}break}}break}}while(i<r&&s<a);i-=_=p>>3,f&=(1<<(p-=_<<3))-1,e.next_in=i,e.next_out=s,e.avail_in=i<r?r-i+5:5-(i-r),e.avail_out=s<a?a-s+257:257-(s-a),n.hold=f,n.bits=p}},function(e,t,n){"use strict";var i=n(7),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,n,l,u,h,c,d){var f,p,m,g,y,b,v,w,_,E=d.bits,k=0,C=0,x=0,P=0,j=0,S=0,T=0,O=0,A=0,Q=0,R=null,N=0,L=new i.Buf16(16),D=new i.Buf16(16),I=null,B=0;for(k=0;k<=15;k++)L[k]=0;for(C=0;C<l;C++)L[t[n+C]]++;for(j=E,P=15;P>=1&&0===L[P];P--);if(j>P&&(j=P),0===P)return u[h++]=20971520,u[h++]=20971520,d.bits=1,0;for(x=1;x<P&&0===L[x];x++);for(j<x&&(j=x),O=1,k=1;k<=15;k++)if(O<<=1,(O-=L[k])<0)return-1;if(O>0&&(0===e||1!==P))return-1;for(D[1]=0,k=1;k<15;k++)D[k+1]=D[k]+L[k];for(C=0;C<l;C++)0!==t[n+C]&&(c[D[t[n+C]]++]=C);if(0===e?(R=I=c,b=19):1===e?(R=r,N-=257,I=s,B-=257,b=256):(R=o,I=a,b=-1),Q=0,C=0,k=x,y=h,S=j,T=0,m=-1,g=(A=1<<j)-1,1===e&&A>852||2===e&&A>592)return 1;for(;;){v=k-T,c[C]<b?(w=0,_=c[C]):c[C]>b?(w=I[B+c[C]],_=R[N+c[C]]):(w=96,_=0),f=1<<k-T,x=p=1<<S;do{u[y+(Q>>T)+(p-=f)]=v<<24|w<<16|_|0}while(0!==p);for(f=1<<k-1;Q&f;)f>>=1;if(0!==f?(Q&=f-1,Q+=f):Q=0,C++,0==--L[k]){if(k===P)break;k=t[n+c[C]]}if(k>j&&(Q&g)!==m){for(0===T&&(T=j),y+=x,O=1<<(S=k-T);S+T<P&&!((O-=L[S+T])<=0);)S++,O<<=1;if(A+=1<<S,1===e&&A>852||2===e&&A>592)return 1;u[m=Q&g]=j<<24|S<<16|y-h|0}}return 0!==Q&&(u[y+Q]=k-T<<24|64<<16|0),d.bits=j,0}},function(e,t,n){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},function(e,t,n){"use strict";var i=n(3),r=n(4),s=n(9),o=n(25),a=n(51),l=function(e,t){var n,i="";for(n=0;n<t;n++)i+=String.fromCharCode(255&e),e>>>=8;return i},u=function(e,t,n,r,u,h){var c,d,f=e.file,p=e.compression,m=h!==s.utf8encode,g=i.transformTo("string",h(f.name)),y=i.transformTo("string",s.utf8encode(f.name)),b=f.comment,v=i.transformTo("string",h(b)),w=i.transformTo("string",s.utf8encode(b)),_=y.length!==f.name.length,E=w.length!==b.length,k="",C="",x="",P=f.dir,j=f.date,S={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(S.crc32=e.crc32,S.compressedSize=e.compressedSize,S.uncompressedSize=e.uncompressedSize);var T=0;t&&(T|=8),m||!_&&!E||(T|=2048);var O,A,Q,R=0,N=0;P&&(R|=16),"UNIX"===u?(N=798,R|=(O=f.unixPermissions,A=P,Q=O,O||(Q=A?16893:33204),(65535&Q)<<16)):(N=20,R|=63&(f.dosPermissions||0)),c=j.getUTCHours(),c<<=6,c|=j.getUTCMinutes(),c<<=5,c|=j.getUTCSeconds()/2,d=j.getUTCFullYear()-1980,d<<=4,d|=j.getUTCMonth()+1,d<<=5,d|=j.getUTCDate(),_&&(C=l(1,1)+l(o(g),4)+y,k+="up"+l(C.length,2)+C),E&&(x=l(1,1)+l(o(v),4)+w,k+="uc"+l(x.length,2)+x);var L="";return L+="\n\0",L+=l(T,2),L+=p.magic,L+=l(c,2),L+=l(d,2),L+=l(S.crc32,4),L+=l(S.compressedSize,4),L+=l(S.uncompressedSize,4),L+=l(g.length,2),L+=l(k.length,2),{fileRecord:a.LOCAL_FILE_HEADER+L+g+k,dirRecord:a.CENTRAL_FILE_HEADER+l(N,2)+L+l(v.length,2)+"\0\0\0\0"+l(R,4)+l(r,4)+g+k+v}},h=function(e){return a.DATA_DESCRIPTOR+l(e.crc32,4)+l(e.compressedSize,4)+l(e.uncompressedSize,4)};function c(e,t,n,i){r.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=i,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}i.inherits(c,r),c.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,i=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,r.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-i-1))/n:100}}))},c.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=u(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},c.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,n=u(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),t)this.push({data:h(e),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},c.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n=this.bytesWritten-e,r=function(e,t,n,r,s){var o=i.transformTo("string",s(r));return a.CENTRAL_DIRECTORY_END+"\0\0\0\0"+l(e,2)+l(e,2)+l(t,4)+l(n,4)+l(o.length,2)+o}(this.dirRecords.length,n,e,this.zipComment,this.encodeFileName);this.push({data:r,meta:{percent:100}})},c.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},c.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},c.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},c.prototype.error=function(e){var t=this._sources;if(!r.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(e){}return!0},c.prototype.lock=function(){r.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},e.exports=c},function(e,t,n){"use strict";var i=n(3),r=n(4);function s(e,t){r.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}i.inherits(s,r),s.prototype._bindStream=function(e){var t=this;this._stream=e,e.pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},s.prototype.pause=function(){return!!r.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},e.exports=s},function(e,t,n){"use strict";var i=n(3),r=n(13),s=n(9),o=(i=n(3),n(109)),a=n(44),l=n(17);function u(e){return new r.Promise(function(t,n){var i=e.decompressed.getContentWorker().pipe(new a);i.on("error",function(e){n(e)}).on("end",function(){i.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}e.exports=function(e,t){var n=this;return t=i.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),l.isNode&&l.isStream(e)?r.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(e){var n=new o(t);return n.load(e),n}).then(function(e){var n=[r.Promise.resolve(e)],i=e.files;if(t.checkCRC32)for(var s=0;s<i.length;s++)n.push(u(i[s]));return r.Promise.all(n)}).then(function(e){for(var i=e.shift(),r=i.files,s=0;s<r.length;s++){var o=r[s];n.file(o.fileNameStr,o.decompressed,{binary:!0,optimizedBinaryString:!0,date:o.date,dir:o.dir,comment:o.fileCommentStr.length?o.fileCommentStr:null,unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions,createFolders:t.createFolders})}return i.zipComment.length&&(n.comment=i.zipComment),n})}},function(e,t,n){"use strict";var i=n(52),r=n(3),s=n(51),o=n(112),a=(n(9),n(5));function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+r.pretty(t)+", expected "+r.pretty(e)+")")}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var i=this.reader.readString(4)===t;return this.reader.setIndex(n),i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=a.uint8array?"uint8array":"array",n=r.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,i=this.zip64EndOfCentralSize-44;0<i;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(e=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(e<0)throw!this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory");this.reader.setIndex(e);var t=e;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===r.MAX_VALUE_16BITS||this.diskWithCentralDirStart===r.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===r.MAX_VALUE_16BITS||this.centralDirRecords===r.MAX_VALUE_16BITS||this.centralDirSize===r.MAX_VALUE_32BITS||this.centralDirOffset===r.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var i=t-n;if(i>0)this.isSignature(t,s.CENTRAL_FILE_HEADER)||(this.reader.zero=i);else if(i<0)throw new Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")},prepareReader:function(e){this.reader=i(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=l},function(e,t,n){"use strict";var i=n(54);function r(e){i.call(this,e)}n(3).inherits(r,i),r.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},r.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},r.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},r.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=r},function(e,t,n){"use strict";var i=n(55);function r(e){i.call(this,e)}n(3).inherits(r,i),r.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=r},function(e,t,n){"use strict";var i=n(52),r=n(3),s=n(24),o=n(25),a=n(9),l=n(45),u=n(5);function h(e,t){this.options=e,this.loadOptions=t}h.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(l.hasOwnProperty(t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+r.pretty(this.compressionMethod)+" unknown (inner file : "+r.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===e&&(this.dosPermissions=63&this.externalFileAttributes),3===e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(e){if(this.extraFields[1]){var t=i(this.extraFields[1].value);this.uncompressedSize===r.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===r.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===r.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===r.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(e){var t,n,i,r=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index<r;)t=e.readInt(2),n=e.readInt(2),i=e.readData(n),this.extraFields[t]={id:t,length:n,value:i}},handleUTF8:function(){var e=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=a.utf8decode(this.fileName),this.fileCommentStr=a.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var n=r.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var i=this.findExtraFieldUnicodeComment();if(null!==i)this.fileCommentStr=i;else{var s=r.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(s)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=i(e.value);return 1!==t.readInt(1)?null:o(this.fileName)!==t.readInt(4)?null:a.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=i(e.value);return 1!==t.readInt(1)?null:o(this.fileComment)!==t.readInt(4)?null:a.utf8decode(t.readData(e.length-5))}return null}},e.exports=h},function(e,t,n){"use strict";n(114);var i=n(2),r=n(0),s=n(1);r.a.tables={};var o={};let a=[];class l{constructor(e,t){if(!(e instanceof Array)||e.length<1||!Object.keys(e[0]).length)return r.a.debug.error("Invalid format for table when creating new table");this.id=t||"unnamed",this.table=e;for(let t in e[0])t.match(/^item$/i)&&(this.item=t),t.match(/^(group|list)$/i)&&(this.group=t),t.match(/^label$/i)&&(this.label=t)}setItem(e){return this.table[0].hasOwnProperty(e)?this.item=e:r.a.debug.log("Error when setting table's item column: no column found with the name "+e),this}setGroup(e){return this.table[0].hasOwnProperty(e)?this.group=e:r.a.debug.log("Error when setting table's group column: no column found with the name "+e),this}setLabel(e){return this.table[0].hasOwnProperty(e)?this.label=e:r.a.debug.log("Error when setting table's label column: no column found with the name "+e),this}filter(...e){if(2==e.length&&"string"==typeof e[0]&&("string"==typeof e[1]||e[1]instanceof RegExp)){if(this.table[0].hasOwnProperty(e[0])){let t=e[1];"string"==typeof t&&(t=new RegExp("^"+t+"$"));let n=[];for(let i=0;i<this.table.length;i++)this.table[i][e[0]].match(t)&&n.push(this.table[i]);return n.length||r.a.debug.error("Empty table with filter:",e[0],e[1]),n=new l(n,this.id),this.group&&n.setGroup(this.group),this.label&&n.setLabel(this.label),n}return r.a.debug.error("No column named "+e[0]+" found in the table for filtering")}if(e.length&&e[0]instanceof Function){let t=[];for(let n=0;n<this.table.length;n++)e[0].call(this,this.table[n])&&t.push(this.table[n]);return t.length||r.a.debug.error("Empty table after filter:",e[0]),new l(t,this.id).setGroup(this.group).setLabel(this.label)}}}class u{constructor(e){this.name=e,this.actions=[]}setItem(e){return this.actions.push(["setItem",e]),this}setGroup(e){return this.actions.push(["setGroup",e]),this}setLabel(e){return this.actions.push(["setLabel",e]),this}filter(...e){let t=new u(this.name);for(let e=0;e<this.actions.length;e++)t.actions.push(this.actions[e]);return t.actions.push(["filter",e]),t}setItemColumn(e){return this.setItem(e)}setGroupColumn(e){return this.setGroup(e)}setLabelColumn(e){return this.setLabel(e)}}function h(e){65279===e.charCodeAt(0)&&(e=e.slice(1)),e.match(/[\n\r]$/)||(e+="\n");let t=[],n=[];try{let n=$.csv.toArrays(e,{separator:","}),i=n[0];for(let e=1;e<n.length;e++){let r={};i.map((t,i)=>r[t]=n[e][i]),t.push(r)}}catch(e){t.push({})}try{let t=$.csv.toArrays(e,{separator:"\t"}),i=t[0];for(let e=1;e<t.length;e++){let r={};i.map((n,i)=>r[n]=t[e][i]),n.push(r)}}catch(e){n.push({})}return Object.keys(t[0]).length>Object.keys(n[0]).length?t:Object.keys(n[0]).length?n:r.a.debug.error("Format of table is invalid")}let c=[],d=window.$.ajax;window.$.ajax=function(...e){if(e[0]&&e[0].url&&e[0].url.match(/allchunks=1$/)){let t=e[0].success;e[0].success=(e=>{if(0==c.length)return t(e);let n,r=[];for(let s=c.length-1;s>=0;s--)n=s==c.length-1?n=>{i.b.AddTable(c[s].name,n),t(e)}:e=>{i.b.AddTable(c[s].name,e),r[0]()},r.push(()=>$.ajax({url:c[s].table,cache:!1,dataType:"text",success:n}));r[0]()})}return d(...e)},i.b.AddTable=function(e,t){if("string"!=typeof e||"string"!=typeof t)return r.a.debug.error("Table "+e+" not added: tables and table names should be strings");if(r.a.tables.hasOwnProperty(e)&&r.a.debug.log("A table named "+e+" already exists; overriding it"),t.match(/^http/))c.push({name:e,table:t});else{if(!(t=h(t)))return r.a.debug.error("Table "+e+" does not have the right format.");t=new l(t,e),r.a.tables[e]=t}},i.b.GetTable=function(e){return new u(e)};let f,p=[];i.b.Template=function(e,t){if(window.items)for(let e in window.items)r.a.tmpItems.indexOf(window.items[e])<0&&r.a.tmpItems.push(window.items[e]);let n={PennTemplate:[]};return r.a.tmpItems.push(n),p.push(function(){let i,h=r.a.tmpItems.length;if(e instanceof Function){t=e;let n=Object.keys(r.a.tables);if(!(n.length&&r.a.tables[n[0]]instanceof l))return r.a.debug.error("No valid table detected");i=r.a.tables[n[0]]}else if("string"==typeof e){if(!r.a.tables.hasOwnProperty(e)){let t=Object.keys(r.a.tables),n="";for(let i=0;i<t.length;i++)Object(s.e)(e,t[i])/t[i].length<.5&&(n=" Did you mean to type &lsquo;<strong>"+t[i]+"</strong>&rsquo;?");return r.a.debug.error("No table found with name "+e+"."+n)}if(!(r.a.tables[e]instanceof l))return r.a.debug.error("Table "+e+" does not have the right format.");i=r.a.tables[e]}else{if(!(e instanceof u))return r.a.debug.error("Bad format for Template's first argument (should be a PennController table, table name or function from rows to Ibex elements)");if(Object.keys(r.a.tables).length<1)return r.a.debug.error("No table was defined");if(e.name==o)i=r.a.tables[Object.keys(r.a.tables)[0]];else{if(!e.name||!r.a.tables.hasOwnProperty(e.name)){let t=Object.keys(r.a.tables),n="";for(let i=0;i<t.length;i++)Object(s.e)(e.name,t[i])/t[i].length<.5&&(n=" Did you mean to type &lsquo;</strong>"+t[i]+"</strong>&rsquo;?");return r.a.debug.error("No table named "+e.name+" was found."+n)}i=r.a.tables[e.name]}for(let t=0;t<e.actions.length;t++){let n=e.actions[t][1];switch(e.actions[t][0]){case"setItem":i.setItem(n);break;case"setLabel":i.setLabel(n);break;case"setGroup":i.setGroup(n);break;case"filter":i=i.filter(...n)}}}if(!(t instanceof Function))return r.a.debug.error("The function passed to PennController.Template is ill-defined");let c,d=[];if(i.group){for(let e=0;e<i.table.length;e++)d.indexOf(i.table[e][i.group])<0&&d.push(i.table[e][i.group]);if(d.sort(),a.map(e=>{let t=d.filter((t,n)=>t==e.groups[n]);d.indexOf(e.runningGroup)>-1&&t.length==e.groups.length&&t.length==d.length&&(c=e.runningGroup)}),void 0===c){let e=window.__counter_value_from_server__;"number"==typeof window.counterOverride&&(e=counterOverride),c=d[e%d.length]}a.push({runningGroup:c,groups:d})}let f=[];for(let e=0;e<i.table.length;e++){if(i.group){if(i.table[e][i.group]!=c)continue}let n,o=void 0,a=new Proxy(i.table[e],{get:(t,n)=>{if(n in i.table[e])return t[n];{let t=Object.keys(i.table[e]),o="";for(let e=0;e<t.length;e++)Object(s.e)(n,t[e])/t[e].length<.5&&(o=" Did you mean to type &lsquo;<strong>"+t[e]+"</strong>&rsquo;?");r.a.debug.error("No column named &lsquo;"+n+"&rsquo; found in table "+i.id+"."+o)}return""}});try{n=t.call(null,a)}catch(e){window.onerror(e.name+": "+e.message,"include=data","inside PennController.Template")}n instanceof Array?n.length%2&&"string"==typeof n[0]&&(o=n[0],n.splice(0,1)):(o=n.useLabel,n.addToItems=!1,n=["PennController",n]),o||(o=i.label&&i.table[e].hasOwnProperty(i.label)?i.table[e][i.label]:i.item&&i.table[e].hasOwnProperty(i.item)?"Item-"+i.table[e][i.item]:"Item-"+e);let l=[o];for(let t in n)n[t]instanceof Object&&(n[t]._PennController={table:i,row:e}),l.push(n[t]);f.push(l)}for(n.PennTemplate=f;r.a.tmpItems.length>h;)r.a.tmpItems.pop()}),window.items||(window.items=[]),{log:()=>r.a.debug.error("Tried to call .log command on PennController.Template(); .log commands should be called on PennController()"),label:()=>r.a.debug.error("Tried to call .label command on PennController.Template(); .label commands should be called on PennController()"),setOption:()=>r.a.debug.error("Tried to call .setOption command on PennController.Template(); .setOption commands should be called on PennController()"),noHeader:()=>r.a.debug.error("Tried to call .noHeader command on PennController.Template(); .noHeader commands should be called on PennController()"),noFooter:()=>r.a.debug.error("Tried to call .noFooter command on PennController.Template(); .noFooter commands should be called on PennController()")}},i.b.FeedItems=((e,t)=>i.b.Template(e,t)),$(document).ready(function(){(f=document.createElement("P")).style["text-align"]="center",f.innerHTML="Loading, please wait...",f.id="FirstLoadingMessage",document.body.appendChild(f)}),r.a.Prerun(()=>{for(let e in window.CHUNKS_DICT){if(e.match(/\.(html?|mp3)$/i))continue;let t=h(window.CHUNKS_DICT[e]);t?(t=new l(t,e),r.a.tables[e]=t):(t=$.csv.toObjects(window.CHUNKS_DICT[e],{separator:"\t"}),Object.keys(t[0]).length>1&&(t=new l(t,e),r.a.tables[e]=t))}for(let e=0;e<p.length;e++)p[e].call();f&&document.body.removeChild(f)}),Object.defineProperty(i.b,"defaultTable",{get:function(){let e=new u;return e.name=o,e}})},function(e,t,n){RegExp.escape=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},function(){"use strict";var t;(t="undefined"!=typeof jQuery&&jQuery?jQuery:{}).csv={defaults:{separator:",",delimiter:'"',headers:!0},hooks:{castToScalar:function(e,t){if(isNaN(e))return e;if(/\./.test(e))return parseFloat(e);var n=parseInt(e);return isNaN(n)?null:n}},parsers:{parse:function(e,t){var n=t.separator,i=t.delimiter;t.state.rowNum||(t.state.rowNum=1),t.state.colNum||(t.state.colNum=1);var r=[],s=[],o=0,a="",l=!1;function u(){if(o=0,a="",t.start&&t.state.rowNum<t.start)return s=[],t.state.rowNum++,void(t.state.colNum=1);if(void 0===t.onParseEntry)r.push(s);else{var e=t.onParseEntry(s,t.state);!1!==e&&r.push(e)}s=[],t.end&&t.state.rowNum>=t.end&&(l=!0),t.state.rowNum++,t.state.colNum=1}function h(){if(void 0===t.onParseValue)s.push(a);else{var e=t.onParseValue(a,t.state);!1!==e&&s.push(e)}a="",o=0,t.state.colNum++}var c=RegExp.escape(n),d=RegExp.escape(i),f=/(D|S|\r\n|\n|\r|[^DS\r\n]+)/,p=f.source;return p=(p=p.replace(/S/g,c)).replace(/D/g,d),f=new RegExp(p,"gm"),e.replace(f,function(e){if(!l)switch(o){case 0:if(e===n){a+="",h();break}if(e===i){o=1;break}if(/^(\r\n|\n|\r)$/.test(e)){h(),u();break}a+=e,o=3;break;case 1:if(e===i){o=2;break}a+=e,o=1;break;case 2:if(e===i){a+=e,o=1;break}if(e===n){h();break}if(/^(\r\n|\n|\r)$/.test(e)){h(),u();break}throw new Error("CSVDataError: Illegal State [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");case 3:if(e===n){h();break}if(/^(\r\n|\n|\r)$/.test(e)){h(),u();break}if(e===i)throw new Error("CSVDataError: Illegal Quote [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");throw new Error("CSVDataError: Illegal Data [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");default:throw new Error("CSVDataError: Unknown State [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]")}}),0!==s.length&&(h(),u()),r},splitLines:function(e,n){if(e){var i=(n=n||{}).separator||t.csv.defaults.separator,r=n.delimiter||t.csv.defaults.delimiter;n.state=n.state||{},n.state.rowNum||(n.state.rowNum=1);var s=[],o=0,a="",l=!1,u=RegExp.escape(i),h=RegExp.escape(r),c=/(D|S|\n|\r|[^DS\r\n]+)/,d=c.source;return d=(d=d.replace(/S/g,u)).replace(/D/g,h),c=new RegExp(d,"gm"),e.replace(c,function(e){if(!l)switch(o){case 0:if(e===i){a+=e,o=0;break}if(e===r){a+=e,o=1;break}if("\n"===e){f();break}if(/^\r$/.test(e))break;a+=e,o=3;break;case 1:if(e===r){a+=e,o=2;break}a+=e,o=1;break;case 2:var t=a.substr(a.length-1);if(e===r&&t===r){a+=e,o=1;break}if(e===i){a+=e,o=0;break}if("\n"===e){f();break}if("\r"===e)break;throw new Error("CSVDataError: Illegal state [Row:"+n.state.rowNum+"]");case 3:if(e===i){a+=e,o=0;break}if("\n"===e){f();break}if("\r"===e)break;if(e===r)throw new Error("CSVDataError: Illegal quote [Row:"+n.state.rowNum+"]");throw new Error("CSVDataError: Illegal state [Row:"+n.state.rowNum+"]");default:throw new Error("CSVDataError: Unknown state [Row:"+n.state.rowNum+"]")}}),""!==a&&f(),s}function f(){if(o=0,n.start&&n.state.rowNum<n.start)return a="",void n.state.rowNum++;if(void 0===n.onParseEntry)s.push(a);else{var e=n.onParseEntry(a,n.state);!1!==e&&s.push(e)}a="",n.end&&n.state.rowNum>=n.end&&(l=!0),n.state.rowNum++}},parseEntry:function(e,t){var n=t.separator,i=t.delimiter;t.state.rowNum||(t.state.rowNum=1),t.state.colNum||(t.state.colNum=1);var r=[],s=0,o="";function a(){if(void 0===t.onParseValue)r.push(o);else{var e=t.onParseValue(o,t.state);!1!==e&&r.push(e)}o="",s=0,t.state.colNum++}if(!t.match){var l=RegExp.escape(n),u=RegExp.escape(i),h=/(D|S|\n|\r|[^DS\r\n]+)/.source;h=(h=h.replace(/S/g,l)).replace(/D/g,u),t.match=new RegExp(h,"gm")}return e.replace(t.match,function(e){switch(s){case 0:if(e===n){o+="",a();break}if(e===i){s=1;break}if("\n"===e||"\r"===e)break;o+=e,s=3;break;case 1:if(e===i){s=2;break}o+=e,s=1;break;case 2:if(e===i){o+=e,s=1;break}if(e===n){a();break}if("\n"===e||"\r"===e)break;throw new Error("CSVDataError: Illegal State [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");case 3:if(e===n){a();break}if("\n"===e||"\r"===e)break;if(e===i)throw new Error("CSVDataError: Illegal Quote [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");throw new Error("CSVDataError: Illegal Data [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");default:throw new Error("CSVDataError: Unknown State [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]")}}),a(),r}},helpers:{collectPropertyNames:function(e){var t=[],n=[],i=[];for(t in e)for(n in e[t])e[t].hasOwnProperty(n)&&i.indexOf(n)<0&&"function"!=typeof e[t][n]&&i.push(n);return i}},toArray:function(e,n,i){n=void 0!==n?n:{};var r={};r.callback=void 0!==i&&"function"==typeof i&&i,r.separator="separator"in n?n.separator:t.csv.defaults.separator,r.delimiter="delimiter"in n?n.delimiter:t.csv.defaults.delimiter;var s=void 0!==n.state?n.state:{};n={delimiter:r.delimiter,separator:r.separator,onParseEntry:n.onParseEntry,onParseValue:n.onParseValue,state:s};var o=t.csv.parsers.parseEntry(e,n);if(!r.callback)return o;r.callback("",o)},toArrays:function(e,n,i){n=void 0!==n?n:{};var r={};r.callback=void 0!==i&&"function"==typeof i&&i,r.separator="separator"in n?n.separator:t.csv.defaults.separator,r.delimiter="delimiter"in n?n.delimiter:t.csv.defaults.delimiter;var s;if(void 0!==(n={delimiter:r.delimiter,separator:r.separator,onPreParse:n.onPreParse,onParseEntry:n.onParseEntry,onParseValue:n.onParseValue,onPostParse:n.onPostParse,start:n.start,end:n.end,state:{rowNum:1,colNum:1}}).onPreParse&&n.onPreParse(e,n.state),s=t.csv.parsers.parse(e,n),void 0!==n.onPostParse&&n.onPostParse(s,n.state),!r.callback)return s;r.callback("",s)},toObjects:function(e,n,i){n=void 0!==n?n:{};var r={};r.callback=void 0!==i&&"function"==typeof i&&i,r.separator="separator"in n?n.separator:t.csv.defaults.separator,r.delimiter="delimiter"in n?n.delimiter:t.csv.defaults.delimiter,r.headers="headers"in n?n.headers:t.csv.defaults.headers,n.start="start"in n?n.start:1,r.headers&&n.start++,n.end&&r.headers&&n.end++;var s,o=[];n={delimiter:r.delimiter,separator:r.separator,onPreParse:n.onPreParse,onParseEntry:n.onParseEntry,onParseValue:n.onParseValue,onPostParse:n.onPostParse,start:n.start,end:n.end,state:{rowNum:1,colNum:1},match:!1,transform:n.transform};var a={delimiter:r.delimiter,separator:r.separator,start:1,end:1,state:{rowNum:1,colNum:1}};void 0!==n.onPreParse&&n.onPreParse(e,n.state);var l=t.csv.parsers.splitLines(e,a),u=t.csv.toArray(l[0],n);s=t.csv.parsers.splitLines(e,n),n.state.colNum=1,n.state.rowNum=u?2:1;for(var h=0,c=s.length;h<c;h++){for(var d=t.csv.toArray(s[h],n),f={},p=0;p<u.length;p++)f[u[p]]=d[p];void 0!==n.transform?o.push(n.transform.call(void 0,f)):o.push(f),n.state.rowNum++}if(void 0!==n.onPostParse&&n.onPostParse(o,n.state),!r.callback)return o;r.callback("",o)},fromArrays:function(e,n,i){n=void 0!==n?n:{};var r={};r.callback=void 0!==i&&"function"==typeof i&&i,r.separator="separator"in n?n.separator:t.csv.defaults.separator,r.delimiter="delimiter"in n?n.delimiter:t.csv.defaults.delimiter;var s,o,a,l,u="";for(a=0;a<e.length;a++){for(s=e[a],o=[],l=0;l<s.length;l++){var h=void 0===s[l]||null===s[l]?"":s[l].toString();h.indexOf(r.delimiter)>-1&&(h=h.replace(new RegExp(r.delimiter,"g"),r.delimiter+r.delimiter));var c="\n|\r|S|D";c=(c=c.replace("S",r.separator)).replace("D",r.delimiter),h.search(c)>-1&&(h=r.delimiter+h+r.delimiter),o.push(h)}u+=o.join(r.separator)+"\n"}if(!r.callback)return u;r.callback("",u)},fromObjects:function(e,n,i){n=void 0!==n?n:{};var r={};if(r.callback=void 0!==i&&"function"==typeof i&&i,r.separator="separator"in n?n.separator:t.csv.defaults.separator,r.delimiter="delimiter"in n?n.delimiter:t.csv.defaults.delimiter,r.headers="headers"in n?n.headers:t.csv.defaults.headers,r.sortOrder="sortOrder"in n?n.sortOrder:"declare",r.manualOrder="manualOrder"in n?n.manualOrder:[],r.transform=n.transform,"string"==typeof r.manualOrder&&(r.manualOrder=t.csv.toArray(r.manualOrder,r)),void 0!==r.transform){var s,o=e;for(e=[],s=0;s<o.length;s++)e.push(r.transform.call(void 0,o[s]))}var a,l,u,h,c=t.csv.helpers.collectPropertyNames(e);if("alpha"===r.sortOrder&&c.sort(),r.manualOrder.length>0){var d=[].concat(r.manualOrder);let e;for(e=0;e<c.length;e++)d.indexOf(c[e])<0&&d.push(c[e]);c=d}for(r.headers&&(void 0).push(c),a=0;a<e.length;a++){for(u=[],l=0;l<c.length;l++)(h=c[l])in e[a]&&"function"!=typeof e[a][h]?u.push(e[a][h]):u.push("");(void 0).push(u)}return t.csv.fromArrays(void 0,n,r.callback)}},t.csvEntry2Array=t.csv.toArray,t.csv2Array=t.csv.toArrays,t.csv2Dictionary=t.csv.toObjects,e.exports&&(e.exports=t.csv)}.call(this)},function(e,t){let n=(e,t)=>{let n=Object.getOwnPropertyDescriptors(t);for(let t in n){let i=n[t];i.value instanceof Function?e[t]=i.value:i.get instanceof Function&&Object.defineProperty(e,t,i)}};window.PennController.ResetPrefix=function(e){if("string"==typeof e){if(window[e])throw"ERROR: prefix string already used for another JS object";window[e]={};var t=window[e]}else t=window;n(t,window.PennController.Elements),n(t,window.PennController)}},function(e,t,n){"use strict";var i=n(0),r=n(2);i.a.Prerun(()=>{let e=[];function t(t){return t instanceof r.a?e.indexOf(t)<0&&t.addToItems?[t.useLabel||"unlabeled","PennController",t]:null:t}if(window.items instanceof Array)for(let t=0;t<window.items.length;t++)if(window.items[t]instanceof Array&&window.items[t].length>2)for(let n=2;n<window.items[t].length;n+=2)e.push(window.items[t][n]);let n=[];for(let r=0;r<i.a.tmpItems.length;r++){let s=i.a.tmpItems[r],o=[];if(s instanceof Object&&s.hasOwnProperty("PennTemplate"))for(let e=0;e<s.PennTemplate.length;e++)o.push(t(s.PennTemplate[e]));else o.push(t(s));for(let t=0;t<o.length;t++)if(o[t]instanceof Array&&o[t].length>2)for(let n=2;n<o[t].length;n+=2)e.push(o[t][n]);n=n.concat(o)}if(window.items instanceof Array)for(let e=0;e<window.items.length;e++)n.indexOf(window.items[e])<0&&n.push(window.items[e]);window.items=n.filter(e=>e instanceof Array&&e.length>2),window.shuffleSequence||(window.conf_shuffleSequence=window.seq(window.anyType))})},function(e,t){window.PennController._AddElementType("Audio",function(e){this.immediate=function(t,n){"string"==typeof t&&void 0===n&&(n=t);let i=!n.match(/^http/i);this.resource=e.resources.fetch(n,function(e){this.object=new Audio(this.value),this.object.preload="auto",this.object.load(),this.object.readyState>3?e():this.object.addEventListener("canplaythrough",e)},i),void 0!==t&&"string"==typeof t&&0!=t.length||(t="Audio"),this.id=t},this.uponCreation=function(e){this.resource.object.controls=!0,this.audio=this.resource.object,this.hasPlayed=!1,this.disabled=!1,this.resource.object.style=null,this.jQueryElement=$(this.audio),this.jQueryDisable=null,this.playEvents=[],this.endEvents=[],this.pauseEvents=[],this.seekEvents=[],this.bufferEvents=[],this.whatToSave=[],this.resource.object.onplay=(()=>{this.playEvents.push(["play",this.audio.currentTime,Date.now()])}),this.resource.object.onended=(()=>{this.hasPlayed=!0,this.endEvents.push(["end",this.audio.currentTime,Date.now()])}),this.resource.object.onpause=(()=>{this.pauseEvents.push(["pause",this.audio.currentTime,Date.now()])}),this.resource.object.onseeked=(()=>{this.seekEvents.push(["seek",this.audio.currentTime,Date.now()])}),this.resource.object.waiting=(()=>{this.bufferEvents.push(["buffer",this.audio.currentTime,Date.now()])}),this.printDisable=(e=>{e=Number(e)||.5,this.jQueryDisable instanceof jQuery&&this.jQueryDisable.remove(),this.jQueryDisable=$("<div>").css({position:"absolute",display:"inline-block","background-color":"gray",opacity:e,width:this.jQueryElement.width(),height:this.jQueryElement.height()}),this.jQueryElement.before(this.jQueryDisable),this.jQueryElement.removeAttr("controls")}),e()},this.end=function(){if(this.whatToSave&&this.whatToSave.indexOf("play")>-1){this.playEvents.length||e.controllers.running.save(this.type,this.id,"play","NA","Never");for(let t in this.playEvents)e.controllers.running.save(this.type,this.id,...this.playEvents[t])}if(this.whatToSave&&this.whatToSave.indexOf("end")>-1){this.endEvents.length||e.controllers.running.save(this.type,this.id,"end","NA","Never");for(let t in this.endEvents)e.controllers.running.save(this.type,this.id,...this.endEvents[t])}if(this.whatToSave&&this.whatToSave.indexOf("pause")>-1){this.pauseEvents.length||e.controllers.running.save(this.type,this.id,"pause","NA","Never");for(let t in this.pauseEvents)e.controllers.running.save(this.type,this.id,...this.pauseEvents[t])}if(this.whatToSave&&this.whatToSave.indexOf("seek")>-1){this.seekEvents.length||e.controllers.running.save(this.type,this.id,"seek","NA","Never");for(let t in this.seekEvents)e.controllers.running.save(this.type,this.id,...this.seekEvents[t])}if(this.bufferEvents)for(let t in this.bufferEvents)e.controllers.running.save(this.type,this.id,...this.bufferEvents[t]);this.resource.object.currentTime=0,this.jQueryDisable&&this.jQueryDisable.remove()},this.value=function(){return this.endEvents.length?this.endEvents[this.endEvents.length-1][2]:0},this.actions={play:function(t,n){this.hasOwnProperty("audio")&&this.audio instanceof Audio?(n&&"once"==n?this.audio.removeAttribute("loop"):n&&(this.audio.loop=!0),this.audio.play()):e.debug.error("No audio to play for element ",this.id),t()},pause:function(e){this.audio.pause(),e()},print:function(t,...n){e.elements.standardCommands.actions.print.apply(this,[()=>{this.disabled&&this.printDisable(),t()},...n])},stop:function(e){this.audio.pause(),this.audio.currentTime=0,e()},wait:function(e,t){if("first"==t&&this.hasPlayed)e();else{let n=!1,i=this.audio.onended;this.audio.onended=function(...r){if(i.apply(this,r),!n)if(t instanceof Object&&t._runPromises&&t.success){let i=this.disabled;this.disabled="tmp",t._runPromises().then(t=>{"success"==t&&(n=!0,e()),"tmp"==this.disabled&&(this.disabled=i)})}else n=!0,e()}}}},this.settings={disable:function(e,t){this.jQueryElement.addClass("PennController-disabled"),this.jQueryContainer.addClass("PennController-disabled"),this.printDisable(t),this.disabled=t||!0,e()},enable:function(e){this.jQueryDisable instanceof jQuery&&(this.disabled=!1,this.jQueryDisable.remove(),this.jQueryDisable=null,this.jQueryElement.removeClass("PennController-disabled"),this.jQueryContainer.removeClass("PennController-disabled"),this.jQueryElement.attr("controls",!0)),e()},once:function(e){if(this.hasPlayed)this.disabled=!0,this.printDisable();else{let e=this.audio.onended,t=this;this.audio.onended=function(...n){e.apply(this,n),t.disabled=!0,t.printDisable()}}e()},log:function(e,...t){1==t.length&&"string"==typeof t[0]?this.whatToSave.push(t[0]):t.length>1?this.whatToSave=this.whatToSave.concat(t):this.whatToSave=["play","end","pause","seek"],e()}},this.test={hasPlayed:function(){return this.hasPlayed},playing:function(){return this.audio.currentTime&&!this.audio.paused}}})},function(e,t){window.PennController._AddElementType("Button",function(e){this.immediate=function(e,t){void 0===t&&(t=e,void 0!==e&&"string"==typeof e&&0!=e.length||(e="Button"),this.id=e),this.initialText=t},this.uponCreation=function(e){this.text=this.initialText,this.jQueryElement=$("<button>").html(this.text),this.clicks=[],this.hasClicked=!1,this.log=!1,this.disabled=!1,this.click=(()=>{this.hasClicked=!0,this.clicks.push(["Click","Click",Date.now(),"NULL"])}),this.jQueryElement[0].onclick=(()=>this.click()),e()},this.end=function(){if(this.log){this.clicks.length||e.controllers.running.save(this.type,this.id,"Click","NA","Never");for(let t in this.clicks)e.controllers.running.save(this.type,this.id,...this.clicks[t])}},this.value=function(){return this.clicks.length?this.clicks[this.clicks.length-1][2]:0},this.actions={click:function(e){this.click(),e()},wait:function(e,t){if("first"==t&&this.hasClicked)e();else{let n=!1,i=this.click;this.click=(()=>{if(i.apply(this),!n)if(t instanceof Object&&t._runPromises&&t.success){let i=this.disabled;this.jQueryElement.attr("disabled",!0),this.disabled="tmp",t._runPromises().then(t=>{"success"==t&&(n=!0,e()),"tmp"==this.disabled&&(this.disabled=i,this.jQueryElement.attr("disabled",i))})}else n=!0,e()})}}},this.settings={callback:function(e,...t){let n=this.click;this.click=async function(){if(!this.disabled)for(let e in t)await t[e]._runPromises();n.apply(this)},e()},log:function(e){this.log=!0,e()},once:function(e){if(this.hasClicked)this.disabled=!0,this.jQueryElement.attr("disabled",!0);else{let e=this.click;this.click=(()=>{e.apply(this),this.disabled=!0,this.jQueryElement.attr("disabled",!0)})}e()}},this.test={clicked:function(){return this.hasClicked}}})},function(e,t){window.PennController._AddElementType("Canvas",function(e){let t=e=>e.match(/^\s*\d+(\.\d+)?(px|pt|pc|vw|vh|em|ex|ch|rem|cm|mm|in|vmin|vmax|[%])?\s*?/);this.immediate=function(n,i,r){if(void 0===n)n="Canvas",this.id=n;else if(void 0===r&&t(String(n))&&t(String(i))){r=i,i=n,n="Canvas";let t=e.controllers.underConstruction;e.controllers.running&&(t=e.controllers.list[e.controllers.running.id]);let s=2;for(;t.elements.hasOwnProperty("Canvas")&&t.elements.Canvas.hasOwnProperty(n);)n+=String(s);this.id=n}this.width=i,this.height=r},this.uponCreation=function(t){this.jQueryElement=$("<div>").css({width:this.width,height:this.height,overflow:"visible",position:"relative",display:"inline-block"}),this.elementCommands=[],this.showElement=((t,n,i,r)=>new Promise(s=>{t.print(this.jQueryElement)._runPromises().then(()=>{let o=t._element,a=o.jQueryElement,l=e.utils.parseCoordinates(n,i,o.jQueryContainer);n=l.x,i=l.y,o.jQueryContainer?(o.jQueryContainer.css({position:"absolute",left:n,top:i}),(Number(r)>0||Number(r)>0)&&o.jQueryContainer.css("z-index",r)):(a.css({position:"absolute",left:n,top:i}),(Number(r)>0||Number(r)>0)&&a.css("z-index",r)),s()})})),t()},this.end=function(){this.log&&(this.printTime?e.controllers.running.save(this.type,this.id,"Print","NA",this.printTime,"NULL"):e.controllers.running.save(this.type,this.id,"Print","NA","Never","NULL"))},this.value=function(){return this.elementCommands.length};let n=this;this.actions={print:async function(t,...n){let i=this;e.elements.standardCommands.actions.print.apply(this,[async function(){for(let e in i.elementCommands)await i.showElement(...i.elementCommands[e]);t()},...n])},remove:async function(t,...i){i.length?n.settings.remove.call(this,t,...i):e.elements.standardCommands.actions.remove.call(this,t)}},this.settings={add:function(t,n,i,r,s){r.hasOwnProperty("_element")&&r._element.jQueryElement instanceof jQuery?(this.elementCommands.push([r,n,i,s]),this.jQueryElement.parent().length?this.showElement(r,n,i,s).then(t):t()):(e.debug.error("Invalid element referenced to add to Canvas "+this.id),t())},remove:async function(t,n){if(n.hasOwnProperty("_element")){let t=this.elementCommands.map(e=>e[0]._element).indexOf(n._element);t>-1?(this.elementCommands.splice(t,1),await n.remove()._runPromises()):e.debug.error("Element referenced to remove from canvas not found in Canvas "+this.id)}else e.debug.error("Invalid element referenced to remove from Canvas "+this.id);t()}}})},function(e,t){window.PennController._AddElementType("Controller",function(e){this.immediate=function(e,t,n){void 0===n&&("string"==typeof t?n={}:(n=t||{},t=e)),this.id=e,this.controller=t,this.options=n},this.uponCreation=function(t){this.jQueryElement=$("<div>"),this.log=!1,this.results=[],this.finishedCallback=(()=>this.done=!0);let n=this;this.options._finishedCallback=function(e){n.done||(n.results.push([Date.now(),e]),addSafeBindMethodPair("PennController"),n.finishedCallback())},this.options._cssPrefix=this.controller+"-",this.options._utils=e.controllers.running.utils;let i=Object.getOwnPropertyNames($.ui).filter(e=>$.ui[e]instanceof Function&&$.ui[e]._ibex_options);if(i.indexOf(this.controller)>=0)addSafeBindMethodPair(this.controller),this.jQueryElement[this.controller](this.options);else{let t={score:1,controllerName:""};for(let n=0;n<i.length;n++){let r=e.utils.levensthein(this.controller,i[n])/this.controller.length;r<t.score&&(t.score=r,t.controllerName=i[n])}t.score<.5&&(add=" Did you mean to type <strong>"+t.controllerName+"</strong>?"),e.debug.error("Controller &lsquo;"+this.controller+"&rsquo; not found."+add)}t()},this.end=function(){if(this.log)for(let t=0;t<this.results.length;t++){let n=this.results[t][0],i=this.results[t][1];for(let t=0;t<i.length;t++){let r=i[t],s="Controller-"+this.controller,o=this.id,a="NULL",l="NULL";r.length>0&&(a=r[0][1]),r.length>1&&(l=r[1][1]);for(let t=2;t<r.length;t++)e.controllers.running.controller.appendResultLine.push([r[t][0],r[t][1]]);e.controllers.running.save(s,o,a,l,n,"Any addtional parameters were appended as additional columns");for(let t=2;t<r.length;t++)e.controllers.running.controller.appendResultLine.pop()}}},this.value=function(){return this.controller},this.actions={wait:function(e,t){if("first"==t&&this.done)e();else{let n=!1,i=this.finishedCallback;this.finishedCallback=(()=>{i.apply(this),n||(t instanceof Object&&t._runPromises&&t.success?t._runPromises().then(t=>{"success"==t&&(n=!0,e())}):(n=!0,e()))})}}}})},function(e,t){window.PennController._AddElementType("DropDown",function(e){this.immediate=function(e,t){void 0===t&&(t=e,void 0!==e&&"string"==typeof e&&0!=e.length||(e="DropDown"),this.id=e),this.id=e,this.initialText=t},this.uponCreation=function(e){this.options=[],this.selections=[],this.change=(()=>{if(this.jQueryElement.attr("disabled"))return;let e=this.jQueryElement.find("option:selected").val(),t=0;for(let n=0;n<this.options.length;n++)this.options[n]==e&&(t=n);this.selections.push(["Selected",e,Date.now(),t])}),this.jQueryElement=$("<select>").append($("<option>").html(this.initialText).attr({value:this.initialText,selected:!0,disabled:!0,hidden:!0})).change(()=>this.change()),e()},this.value=function(){let e=this.selections;return e instanceof Array&&e.length>0?e[e.length-1][1]:""},this.end=function(){if(this.log)if(this.selections.length)if("string"==typeof this.log&&this.log.match(/^\W*first\W*$/i))e.controllers.running.save(this.type,this.id,...this.selections[0]);else if("string"==typeof this.log&&this.log.match(/^\W*all\W*$/i))for(let t=0;t<this.selections.length;t++)e.controllers.running.save(this.type,this.id,...this.selections[t]);else e.controllers.running.save(this.type,this.id,...this.selections[this.selections.length-1]);else e.controllers.running.save(this.type,this.id,"Selected",this.jQueryElement.find("option:selected").val(),"Never","Default")};let t=this;this.actions={shuffle:function(e,t){if(t){let e=this.jQueryElement.find("option:selected");t=!!e.length&&e.val()}fisherYates(this.options),this.jQueryElement.empty(),this.jQueryElement.append($("<option>").html(this.initialText).attr({value:this.initialText,selected:!0,disabled:!0,hidden:!0}));for(let e=0;e<this.options.length;e++)this.jQueryElement.append($("<option>").html(this.options[e]).attr("value",this.options[e]));t&&this.jQueryElement.find("option[value='"+t+"']").attr("selected",!0),e()},remove:function(n,...i){i.length?t.settings.remove.call(this,n,...i):e.elements.standardCommands.actions.remove.call(this,n)},select:function(e,t){this.options.indexOf(t)>-1?(this.jQueryElement.find("option").removeAttr("selected"),this.jQueryElement.find("option[value='"+t+"']").attr("selected",!0)):Number(t)>-1&&Number(t)<this.options.length&&(this.jQueryElement.find("option").removeAttr("selected"),this.jQueryElement.find("option[value='"+this.options[Number(t)]+"']").attr("selected",!0)),e()},wait:function(e,t){if("first"==t&&this.selections.length)e();else{let n=!1,i=this.change;this.change=(()=>{if(i.call(this),!n)if(t instanceof Object&&t._runPromises&&t.success){let i=this.disabled;this.jQueryElement.attr("disabled",!0),this.disabled="tmp",t._runPromises().then(t=>{"success"==t&&(n=!0,e()),"tmp"==this.disabled&&(this.disabled=i,this.jQueryElement.attr("disabled",i))})}else n=!0,e()})}}},this.settings={add:function(e,...t){for(let e=0;e<t.length;e++)t[e]=String(t[e]),this.options.indexOf(t[e])<0&&(this.options.push(t[e]),this.jQueryElement.append($("<option>").html(t[e]).attr("value",t[e])));e()},callback:function(e,...t){let n=this.change;this.change=async function(){let e=this.jQueryElement.attr("disabled");if(await n.apply(this),!e)for(let e=0;e<t.length;e++)t[e]._runPromises?await t[e]._runPromises():t[e]instanceof Function&&await t[e]()},e()},once:function(e){let t=this.change;this.change=(()=>{t.apply(this),this.jQueryElement.attr("disabled",!0)}),e()},remove:function(e,t){let n=this.options.indexOf(t);n>-1&&(this.jQueryElement.find("option[value='"+t+"']").remove(),this.options.splice(n,1)),e()}},this.test={selected:function(e){let t=this.jQueryElement.find("option:selected");return!!this.selections.length&&(void 0===e||(e==t.val()||(Number(e)>-1&&Number(e)<this.options.length?t.val()==this.options[Number(e)]:void 0)))}}})},function(e,t){window.PennController._AddElementType("EyeTracker",function(e){let t,n,i,r=!1,s=!1,o=[[],[]],a=!1,l=null,u="";function h(e){for(var t,n={},i=(e+"").split(""),r=[],s=i[0],o=256,a=1;a<i.length;a++)null!=n[s+(t=i[a])]?s+=t:(r.push(s.length>1?n[s]:s.charCodeAt(0)),n[s+t]=o,o++,s=t);r.push(s.length>1?n[s]:s.charCodeAt(0));for(a=0;a<r.length;a++)r[a]=String.fromCharCode(r[a]);return r.join("")}function c(){if(window.webgazer&&t)return window.webgazer;e.debug.error("Tried to access the EyeTracker before it was set.")}function d(e){e=!(!1===e),c().showFaceFeedbackBox(e),c().showFaceOverlay(e),c().showPredictionPoints(e),c().showVideo(e),$("#webgazerGazeDot").css("pointer-events","none")}function f(e){let t=$(window).height(),n=$(window).width(),i=e[0],r=e[1],s=n/2,o=t/2,a=new Array(50);!function(e,t,n,i,r,s){for(x=0;x<50;x++){let o=r-n[x],a=s-i[x],l=Math.sqrt(o*o+a*a),u=t/2,h=0;l<=u&&l>-1?h=100-l/u*100:l>u?h=0:l>-1&&(h=100),e[x]=h}}(a,t,i,r,s,o);let l=function(e){let t=0;for(x=0;x<50;x++)t+=e[x];return t/=50}(a);return Math.round(l)}window.PennController.EyeTrackerURL=(e=>u=e);let p=function(){i=e.utils.guidGenerator(),r=!0;let a=document.createElement("script");a.setAttribute("src","https://webgazer.cs.brown.edu/webgazer.js"),document.head.appendChild(a);let u=()=>{window.webgazer?function(){o=[[],[]],t=window.webgazer.setRegression("weightedRidge").setTracker("clmtrackr").setGazeListener((e,t)=>{s&&(o[0].push(e.x),o[1].push(e.y),o[0].length>50&&o[0].shift(),o[1].length>50&&o[1].shift()),n&&n.look(e,t)});let e=document.addEventListener;document.addEventListener=function(...t){"mousemove"!=t[0]||"function"!=typeof t[1]||l||(l=t[1]),e.apply(document,t)},t.begin().showPredictionPoints(!0),d(!1)}():setTimeout(u,100)};void 0===t&&u()};this.immediate=function(e,t,n){r||p(),"number"==typeof e&&(void 0===t||"number"==typeof t&&void 0===n)&&(n=t,t=e,void 0!==e&&"string"==typeof e&&0!=e.length||(e="EyeTracker"),this.id=e),this.span=Number(t),this.proportion=n},this.uponCreation=function(e){let t;this.enabled=!1,this.elements=[],this.counts={times:[]},this.callback=null,this.log=!1,this.trainOnMouseMove=!0,this.look=function(e,n){if(this.enabled&&null!=e&&void 0!==e.x&&void 0!==e.y){this.elements.map(e=>e.jQueryElement.removeClass("PennController-eyetracked"));for(let t=0;t<this.elements.length;t++){let n=this.elements[t].jQueryElement,i=n.offset(),r=n.width(),s=n.height(),o=i.left<=e.x&&i.top<=e.y&&i.left+r>=e.x&&i.top+s>=e.y;if(o?this.counts["_"+this.elements[t].id].push(1):this.counts["_"+this.elements[t].id].push(0),isNaN(this.span))o&&(n.addClass("PennController-eyetracked"),this.callback&&this.callback instanceof Function&&this.callback.call(this.elements[t],e.x,e.y));else{this.hasOwnProperty("gazes")&&this.elements.length==this.gazes.length||(this.gazes=this.elements.map(()=>[])),o?this.gazes[t].push(!0):this.gazes[t].push(!1),this.gazes[t].length>this.span&&this.gazes[t].shift();let i=Number(this.proportion);isNaN(i)&&(i=this.span/100),i<=0?i=.01:i>=1&&(i=.99),this.gazes[t].filter(e=>e).length/this.gazes[t].length>i&&n.addClass("PennController-eyetracked"),this.callback&&this.callback instanceof Function&&this.callback.call(this.elements[t],e.x,e.y)}}void 0===t&&(t=n),this.counts.times.push(Math.round(n-t)),t=n}},e()},this.end=function(){if(d(!1),c().removeMouseEventListeners(),this.enabled=!1,n=void 0,this.log&&this.counts.times.length){let t=u,n=window.location.href.replace(/[^/]+$/,"").replace(/[^\w\d]/g,"").replace(/[\.]{2,}/g,"");e.debug.log("expname",n);let r=(r,s)=>{let o={experiment:n,id:i,pcnumber:e.controllers.running.id,parameter:r,value:s},a="json="+JSON.stringify(o);var l=new XMLHttpRequest;l.open("POST",t,!0),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),l.onreadystatechange=(()=>{200!=l.status&&e.controllers.running.save(this.type,this.id,"Upload","Error",Date.now(),r)}),l.send(a)};e.debug.log("about to send times",this.counts),r("times",h(this.counts.times.join("."))),delete this.counts.times;let s=Object.keys(this.counts);for(let e=0;e<s.length;e++)r(s[e],h(this.counts[s[e]].join(".")));e.controllers.running.save(this.type,this.id,"Filename",n+"/"+i,Date.now(),"NULL")}delete this.counts},this.value=function(){return"EyeTracker"},this.actions={calibrate(t,n,i){Number(i)>0||(i=-1),function t(n,i,r,u){c().addMouseEventListeners(),i.trainOnMouseMove||document.removeEventListener("mousemove",l,!0),e.debug.log("Starting calibration"),o=[[],[]];let h=$("<div>").css({position:"absolute",left:0,top:0,width:"100vw",height:"100vh","background-color":"white","text-align":"center"}),p=()=>{h.find("button").remove(),h.append($("<button>+</button>").css({position:"absolute",top:"calc(50vh - 1.25vw)",bottom:"48.75vw",width:"2.5vw",height:"2.5vw"}).click(function(){$(this).attr("disabled",!0),s=!0,setTimeout(()=>{let l=f(o);e.debug.log("Tracker's precision: "+l),s=!1,o=[[],[]],e.controllers.running.save(i.type,i.id,"calibration",l,Date.now(),1==u?"Last attempt":"NULL"),r&&Number(r)>0&&l<r&&1!=u?(a=!1,$(this).remove(),d(!0),h.append($("<div>").html("<p>It looks like we were not able to precisely calibrate the tracker:</p><p>You calibration score is "+l+" and you need at least "+r+"</p><p>Here are a few tips to help you better self-calibrate:</p><p>- try adjusting your webcam based on the video in the top-left corner.</p><p>- if you use an external webcam, make sure it is fixed to the top of your screen.</p><p>- try raising your screen so as to align your webcam with your eyes</p><p><img style='display: inline-block; height: 75px;' src='http://files.lab.florianschwarz.net/ibexfiles/Pictures/lookdown.png'><img style='display: inline-block; height: 75px;' src='http://files.lab.florianschwarz.net/ibexfiles/Pictures/lookstraight.png'></p><p>- make sure no one is standing next to you.</p><p>- make sure you are not wearing eyeglasses reflecting ambiant light.</p><p>- make sure the algorithm detects your face (it should appear green).</p><p>- make sure there is enough ambient light for face-detection.</p><p>- make sure you follow your mouse pointer with your eyes.</p><p>- make sure you keep looking at the middle button until the end.</p>").css({margin:"auto","margin-top":"5em"})).append($("<button>Retry</button>").click(function(){h.remove(),window.webgazer.reg.RidgeWeightedReg.call(window.webgazer.getRegression()[0]),t(n,i,r,u-1)}).css("margin","auto"))):(a=!0,h.remove(),d(!1),c().removeMouseEventListeners(),n())},2e3)}))};if(a)p();else{let e=8,t=function(){$(this).attr("disabled",!0),--e<=0&&p()};h.append($("<button>Start calibration</button>").css({position:"absolute",top:"calc(50vh - 2.5vw)",left:"47.5vw",width:"5vw",height:"5vw"}).click(function(){$(this).remove(),d(!1),c().showPredictionPoints(!0),h.append($("<button>+</button>").css({position:"absolute",top:0,left:0,width:"2.5vw",height:"2.5vw"}).click(t)).append($("<button>+</button>").css({position:"absolute",top:0,right:0,width:"2.5vw",height:"2.5vw"}).click(t)).append($("<button>+</button>").css({position:"absolute",bottom:0,left:0,width:"2.5vw",height:"2.5vw"}).click(t)).append($("<button>+</button>").css({position:"absolute",bottom:0,right:0,width:"2.5vw",height:"2.5vw"}).click(t)).append($("<button>+</button>").css({position:"absolute",top:"calc(50vh - 1.25vw)",left:0,width:"2.5vw",height:"2.5vw"}).click(t)).append($("<button>+</button>").css({position:"absolute",top:0,left:"48.75vw",width:"2.5vw",height:"2.5vw"}).click(t)).append($("<button>+</button>").css({position:"absolute",top:"calc(50vh - 1.25vw)",right:0,width:"2.5vw",height:"2.5vw"}).click(t)).append($("<button>+</button>").css({position:"absolute",bottom:0,left:"48.75vw",width:"2.5vw",height:"2.5vw"}).click(t))})),d(!0)}$("#webgazerVideoFeed").before(h)}(t,this,n,i)},hideFeedback:function(e){d(!1),e()},start:function(e){this.enabled=!0,n=this,e()},stop:function(e){this.enabled=!1,n=void 0,e()},stopTraining:function(e){c().removeMouseEventListeners(),c().showPredictionPoints(!1),e()},showFeedback:function(e){d(),e()},train:function(e,t){c().addMouseEventListeners(),this.trainOnMouseMove||document.removeEventListener("mousemove",l,!0),c().showPredictionPoints(t),e()}},this.settings={add:function(e,...t){for(let e=0;e<t.length;e++){let n=t[e];n&&n._element&&this.elements.indexOf(n._element)<0&&(this.elements.push(n._element),this.counts["_"+n._element.id]=[])}e()},callback:function(e,t){t instanceof Function&&(this.callback=t),e()},log:function(e){this.log=!0,e()},trainOnMouseMove:function(e,t){this.trainOnMouseMove=void 0===t||t,this.trainOnMouseMove||document.removeEventListener("mousemove",l,!0),e()}},this.test={calibrated:function(){return a},ready:function(){return window.webgazer&&window.webgazer.isReady()}}})},function(e,t){window.PennController._AddElementType("Function",function(e){this.immediate=function(e,t){"function"==typeof e&&(t=e,void 0!==e&&"string"==typeof e&&0!=e.length||(e="Function"),this.id=e),this.function=t},this.uponCreation=function(t){e.controllers.running.hasOwnProperty("internalVariables")||(e.controllers.running.internalVariables={}),t()},this.end=function(){e.controllers.running.internalVariables=void 0},this.value=function(){return this.function.apply(e.controllers.running.internalVariables)},this.actions={call:async function(t){await this.function.apply(e.controllers.running.internalVariables),t()}},this.test={is:function(t){let n=this.function.apply(e.controllers.running.internalVariables);return void 0===t?!n:n==t}}})},function(e,t){window.PennController._AddElementType("Html",function(e){function t(e,t){var n=$("label.error[for=__ALL_FIELDS__]");if(n.length>0)n.addClass("Form-error-text").text(t);else{var i=$("label.error[for="+escape(e)+"]");i.length>0?i.addClass("Form-error-text").text(t):alert(t)}}function n(){for(var e=this.jQueryElement[0],t=$(e).find("input[type=text]"),n=$(e).find("textarea"),i=0;i<n.length;++i)t.push(n[i]);for(i=0;i<t.length;++i){var r=$(t[i]);if(r.hasClass("obligatory")&&(!r.attr("value")||r.attr("value").match(/^\s*$/)))return!1}var s=$(e).find("input[type=checkbox]");for(i=0;i<s.length;++i){var o=$(s[i]);if(!o.attr("checked")&&o.hasClass("obligatory"))return!1}var a=$(e).find("input[type=radio]"),l={};for(i=0;i<a.length;++i){var u=$(a[i]);u.attr("name")&&(l[u.attr("name")]||(l[u.attr("name")]=[]),l[u.attr("name")].push(u))}for(var h in l){var c=!1,d=!1;for(i=0;i<l[h].length;++i)l[h][i].hasClass("obligatory")&&(c=!0),l[h][i].attr("checked")&&(d=!0);if(c&&!d)return!1}return!0}this.immediate=function(e,t){void 0===t&&(t=e,void 0!==e&&"string"==typeof e&&0!=e.length||(e="Html"),this.id=e),this.html=t},this.uponCreation=function(e){CHUNKS_DICT.hasOwnProperty(this.html)?this.jQueryElement=$("<div>").html(htmlCodeToDOM({include:this.html})):this.jQueryElement=$("<div>").append(this.html),this.log=!1,this.checkboxWarningMessage="You must check the %name% checkbox to continue.",this.inputWarningMessage="The %name% field is obligatory.",this.radioWarningMessage="You must select an option for %name%.",e()},this.end=function(){if(this.log){for(var t=this.jQueryElement[0],n=$(t).find("input[type=text]"),i=$(t).find("textarea"),r=0;r<i.length;++r)n.push(i[r]);for(r=0;r<n.length;++r){var s=$(n[r]);e.controllers.running.save(this.type,this.id,csv_url_encode(s.attr("name")),csv_url_encode(s.attr("value")),Date.now(),"text input")}var o=$(t).find("input[type=checkbox]");for(r=0;r<o.length;++r){var a=$(o[r]);e.controllers.running.save(this.type,this.id,a.attr("name"),a.attr("checked")?"checked":"unchecked",Date.now(),"checkbox")}var l=$(t).find("input[type=radio]"),u={};for(r=0;r<l.length;++r){var h=$(l[r]);h.attr("name")&&(u[h.attr("name")]||(u[h.attr("name")]=[]),u[h.attr("name")].push(h))}for(var c in u){var d,f=!1;for(r=0;r<u[c].length;++r)u[c][r].attr("checked")&&(f=!0,d=r);f&&e.controllers.running.save(this.type,this.id,u[c][0].attr("name"),u[c][d].attr("value"),Date.now(),"radio button")}}},this.value=function(){return n.apply(this)},this.actions={warn:function(e){for(var n=this.jQueryElement[0],i=$(n).find("input[type=text]"),r=$(n).find("textarea"),s=0;s<r.length;++s)i.push(r[s]);for(s=0;s<i.length;++s){var o=$(i[s]);!o.hasClass("obligatory")||o.attr("value")&&!o.attr("value").match(/^\s*$/)||t(o.attr("name"),this.inputWarningMessage.replace(/%name%/gi,o.attr("name")))}var a=$(n).find("input[type=checkbox]");for(s=0;s<a.length;++s){var l=$(a[s]);!l.attr("checked")&&l.hasClass("obligatory")&&t(l.attr("name"),this.checkboxWarningMessage.replace(/%name%/gi,l.attr("name")))}var u=$(n).find("input[type=radio]"),h={};for(s=0;s<u.length;++s){var c=$(u[s]);c.attr("name")&&(h[c.attr("name")]||(h[c.attr("name")]=[]),h[c.attr("name")].push(c))}for(var d in h){var f=!1,p=!1;for(s=0;s<h[d].length;++s)h[d][s].hasClass("obligatory")&&(f=!0),h[d][s].attr("checked")&&(p=!0);f&&!p&&t(h[d][0].attr("name"),this.radioWarningMessage.replace(/%name%/gi,h[d][0].attr("name")))}e()}},this.settings={checkboxWarning:function(e,t){this.checkboxWarningMessage=t,e()},inputWarning:function(e,t){this.inputWarningMessage=t,e()},log:function(e){this.log=!0,e()},radioWarning:function(e,t){this.radioWarningMessage=t,e()}},this.test={complete:function(){return n.apply(this)}}})},function(e,t){window.PennController._AddElementType("Image",function(e){this.immediate=function(t,n){"string"==typeof t&&void 0===n&&(n=t),this.id=t;let i=!n.match(/^http/i);this.resource=e.resources.fetch(n,function(e){this.object=new Image,this.object.onload=e,this.object.src=this.value},i)},this.uponCreation=function(e){this.image=this.resource.object,this.image&&(this.image.style=null),this.jQueryElement=$(this.image),e()},this.end=function(){this.log&&(this.printTime?e.controllers.running.save(this.type,this.id,"Print","NA",this.printTime,"NULL"):e.controllers.running.save(this.type,this.id,"Print","NA","Never","NULL"))},this.value=function(){return this.jQueryElement.parent().length}})},function(e,t){window.PennController._AddElementType("Key",function(e){this.immediate=function(t,...n){n.length<1&&(n=[t],void 0!==t&&"string"==typeof t&&0!=t.length||(t="Key"),this.id=t),this.keys=[],this.specialKeys=[];for(let i=0;i<n.length;i++)Number(n[i])>0?this.keys.push(String.fromCharCode(n[i])):"string"!=typeof n[i]?e.debug.error("Invalid key(s) passed to new Key &quot;"+t+"&quot; (should be a string or a key code number)",n[i]):n[i].isSpecialKey()||n[i].replace(/^(Left|Right)/i,"").isSpecialKey()?this.specialKeys.push(n[i].toUpperCase()):n[i].length&&this.keys.push(n[i].toUpperCase())},this.uponCreation=function(t){this.pressed=[],this.pressedWait=[],this.log=!1,this.enabled=!0,e.events.keypress(e=>{if(!this.enabled)return;let t=e.key.isSpecialKey(),n=e.key.toUpperCase(),i={0:"",1:"LEFT",2:"RIGHT"};(0==this.keys.length&&0==this.specialKeys.length||t&&this.specialKeys.filter(t=>t==n||t===i[e.location]+n).length||!t&&this.keys.filter(e=>e.indexOf(n)>-1).length)&&this.press(e.key)}),this.press=(e=>{this.pressed.push(["PressedKey",e.toUpperCase(),Date.now(),"NULL"])}),t()},this.end=function(){if(this.log&&this.log instanceof Array)if(this.pressed.length||e.controllers.running.save(this.type,this.id,"Key","NA","Never","NULL"),this.log.indexOf("all")>-1)for(let t in this.pressed)e.controllers.running.save(this.type,this.id,...this.pressed[t]);else if(this.log.indexOf("wait")>-1){let t=!1;for(let n in this.pressed)"Wait success"==this.pressed[n][3]&&(e.controllers.running.save(this.type,this.id,...this.pressed[n]),t=!0);t||e.controllers.running.save(this.type,this.id,"Key","NA","Never","(failed keypresses happened)")}else 1==this.pressed.length?e.controllers.running.save(this.type,this.id,...this.pressed[0]):(this.log.indexOf("first")>-1&&e.controllers.running.save(this.type,this.id,...this.pressed[0]),this.log.indexOf("last")>-1&&e.controllers.running.save(this.type,this.id,...this.pressed[this.pressed.length-1]))},this.value=function(){return this.pressed.length?this.pressed[this.pressed.length-1][1]:""},this.actions={wait:function(e,t){if("first"==t&&this.pressed.length)e();else{let n=!1,i=this.press,r=document.activeElement;for(;r;)r.disabled?(r.blur(),r=null):r=r.parentElement;this.press=(r=>{if(i.apply(this,[r]),!n)if(t instanceof Object&&t._runPromises&&t.success){let i=this.enabled;this.enabled=0,t._runPromises().then(t=>{"success"==t?(this.pressed[this.pressed.length-1][3]="Wait success",n=!0,e()):this.pressed[this.pressed.length-1][3]="Wait failure",0===this.enabled&&(this.enabled=i)})}else this.pressed[this.pressed.length-1][3]="Wait success",n=!0,e()})}}},this.settings={callback:function(e,...t){let n=this.press;this.press=async function(e){if(n.apply(this,[e]),this.enabled)for(let e in t)await t[e]._runPromises()},e()},disable:function(e){this.enabled=!1,e()},enable:function(e){this.enabled=!0,e()},log:function(e,...t){t.length?this.log=t:this.log=["wait"],e()}},this.test={pressed:function(e,t){for(let n in this.pressed){let i=this.pressed[n][1];if(Number(e)>0&&i.toUpperCase()==String.fromCharCode(e).toUpperCase())return!0;if("string"==typeof e&&e.toUpperCase()==i.toUpperCase())return!0;if(void 0===e)return!0;if(t)return!1}return!1}}})},function(e,t){window.PennController._AddElementType("MouseTracker",function(e){let t,n;this.immediate=function(e){void 0!==e&&"string"==typeof e&&0!=e.length||(e="MouseTracker"),this.id=e,$(document).mousemove(e=>{t=e.clientX,n=e.clientY,this.move&&this.move instanceof Function&&this.move(e)})},this.uponCreation=function(e){this.coordinates=[],this.enabled=!1,this.callbacks=[],this.currentStream=[];let i=this;this.move=async function(){if(i.enabled&&(i.currentStream.push([Date.now(),t,n]),i.callbacks.length))for(let e=0;e<i.callbacks.length;e++)i.callbacks[e]instanceof Function?await i.callbacks[e].apply(this,[t,n]):i.callbacks[e]._runPromises&&i.callbacks[e]._runPromises instanceof Function&&await i.callbacks[e]._runPromises(t,n)},this.finishStream=(()=>{if(this.currentStream.length>1){let e=this.currentStream[0][1],t=this.currentStream[0][2],n=this.currentStream[0][0];void 0===e&&(e=this.currentStream[1][1]),void 0===t&&(t=this.currentStream[1][2]);let i="x"+e+"y"+t+"w"+this.currentStream[0][3]+"h"+this.currentStream[0][4];for(let r=1;r<this.currentStream.length;r++){let s=this.currentStream[r][1]-e,o=this.currentStream[r][2]-t;i+="t"+(this.currentStream[r][0]-n),i+=(s>=0?"+":"")+s,i+=(o>=0?"+":"")+o,e=this.currentStream[r][1],t=this.currentStream[r][2],n=this.currentStream[r][0]}let r="NULL";window.innerWidth==this.currentStream[0][3]&&window.innerHeight==this.currentStream[0][4]||(r="Size of window changed to "+window.innerWidth+" * "+window.innerHeight),this.coordinates.push([i,this.currentStream[0][0],r])}this.currentStream=[]}),e()},this.end=function(){if(this.enabled=!1,this.finishStream(),this.log&&this.coordinates.length)for(let t=0;t<this.coordinates.length;t++)e.controllers.running.save(this.type,this.id,"Move",...this.coordinates[t])},this.value=function(){return t&&n?t+"-"+n:"NA-NA"},this.actions={start:function(e){this.currentStream=[[Date.now(),t,n,window.innerWidth,window.innerHeight]],this.enabled=!0,e()},stop:function(e){this.enabled=!1,this.finishStream(),e()}},this.settings={callback:function(e,...t){0!=t.length&&(this.callbacks=this.callbacks.concat(t),e())},log:function(e){this.log=!0,e()}}})},function(e,t){window.PennController._AddElementType("Palette",function(e){this.immediate=function(e,t){void 0===t&&(t=e),this.mode=t||"background",void 0!==e&&"string"==typeof e&&0!=e.length||(e="Palette"),this.id=e},this.uponCreation=function(e){this.currentColor=null,this.enabled=!0,this.elements=[],this.colors=[],this.brushes=[],this.log=!1,this.select=(e=>{if(!this.enabled||!this.currentColor)return;let t=this.elements.map(e=>e[0]).indexOf(e);if(t<0)return;this.elements[t][1]=this.currentColor;let n=e.jQueryElement;this.brushes.push([e.id,this.currentColor,Date.now()]),"background"==this.mode?n.css("background-color",this.currentColor):(n._tinter&&n._tinter instanceof jQuery&&n._tinter.remove(),n._tinter=$("<div>").css({display:"block",position:"absolute",width:n.width(),height:n.height(),"margin-top":-1*n.width(),background:this.elements[t][1],opacity:.5}),n.before(n._tinter))}),e()},this.end=function(){if(this.enabled=!1,$("#bod").css("cursor","default"),this.log){if("all"==this.log)for(let t=0;t<this.brushes.length;t++)e.controllers.running.save(this.type,this.id,this.brushes[t][0],this.brushes[t][1],this.brushes[t][2],"NULL");for(let t=0;t<this.elements.length;t++)e.controllers.running.save(this.type,this.id,this.elements[t][0].id,this.elements[t][1],"Final","NULL")}},this.value=function(){return this.brushes.length},this.actions={brush:function(e,t,n){if(t._element){let e=this.currentColor;this.currentColor=n,this.select(t._element),this.currentColor=e}e()},clear:function(e){for(let e in this.elements)"background"==this.mode?this.elements[e][0].jQueryElement.css("background-color","transparent"):this.elements[e].jQueryElement._tinter&&this.elements[e][0].jQueryElement._tinter.remove(),this.elements[e][1]=null;e()},unselect:function(e){$(".PennController-"+this.type+"-palette-selected").removeClass("PennController-"+this.type+"-palette-selected"),$("#bod").css("cursor","default"),this.currentColor=null,e()},wait:function(e,t){if("first"==t&&this.brushes.length)e();else{let n=!1,i=this.select;this.select=(r=>{let s=i.apply(this,[r]);n||!this.enabled&&!s||(t instanceof Object&&t._runPromises&&t.success?t._runPromises().then(t=>{"success"==t&&(n=!0,e())}):(n=!0,e()))})}}},this.settings={addColor:function(t,n,...i){this.colors.indexOf(n)<0&&this.colors.push(n);let r=[],s=()=>{this.colors.indexOf(n)<0||(this.currentColor=n,$(".PennController-"+this.type+"-palette-selected").removeClass("PennController-"+this.type+"-palette-selected"),r.map(e=>e.jQueryElement.addClass("PennController-"+this.type+"-palette-selected")),$("#bod").css("cursor","crosshair"))};for(let t in i){let n=i[t];"string"==typeof n?e.events.keypress(e=>{n.toUpperCase().indexOf(String.fromCharCode(e.which).toUpperCase())>-1?s():27==e.which&&($(".PennController-"+this.type+"-palette-selected").removeClass("PennController-"+this.type+"-palette-selected"),$("#bod").css("cursor","default"),this.currentColor=null)}):n._element&&n._element.jQueryElement&&(n._element.jQueryElement.bind("click",s),n._element.jQueryElement.addClass("PennController-"+this.type+"-palette"),n._element.jQueryElement.addClass("PennController-"+this.id+"-palette"),r.push(n._element))}t()},addElement:function(e,...t){for(let e in t){let n=t[e];n._element&&n._element.jQueryElement&&(n._element.jQueryElement.bind("click",()=>{this.select(n._element)}),this.elements.map(e=>e[0]).indexOf(n._element)<0&&this.elements.push([n._element,null]))}e()},callback:function(e,...t){let n=this.select;this.select=async function(e){if(n.apply(this,[e]),this.enabled)for(let e in t)await t[e]._runPromises()},e()},enable:function(e){this.jQueryContainer.removeClass("PennController-disabled"),this.jQueryElement.removeClass("PennController-disabled"),this.enabled=!0,e()},disable:function(e){this.jQueryContainer.addClass("PennController-disabled"),this.jQueryElement.addClass("PennController-disabled"),this.enabled=!1,e()},log:function(e,t){this.log=t||"all",e()},once:function(e){if(this.brushes.length)this.enabled=!1,$(".PennController-"+this.type+"-palette-selected").removeClass("PennController-"+this.type+"-palette-selected"),$("#bod").css("cursor","default"),this.currentColor=null;else{let e=this.select;this.select=(t=>{if(e.apply(this,[t]),this.enabled)return this.enabled=!1,$(".PennController-"+this.type+"-palette-selected").removeClass("PennController-"+this.type+"-palette-selected"),$("#bod").css("cursor","default"),this.currentColor=null,"once"})}e()},removeColor:function(e,t){let n=this.colors.indexOf(t);n>-1&&this.colors.splice(n,1),e()}},this.test={color:function(e,t){if(e._element&&e._element){let n=this.elements.map(e=>e[0]).indexOf(e._element);return!(n<0)&&this.elements[n][1]==t}return!1}}})},function(e,t){window.PennController._AddElementType("Scale",function(e){function t(){this.jQueryElement.find("input").attr("disabled",!0),this.jQueryElement.find("div,label").css("cursor",""),this.disabled=!0}function n(e,t){if("slider"==this.scaleType?this.jQueryElement.find("input[type=range]")[0].value=e:this.jQueryElement.find(`input#${this.id}-${e}`).attr("checked",!0).change(),t){let t=this.buttons[e];null!=t&&""!=t||(t=e+1),this.choice(t)}}function i(){let e=this.defaultValue,t=this.orientation,n=this.scaleType;if(this.jQueryElement.empty(),"slider"==n){var i=$("<input>").attr({type:"range",min:"0",max:String(this.buttons.length-1),value:String((this.buttons.length-1)/2),step:"1"});Number(e)>=0&&Number(e)<=this.buttons.length-1&&i.attr("value",String(e)),this.disabled&&i.attr("disabled",!0),i[0].oninput=(()=>{this.firstClick||(this.firstClick=Date.now())}),i[0].onchange=(()=>this.choice(i[0].value)),"vertical"==t&&(i.attr("orient","vertical"),i.css({"writing-mode":"vertical-lr","-webkit-appearance":"slider-vertical"})),i.css({width:"100%",height:"100%"}),this.jQueryElement.append(i)}else{this.jQueryElement.css({display:"inline-flex","justify-content":"space-between"});for(let t=0;t<this.buttons.length;t++){let i=this.buttons[t];null!=i&&""!=i||(i=t+1);let r=$("<label>").attr({for:this.id+"-"+t}).html(i).css("cursor","pointer"),s=$("<input>").attr({name:this.id,value:i,type:"radio",id:this.id+"-"+t}),o=$("<div>").addClass("option").css({cursor:"pointer",display:"flex","align-items":"center"}).append(s).append(r);i._runPromises&&i.print(r.empty())._runPromises(),e!=i&&e!=t||s.attr("checked",!0),this.disabled&&s.attr("disabled",!0),s[0].onchange=(()=>{this.choice(this.buttons[t]||i),this.jQueryElement.find("label").css("outline","none"),"buttons"==n&&r.css("outline","dotted 1px black")}),"buttons"==n&&s.css("display","none"),"top"==this.labels?o.css("flex-direction","column-reverse"):"bottom"==this.labels?o.css("flex-direction","column"):"left"==this.labels&&o.css("flex-direction","row-reverse"),this.jQueryElement.append(o)}"vertical"==t&&this.jQueryElement.css("flex-direction","column")}this.width||this.jQueryElement.css("max-width","max-content")}this.immediate=function(e,...t){t.length||(t=[e],void 0!==e&&"string"==typeof e&&0!=e.length||(e="Scale")),this.id=e,"string"!=typeof t[0]&&Number(t[0])>0?this.initialButtons=new Array(Number(t[0])):this.initialButtons=t},this.uponCreation=function(t){this.jQueryElement=$("<div>").css("display","inline-block"),this.choices=[],this.log=!1,this.labels=!1,this.disabled=!1,this.vertical=!1,this.scaleType="radio",this.defaultValue=null,this.orientation="horizontal",this.width=null,this.keys=[],this.buttons=this.initialButtons,this.choice=(e=>{if(this.disabled)return;this.unselected=void 0,e&&e._runPromises&&(e=e._element.id);let t=null;"slider"==this.scaleType&&this.firstClick&&(t=Date.now()-this.firstClick,this.firstClick=void 0),this.choices.push(["Choice",e,Date.now(),t||"NULL"])}),e.controllers.running.safeBind($(document),"keydown",e=>{if(!this.disabled)for(let t=0;t<this.keys.length;t++)if(String.fromCharCode(e.which)==this.keys[t])return n.apply(this,[t,!0])}),t()},this.end=function(){if(this.log&&this.log instanceof Array)if(this.choices.length)if(1==this.choices.length)e.controllers.running.save(this.type,this.id,...this.choices[0]);else if(this.log.indexOf("all")>-1)for(let t in this.choices)e.controllers.running.save(this.type,this.id,...this.choices[t]);else this.log.indexOf("first")>-1&&e.controllers.running.save(this.type,this.id,...this.choices[0]),this.log.indexOf("last")>-1&&e.controllers.running.save(this.type,this.id,...this.choices[this.choices.length-1]);else e.controllers.running.save(this.type,this.id,"Choice","NA","Never","No selection happened")},this.value=function(){return this.choices.length&&void 0===this.unselected?this.choices[this.choices.length-1][1]:NaN},this.actions={print:function(t,...n){i.apply(this),e.elements.standardCommands.actions.print.apply(this,[t,...n])},select:function(t,i,r){for(var s=0;s<this.buttons.length;s++){let e=this.buttons[s];if(e&&e==i)break;if(e&&e._element&&e._element.id==i)break;if(s==i)break}if(s>=this.buttons.length)return t(e.debug.error("Option "+i+" not found for selection on Scale "+this.id));n.apply(this,[s,r]),t()},unselect:function(e){if("slider"==this.scaleType){let e=this.jQueryElement.find("input[type=range]")[0];e.value=(e.max-e.min)/2}else this.jQueryElement.find("input").removeAttr("checked").change();this.unselected=!0,e()},wait:function(e,t){if("first"==t&&this.choices.length)e();else{let n=!1,i=this.choice;this.choice=(r=>{if(i.apply(this,[r]),!n)if(t instanceof Object&&t._runPromises&&t.success){let i=this.disabled;this.disabled="tmp",t._runPromises().then(t=>{"success"==t&&(n=!0,e()),"tmp"==this.disabled&&(this.disabled=i)})}else n=!0,e()})}}},this.settings={button:function(e){this.scaleType="buttons",i.apply(this),e()},callback:function(e,...t){let n=this.choice;this.choice=async function(e){let i=this.disabled;if(n.apply(this,[e]),!i)for(let e in t)await t[e]._runPromises()},e()},default:function(t,n){this.buttons.indexOf(n)>-1||Number(n)>=0&&Number(n)<this.buttons.length?(this.defaultValue=n,n._element&&(n=n._element.id),this.choices.push(["Default",n,Date.now(),this.scaleType])):e.debug.error("Invalid default value for Scale "+this.id,n),t()},disable:function(e){t.apply(this),this.jQueryContainer.addClass("PennController-disabled"),this.jQueryElement.addClass("PennController-disabled"),e()},enable:function(e){(function(){this.jQueryElement.find("input").removeAttr("disabled"),this.jQueryElement.find("div").css("cursor","pointer"),this.disabled=!1}).apply(this),this.jQueryContainer.removeClass("PennController-disabled"),this.jQueryElement.addClass("PennController-disabled"),e()},horizontal:function(e){this.orientation="horizontal",this.jQueryElement.parent().length&&i.apply(this),e()},keys:function(t,...n){if(n instanceof Array&&n.length==this.buttons.length){if(n.filter(e=>"string"==typeof e&&1==e.length).length!=n.length)return t(e.debug.error("Every key should be a string of length 1 in Scale "+this.id,n));this.keys=n.map(e=>e.toUpperCase())}else this.buttons.filter(e=>"string"==typeof e&&1==e.length).length==this.buttons.length?this.keys=this.buttons.map(e=>e.toUpperCase()):this.keys=Array.from({length:this.buttons.length},(e,t)=>t+1);t()},label:function(e,t,n){if(isNaN(Number(t))||t<0||t>=this.buttons.length)return e();if(this.buttons[t]=n,this.jQueryElement.parent().length){let e=this.jQueryElement.find("label");if(t<e.length){let i=$(e[t]);i.empty(),n._runPromises?n.print(i.empty())._runPromises():i.html(n)}}e()},labels:function(e,t){this.labels=t,e()},labelsPosition:function(e,t){this.labels=t,i.apply(this),e()},log:function(e,...t){t.length?this.log=t:this.log=["last"],e()},once:function(e){if(this.hasClicked)t.apply(this);else{let e=this.choice;this.choice=(n=>{e.apply(this,[n]),t.apply(this)})}e()},radio:function(e){this.scaleType="radio",i.apply(this),e()},size:function(t,n,r){this.width=n,i.apply(this),e.elements.standardCommands.settings.size.apply(this,[t,n,r])},slider:function(e){this.scaleType="slider",i.apply(this),e()},vertical:function(e){this.orientation="vertical",this.jQueryElement.parent().length&&i.apply(this),e()}},this.test={selected:function(e){return!(!this.choices.length||this.unselected)&&(null==e||e==this.choices[this.choices.length-1][1])}}})},function(e,t){window.PennController._AddElementType("Selector",function(e){function t(t,...n){let i=[];if(n.length)for(let t in n){if(!(n[t]._element&&n[t]._element.jQueryElement instanceof jQuery)){e.debug.error("Invalid element #"+t+" in shuffling selector "+this.id);continue}let r=this.elements.map(e=>e[0]).indexOf(n[t]._element);r<0?e.debug.error("Cannot shuffle element "+n[t]._element.id+" for it has not been added to selector "+this.id):i.push(this.elements[r])}else i=[].concat(this.elements);let r=[].concat(i);fisherYates(r);let s=r.map((e,t)=>Object({old:{element:i[t],index:this.elements.indexOf(i[t])},new:{element:e,index:this.elements.indexOf(e)}})),o=[];s.map((e,t)=>{this.elements[e.old.index]=e.new.element;let n=$("<shuffle>").attr("i",t);e.old.element[0].jQueryContainer.before(n),n.css({position:e.old.element[0].jQueryContainer.css("position"),left:e.old.element[0].jQueryContainer.css("left"),top:e.old.element[0].jQueryContainer.css("top")}),o.push(n)}),o.map(e=>{let t=e.attr("i"),n=s[t].new.element[0].jQueryContainer;e.after(n),n.css({position:e.css("position"),left:e.css("left"),top:e.css("top")}),this.selections.length&&this.selections[this.selections.length-1][1]==s[t].new.element[0].id&&n.before(this.frame),e.remove()}),t()}this.immediate=function(e){void 0!==e&&"string"==typeof e&&0!=e.length||(e="Selector"),this.id=e},this.uponCreation=function(t){this.elements=[],this.selections=[],this.disabled=!1,this.frame=$("<div>").css({position:"absolute",display:"inline-block",margin:"auto",outline:"dotted 1px grey","z-index":100}).addClass("PennController-"+this.type.replace(/[\s_]/g,"")+"-selectionFrame"),this.noClick=!1,this.select=(t=>{if(!this.disabled){if(this.elements.map(e=>e[0]).indexOf(t)<0)return e.debug.error("Tried to select an element not part of Selector "+this.id);this.selections.push(["Selection",t.id,Date.now(),"NULL"]),this.frame.css({width:t.jQueryElement.outerWidth(),height:t.jQueryElement.outerHeight(),"pointer-events":"none"}),"absolute"==t.jQueryElement.css("position")&&this.frame.css({left:t.jQueryElement.css("left"),top:t.jQueryElement.css("top")}),t.jQueryElement.before(this.frame),this.elements.map(e=>e[0].jQueryElement.removeClass("PennController-"+this.type.replace(/[\s_]/g,"")+"-selected")),t.jQueryElement.addClass("PennController-"+this.type.replace(/[\s_]/g,"")+"-selected")}}),e.events.keypress(e=>{if(!this.disabled)for(let t in this.elements){let n="";if(this.elements[t].length>1&&(n=this.elements[t][1]),n&&"string"==typeof n&&n.toUpperCase().indexOf(String.fromCharCode(e.which).toUpperCase())>-1)return this.select(this.elements[t][0])}}),t()},this.end=function(){if(this.select=(()=>void 0),this.elements=[],this.frame&&this.frame instanceof jQuery&&this.frame.remove(),this.log&&this.log instanceof Array)if(this.selections.length)if(1==this.selections.length)e.controllers.running.save(this.type,this.id,...this.selections[0]);else if(this.log.indexOf("all")>-1)for(let t in this.selections)e.controllers.running.save(this.type,this.id,...this.selections[t]);else this.log.indexOf("first")>-1&&e.controllers.running.save(this.type,this.id,...this.selections[0]),this.log.indexOf("last")>-1&&e.controllers.running.save(this.type,this.id,...this.selections[this.selections.length-1]);else e.controllers.running.save(this.type,this.id,"Selection","NA","Never","No selection happened")},this.value=function(){if(this.selections.length){let e=this.selections[this.selections.length-1][1],t=this.elements.filter(t=>t[0].id==e);return t.length?(t=t[0][0],window.PennController.Elements["get"+t.type](t.id)):null}return null},this.actions={select:function(t,n){if(!isNaN(Number(n))&&Number(n)>=0&&Number(n)<this.elements.length&&(n={_element:this.elements[Number(n)][0]}),n._element&&n._element.jQueryElement instanceof jQuery){let e=this.disabled;this.disabled=!1,this.select(n._element),this.disabled=e}else e.debug.error("Invalid element passed to select command for selector "+this.id);t()},shuffle:function(e,...n){t.apply(this,[e].concat(n))},unselect:function(e){this.selections.push(["Unselect","Unselect",Date.now(),"From script"]),this.frame.detach(),this.elements.map(e=>e[0].jQueryElement.removeClass("PennController-"+this.type+"-selected")),e()},wait:function(e,t){if("first"==t&&this.selections.length)e();else{let n=!1,i=this.select;this.select=(r=>{let s=i.apply(this,[r]);if(!(n||this.disabled&&!s))if(t instanceof Object&&t._runPromises&&t.success){let i=this.disabled;this.disabled="tmp",t._runPromises().then(t=>{"success"==t&&(n=!0,e()),"tmp"==this.disabled&&(this.disabled=i)})}else n=!0,e()})}}},this.settings={add:function(t,...n){for(w in n){let t=n[w]._element;if(null==t||null==t.id)e.debug.error("Invalid element added to selector "+this.id);else if(this.elements.map(e=>e[0]).indexOf(t)>-1)e.debug.error("Element "+t.id+" already part of selector "+this.id);else if(null!=t.jQueryElement&&t.jQueryElement instanceof jQuery){this.elements.push([t]);let e=()=>{this.noClick||t.jQueryElement.css("cursor","pointer");let e=t.jQueryElement[0].onclick;t.jQueryElement[0].onclick=((...n)=>{e instanceof Function&&e.apply(t.jQueryElement[0],n),this.noClick||this.select(t)})};t.jQueryElement.parent().length?e():t._printCallback.push(e)}else e.debug.error("Element "+t.id+" has no visble element to be chosen in selector "+this.id)}t()},callback:function(e,...t){let n=this.select;this.select=async function(e){let i=this.disabled;if(n.apply(this,[e]),!i)for(let e in t)await t[e]._runPromises()},e()},disable:function(e){this.disabled=!0,this.elements.map(e=>e[0].jQueryElement.css("cursor","")),this.jQueryContainer.addClass("PennController-disabled"),this.jQueryElement.addClass("PennController-disabled"),e()},disableClicks:function(e){this.noClick=!0,this.elements.map(e=>e[0].jQueryElement.css("cursor","")),e()},enable:function(e){this.disabled=!1,this.noClick||this.elements.map(e=>e[0].jQueryElement.css("cursor","pointer")),this.jQueryContainer.removeClass("PennController-disabled"),this.jQueryElement.removeClass("PennController-disabled"),e()},enableClicks:function(e){this.noClick=!1,this.elements.map(e=>e[0].jQueryElement.css("cursor","pointer")),e()},frame:function(e,t){this.frame.css.apply(this.frame,["outline",t]),e()},keys:function(e,...t){for(let e in t){if(e>=this.elements.length)break;let n=t[e];"string"!=typeof n&&Number(n)>0&&(n=String.fromCharCode(n)),this.elements[e]=[this.elements[e][0],n]}e()},log:function(e,...t){t.length?this.log=t:this.log=["last"],e()},once:function(e){if(this.selections.length)this.disabled=!0,this.elements.map(e=>e[0].jQueryElement.css("cursor",""));else{let e=this.select;this.select=(t=>{if(e.apply(this,[t]),!this.disabled)return this.disabled=!0,this.elements.map(e=>e[0].jQueryElement.css("cursor","")),"once"})}e()},shuffle:function(e,...n){t.apply(this,[e].concat(n))}},this.test={selected:function(t){return null==t?this.selections.length>0:0!==this.selections.length&&(t._element?this.selections[this.selections.length-1][1]==t._element.id:(e.debug.error("Invalid element tested for Selector "+this.id,t._element.id),!1))},index:function(t,n){return null==t||null==t._element?e.debug.error("Invalid element tested for selector "+this.id,t._element.id):Number(n)>=0?this.elements.map(e=>e[0]).indexOf(t._element)==Number(n):this.elements.map(e=>e[0]).indexOf(t._element)>=0}}}),window.PennController._AddStandardCommands(function(e){this.settings={selector:async function(t,n){var i;if("string"==typeof n){let t=e.controllers.running.options.elements;if(!t.hasOwnProperty("Selector")||!t.Selector.hasOwnProperty(n))return e.debug.error("No selector found named "+n);i=t.Selector[n]}else n._element&&n._runPromises&&("Selector"==n._element.type?(await n._runPromises(),i=n._element):e.debug.error("Tried to add "+this.name+" to an invalid Selector"));if(i.elements.map(e=>e[0]).indexOf(this)>-1)e.debug.error("Element "+this.id+" already part of Selector "+i.id);else if(null!=this.jQueryElement&&this.jQueryElement instanceof jQuery){i.elements.push([this]),this.noClick||this.jQueryElement.css("cursor","pointer");let e=this.jQueryElement[0].onclick;this.jQueryElement[0].onclick=((...t)=>{e instanceof Function&&e.apply(this.jQueryElement[0],t),i.noClick||i.select(this)})}else e.debug.error("Element "+this.id+" has no visble element to be chosen in Selector "+i.id);t()}}})},function(e,t){window.PennController._AddElementType("Text",function(e){this.immediate=function(e,t){void 0===t&&(t=e),this.id=e,t=t.replace(/(^\s|\s$)/,"&nbsp;"),this.initialText=t,this.text=t},this.uponCreation=function(e){this.jQueryElement=$("<span>"+this.initialText+"</span>").css("display","inline-block"),e()},this.value=function(){return this.text},this.end=function(){this.log&&(this.printTime?e.controllers.running.save(this.type,this.id,"Print","NA",this.printTime,"NULL"):e.controllers.running.save(this.type,this.id,"Print","NA","Never","NULL"))},this.actions={unfold:function(t,n){let i=()=>{let e=Number(n);if(e>0){let t=Date.now();this.jQueryElement.css("visibility","visible");let n=this.jQueryElement.width(),i=$("<div>").css({display:"inline-block","overflow-x":"hidden",width:0,margin:0,padding:0,"white-space":"nowrap"});i=this.jQueryElement.wrap(i).parent();let r=0,s=()=>{let o=(Date.now()-t)/e;o>=1&&(o=1);let a=Math.round(n*o);a>r&&i.width(a),r=a,o<1&&window.requestAnimationFrame(s)};window.requestAnimationFrame(s)}};this.jQueryContainer instanceof jQuery&&this.jQueryContainer.parent().length?i():e.elements.standardCommands.actions.print.call(this,i),t()}},this.settings={text:function(e,t){this.text=t,this.jQueryElement.html(t),e()}},this.test={text:function(e){return e instanceof RegExp?this.text.match(e):e==this.text}}})},function(e,t){window.PennController._AddElementType("TextInput",function(e){this.immediate=function(e,t){void 0!==e&&"string"==typeof e&&0!=e.length||(e="TextInput"),this.initialText=t,this.id=e},this.uponCreation=function(e){this.text=this.initialText,this.jQueryElement=$("<textarea>"),this.jQueryElement.attr({name:this.id,rows:1,cols:40}).val(this.text),this.rows=1,this.disabled=!1,this.log=[],this.types=[],this.validations=[],this.entered=!1,this.pressEnter=(()=>{this.entered=!0,this.validations.push(["EnterReturn",this.jQueryElement.val(),Date.now(),"NULL"])}),this.jQueryElement[0].addEventListener("keydown",e=>{let t=this.jQueryElement.val();if(this.types.push(["Type",t,Date.now(),e.key]),"Enter"==e.key)if(this.pressEnter(),1==this.rows)e.preventDefault();else if(this.rows>1){let n=t.match(/[\r\n]/g);n instanceof Array&&n.length+1>=this.rows&&e.preventDefault()}}),this.jQueryElement[0].addEventListener("keypress",e=>{if("Enter"==e.key&&this.rows>0){let t=this.jQueryElement.val().match(/[\r\n]/g);t instanceof Array&&t.length+1>=this.rows&&e.preventDefault()}e.key.isSpecialKey()||this.length!=this.jQueryElement.val().length||e.preventDefault()}),this.jQueryElement[0].addEventListener("keyup",e=>{let t=this.jQueryElement.val();this.length&&t.length>this.length&&this.jQueryElement.val(t.substr(0,this.length));let n=t.match(/[\r\n]/g);if(this.rows>0&&n instanceof Array&&n.length>=this.rows+1){let e="([\\n\\r]?[^\\n\\r]*){"+this.rows+"}";this.jQueryElement.val(t.match(RegExp(e))[0])}}),this.jQueryElement[0].addEventListener("paste",e=>{let t=this.jQueryElement.val(),n=(e.clipboardData||window.clipboardData).getData("Text"),i=this.jQueryElement[0].selectionStart,r=t.substring(0,i)+n+t.substring(this.jQueryElement[0].selectionEnd,t.length),s=r.match(/[\r\n]/g);if(this.rows>0&&s instanceof Array&&s.length>=this.rows){let t="([\\n\\r]?[^\\n\\r]*){"+this.rows+"}";r=r.match(RegExp(t))[0],this.jQueryElement.val(r),e.preventDefault()}this.length>0&&r.length>=this.length&&(this.jQueryElement.val(r.substring(0,this.length)),e.preventDefault())}),e()},this.end=function(){if(this.log&&this.log instanceof Array)if(this.log.indexOf("all")>-1){let t=Date.now();if(e.controllers.running.save(this.type,this.id,"Final",csv_url_encode(this.jQueryElement.val()),t,"All saved, see documentation"),this.types.length){e.controllers.running.save(this.type,this.id,"NTypingEvents",this.types.length,t,"All saved, see documentation");let n=[],i=[],r=[];this.types.map(e=>{n.push(csv_url_encode(e[1])),i.push(e[2]),r.push(e[3])}),e.controllers.running.save(this.type,this.id,"TypingEvent","Keys","NULL",...r),e.controllers.running.save(this.type,this.id,"TypingEvent","Texts","NULL",...n),e.controllers.running.save(this.type,this.id,"TypingEvent","Times","NULL",...i)}for(let t in this.validations)this.validations[t][1]=csv_url_encode(this.validations[t][1]),e.controllers.running.save(this.type,this.id,...this.validations[t])}else{if(this.log.indexOf("validate")>-1)for(let t in this.validations)this.validations[t][1]=csv_url_encode(this.validations[t][1]),e.controllers.running.save(this.type,this.id,...this.validations[t]);if(this.log.indexOf("final")>-1&&e.controllers.running.save(this.type,this.id,"Final",csv_url_encode(this.jQueryElement.val()),Date.now(),"NULL"),this.log.indexOf("first")>-1&&this.types.length){let t=[].concat(this.types[0]);t[0]="First",t[1]=csv_url_encode(t[1]),e.controllers.running.save(this.type,this.id,...t)}if(this.log.indexOf("last")>-1&&this.types.length){let t=[].concat(this.types[this.types.length-1]);t[0]="Last",t[1]=csv_url_encode(t[1]),e.controllers.running.save(this.type,this.id,...t)}}},this.value=function(){return this.jQueryElement.val()},this.actions={print:function(t,...n){e.elements.standardCommands.actions.print.apply(this,[()=>{this.jQueryElement.focus(),t()},...n])},wait:function(e,t){if("first"==t&&this.entered)e();else{let n=!1,i=this.pressEnter;this.pressEnter=(()=>{if(i.apply(this),!n)if(t instanceof Object&&t._runPromises&&t.success){let i=this.disabled;this.disabled="tmp",t._runPromises().then(t=>{"success"==t&&(n=!0,e()),"tmp"==this.disabled&&(this.disabled=i)})}else n=!0,e()})}}},this.settings={length:function(e,t){this.length=Number(t),isNaN(this.length)&&(this.length=0),e()},lines:function(e,t){this.rows=Number(t),isNaN(this.rows)&&(this.rows=0),this.jQueryElement.attr("rows",this.rows),e()},log:function(t,...n){n.length||(n=["final","validate","first"]),this.log=n,n.indexOf("all")>-1&&e.debug.log("<div style='color:red;'>Now logging all typing events in inputText element "+this.id+": this can drastically increase the weight of the results file</div>"),t()},once:function(e){if(this.entered)this.jQueryElement.attr("disabled",!0);else{let e=this.pressEnter;this.pressEnter=function(){e.apply(this),this.jQueryElement.attr("disabled",!0)}}e()},text:function(e,t){this.text=t,this.jQueryElement.val(t),e()}},this.test={text:function(e){return e instanceof RegExp?this.jQueryElement.val().match(e):this.jQueryElement.val()==e}}})},function(e,t){window.PennController._AddElementType("Timer",function(e){this.immediate=function(t,n){void 0===n&&Number(t)>0&&(n=t,void 0!==t&&"string"==typeof t&&0!=t.length||(t="Timer")),this.id=t,this.duration=0,Number(n)>0?this.duration=Number(n):e.debug.error("Invalid duration for Timer &quot;"+t+"&quot;")},this.uponCreation=function(e){this.elapsed=!1,this.events=[],this.log=!1,this.running=!1,this.start=(()=>{this.startTime=Date.now(),this.running=!0,this.events.push(["Start","Start",this.startTime,"NULL"]);let e=()=>{this.running&&(Date.now()-this.startTime>=this.duration?this.done():setTimeout(e,0))};e()}),this.done=(()=>{this.running=!1,this.events.push(["End","End",Date.now(),"NULL"]),this.elapsed=!0,this.startTime=null}),e()},this.end=function(){if(this.running&&(this.running=!1,this.events.push(["End","NA","Never","Had to halt the timer at the end of the trial"])),this.log)for(let t in this.events)e.controllers.running.save(this.type,this.id,...this.events[t])},this.value=function(){return this.elapsed},this.actions={start:function(e){this.start(),e()},stop:function(e){this.running&&this.done(),e()},wait:function(e,t){if("first"==t&&this.elapsed)e();else{let n=!1,i=this.done;this.done=(()=>{i.apply(this),n||(t instanceof Object&&t._runPromises&&t.success?t._runPromises().then(t=>{"success"==t&&(n=!0,e())}):(n=!0,e()))})}}},this.settings={callback:function(e,...t){let n=this.done;this.done=async function(){n.apply(this);for(let e in t)await t[e]._runPromises()},e()},log:function(e){this.log=!0,e()}},this.test={ended:function(){return this.elapsed},running:function(){return this.running}}})},function(e,t){window.PennController._AddElementType("Tooltip",function(e){function t(){this.jQueryElement.remove(),this.jQueryContainer instanceof jQuery&&this.jQueryContainer.detach(),this.frame&&this.frame instanceof jQuery&&this.frame.detach()}this.immediate=function(e,t,n){void 0===t&&(t=e),this.initialText=t,this.initialLabel=n,void 0!==e&&"string"==typeof e&&0!=e.length||(e="Tooltip"),this.id=e},this.uponCreation=function(e){this.text=this.initialText,"string"==typeof this.initialLabel&&this.initialLabel.length?this.label=this.initialLabel:this.label="OK",this.resetLabel=!1,this.jQueryElement=$("<div>").html(this.text),this.jQueryLabel=$("<a>").html(this.label),this.validations=[],this.frame=$("<div>").addClass("PennController-"+this.type.replace(/[\s_]/g,"")+"-tooltip-frame"),this.jQueryElement.addClass("PennController-"+this.type.replace(/[\s_]/g,"")+"-tooltip"),this.jQueryElement.addClass("PennController-"+this.id.replace(/[\s_]/g,"")),this.jQueryElement.css({background:"floralwhite",position:"relative"}),this.jQueryLabel.css({border:"dotted 1px gray",cursor:"pointer",position:"absolute",bottom:"2px",right:"2px"}),this.wasValidated=!1,this.disabled=!1,this.log=!1,this.validate=(()=>{this.delayedPrinting||this.disabled||(this.wasValidated=!0,this.validations.push(["Validate","Validate",Date.now(),"NULL"]),t.apply(this))}),e()},this.end=function(){if(this.jQueryElement&&this.jQueryElement instanceof jQuery&&t.apply(this),this.log)for(let t in this.validations)e.controllers.running.save(this.type,this.id,...this.validations[t])},this.value=function(){return this.wasValidated},this.actions={print:function(t,n,...i){if(n&&n.hasOwnProperty("_element")&&n._element.jQueryElement instanceof jQuery&&(n=n._element.jQueryElement),this.jQueryElement.append(this.jQueryLabel),this.jQueryLabel.click(()=>{this.noClicks||this.validate()}),this.jQueryElement.css("text-align","left"),n instanceof jQuery){n.before(this.jQueryElement);let e=n.width(),i=n.height();this.jQueryElement.css({position:"absolute",display:"inline-block",visibility:"hidden",overflow:"auto",top:"auto",left:"auto","margin-top":1+i,"margin-left":1+e,"z-index":9999,padding:"1px"}),this.frameParent&&n.before(this.frame.css({position:"absolute",display:"inline-block",width:e,height:i,border:this.frameParent,"z-index":100,"pointer-events":"none"}));let r=n.css("top"),s=n.css("left");if("0px"==r&&(r="auto"),"0px"==s&&(s="auto"),this.jQueryElement.css({left:s,top:r}),this.frame.css({left:s,top:r}),this.jQueryElement.addClass("PennController-"+this.type.replace(/[\s_]/g,"")),"none"!=this.jQueryLabel.css("display")&&this.jQueryElement.css("padding-bottom","20px"),this.relativePosition){let e=()=>this.relativePosition.match(/top/i)?-1*this.jQueryElement.outerHeight()-1:this.relativePosition.match(/middle/i)?.5*(n.height()-this.jQueryElement.outerHeight()):n.height()+1,i=()=>this.relativePosition.match(/left/i)?-1*this.jQueryElement.outerWidth()-1:this.relativePosition.match(/center/i)?.5*(n.width()-this.jQueryElement.outerWidth()):n.width()+1;this.delayedPrinting=!0,setTimeout(()=>{this.jQueryElement.css({"margin-top":e(),"margin-left":i()}),setTimeout(()=>{this.jQueryElement.css({"margin-top":e(),"margin-left":i(),visibility:"visible"}),this.delayedPrinting=!1,t()})})}else this.jQueryElement.css("visibility","visible"),t()}else this.jQueryElement.css({position:"relative",left:"",top:"",margin:0,display:"inline-block"}),"none"!=this.jQueryLabel.css("display")&&this.jQueryElement.css("padding-bottom","20px"),e.elements.standardCommands.actions.print.apply(this,[t,n,...i])},remove:function(e){t.apply(this),e()},wait:function(e,t){if("first"==t&&this.wasValidated)e();else{let n=!1,i=this.validate;this.validate=(()=>{if(i.apply(this),!n)if(t instanceof Object&&t._runPromises&&t.success){let i=this.disabled;this.disabled="tmp",t._runPromises().then(t=>{"success"==t&&(n=!0,e()),"tmp"==this.disabled&&(this.disabled=i)})}else n=!0,e()})}}},this.settings={disable:function(e){this.disabled=!0,this.jQueryContainer.addClass("PennController-disabled"),this.jQueryElement.addClass("PennController-disabled"),e()},enable:function(e){this.disabled=!1,this.jQueryContainer.removeClass("PennController-disabled"),this.jQueryElement.removeClass("PennController-disabled"),e()},frame:function(e,t){"string"==typeof t&&t.length?this.frameParent=t:this.frameParent="dotted 1px gray",e()},key:function(t,n,i){" "==n||isNaN(Number(n))||(n=String.fromCharCode(n)),"string"!=typeof n&&t(e.debug.error("Invalid key(s) passed to Tooltip &quot;"+id+"&quot; (should be a string or a key code number)",n)),n=n.toUpperCase(),e.events.keypress(e=>{if(!this.jQueryElement.parent().length)return;let t=e.key.isSpecialKey(),i=e.key.toUpperCase();(void 0===n||0==n.length||t&&(n==i||n=={0:"",1:"LEFT",2:"RIGHT"}[e.location]+i)||!t&&n.indexOf(i)>-1)&&this.validate()}),i&&(this.noClicks=!0,this.jQueryLabel.css("cursor",""),this.initialLabel||this.resetLabel||this.jQueryLabel.css("display","none")),t()},label:function(e,t){this.label=t,this.resetLabel=!0,"string"!=typeof t||t.match(/^[\s\t]*$/)?this.jQueryLabel.css("display","none"):(this.jQueryLabel.html(t),this.jQueryLabel.css("display","inherit")),e()},log:function(e){this.log=!0,e()},position:function(e,t){this.relativePosition=t,e()},text:function(e,t){this.text=t,this.jQueryElement.html(t),this.jQueryElement.append(this.jQueryLabel),this.jQueryLabel.click(()=>{this.noClicks||this.validate()}),"none"!=this.jQueryLabel.css("display")&&this.jQueryElement.css("padding-bottom","20px"),e()}}})},function(e,t){!function(){var e=null;let t=window.PennController.ResetPrefix;window.PennController.ResetPrefix=function(n){t(n),e="string"==typeof n?window[n]:window};let n={};window.PennController._AddElementType("Var",function(t){this.immediate=function(i,r){(t=>{let n=window.PennController.Elements.getVar;window.PennController.Elements.getVar=function(e){let i=t.controllers.underConstruction;if(t.controllers.running&&(i=t.controllers.list[t.controllers.running.id]),i.elements.hasOwnProperty("Var")&&i.elements.Var.hasOwnProperty(e))return n(e);{let t=window.PennController.Elements.newVar(e).settings.global();return t._element.scope="global",t}},e&&(e.getVar=window.PennController.Elements.getVar)})(t);let s=t.controllers.underConstruction;if(t.controllers.running&&(s=t.controllers.list[t.controllers.running.id]),s.elements.hasOwnProperty("Var")&&s.elements.Var.hasOwnProperty(i)){"global"==s.elements.Var[i].scope&&delete s.elements.Var[i]}this.scope="local",this.initialValue=r,this._value=r,this.getter=(()=>"local"==this.scope?this._value:n[this.id]),this.setter=(e=>{"local"==this.scope?this._value=e:n[this.id]=e}),Object.defineProperty(this,"value",{get:this.getter,set:this.setter}),this.evaluate=(()=>this.value&&"Var"===this.value.type?this.value.evaluate():this.value)},this.uponCreation=function(e){this.scope="local",this.value=this.initialValue,this.values=[],e()},this.end=function(){if(this.log&&this.log instanceof Array&&(this.log.indexOf("final")>-1&&t.controllers.running.save(this.type,this.id,"Final",this.value,Date.now(),"Value at the end of the trial"),this.log.indexOf("set")>-1)){for(let e in this.values)t.controllers.running.save(this.type,this.id,...this.values[e]);this.values.length||t.controllers.running.save(this.type,this.id,"Set","NA","Never","The Var element was never set during the trial")}},this.value=function(){return this.evaluate()},this.actions={set:function(e,t){"object"==typeof t&&t.hasOwnProperty("value")?this.value=t.value:t instanceof Function?this.value=t.call(this,this.value):this.value=t,void 0===this.values&&(this.values=[]),this.values.push(["Set",this.value,Date.now(),"NULL"]),e()}},this.settings={local:function(e){this.scope="local",e()},log:function(e,...t){t.length?this.log=t:this.log=["final"],e()},global:function(e){n.hasOwnProperty(this.id)||(n[this.id]=this.value),this.scope="global",e()}},this.test={is:function(e){let t=this.evaluate();return e&&e.value&&(e=e.value),e&&e._element&&(e=e._element),t&&t._element&&(t=t._element),e instanceof RegExp&&"text"==typeof t?t.match(e):e instanceof Function?e(t):t==e}}}),window.PennController._AddStandardCommands(function(e){this.actions={setVar:function(t,i){if("string"==typeof i){if(!e.controllers.running.options.elements.hasOwnProperty("Var"))return e.debug.error("No Var element named "+i+" found");let t=e.controllers.running.options.elements.Var[i];if(t)t.value=window.PennController.Elements["get"+this.type](this).value;else{if(!n[i])return e.debug.error("No Var element named "+i+" found");n[i].value=window.PennController.Elements["get"+this.type](this).value}}else e.debug.error("Invalid variable reference when trying to store "+this.id+"'s value",i);t()}}})}()},function(e,t){window.PennController._AddElementType("Video",function(e){this.immediate=function(t,n){"string"==typeof t&&void 0===n&&(n=t);let i=!n.match(/^http/i);this.resource=e.resources.fetch(n,function(e){this.object=document.createElement("video"),this.object.src=this.value,this.object.preload=!0,this.object.load(),this.object.readyState>3?e():this.object.addEventListener("canplaythrough",e)},i),void 0!==t&&"string"==typeof t&&0!=t.length||(t="Video"),this.id=t},this.uponCreation=function(e){this.resource.object.controls=!0,this.video=this.resource.object,this.hasPlayed=!1,this.disabled=!1,this.resource.object.style=null,this.resource.object.currentTime=0,this.jQueryElement=$(this.video),this.jQueryDisable=null,this.playEvents=[],this.endEvents=[],this.pauseEvents=[],this.seekEvents=[],this.bufferEvents=[],this.whatToSave=[],this.resource.object.onplay=(()=>{this.playEvents.push(["play",this.video.currentTime,Date.now()])}),this.resource.object.onended=(()=>{this.hasPlayed=!0,this.endEvents.push(["end",this.video.currentTime,Date.now()])}),this.resource.object.onpause=(()=>{this.pauseEvents.push(["pause",this.video.currentTime,Date.now()])}),this.resource.object.onseeked=(()=>{this.seekEvents.push(["seek",this.video.currentTime,Date.now()])}),this.resource.object.waiting=(()=>{this.bufferEvents.push(["buffer",this.video.currentTime,Date.now()])}),this.printDisable=(e=>{e=Number(e)||.5,this.jQueryDisable instanceof jQuery&&this.jQueryDisable.remove(),this.jQueryDisable=$("<div>").css({position:"absolute",display:"inline-block","background-color":"gray",opacity:e,width:this.jQueryElement.width(),height:this.jQueryElement.height()}),this.jQueryElement.before(this.jQueryDisable),this.jQueryElement.removeAttr("controls")}),e()},this.end=function(){if(this.whatToSave&&this.whatToSave.indexOf("play")>-1){this.playEvents.length||e.controllers.running.save(this.type,this.id,"play","NA","Never");for(let t in this.playEvents)e.controllers.running.save(this.type,this.id,...this.playEvents[t])}if(this.whatToSave&&this.whatToSave.indexOf("end")>-1){this.endEvents.length||e.controllers.running.save(this.type,this.id,"end","NA","Never");for(let t in this.endEvents)e.controllers.running.save(this.type,this.id,...this.endEvents[t])}if(this.whatToSave&&this.whatToSave.indexOf("pause")>-1){this.pauseEvents.length||e.controllers.running.save(this.type,this.id,"pause","NA","Never");for(let t in this.pauseEvents)e.controllers.running.save(this.type,this.id,...this.pauseEvents[t])}if(this.whatToSave&&this.whatToSave.indexOf("seek")>-1){this.seekEvents.length||e.controllers.running.save(this.type,this.id,"seek","NA","Never");for(let t in this.seekEvents)e.controllers.running.save(this.type,this.id,...this.seekEvents[t])}if(this.bufferEvents)for(let t in this.bufferEvents)e.controllers.running.save(this.type,this.id,...this.bufferEvents[t]);this.jQueryDisable&&this.jQueryDisable.remove()},this.value=function(){return this.endEvents.length?this.endEvents[this.endEvents.length-1][2]:0},this.actions={play:function(t){this.hasOwnProperty("video")&&this.video.nodeName&&"VIDEO"==this.video.nodeName?this.video.play():e.debug.error("No video to play for Video ",this.id),t()},pause:function(e){this.video.pause(),e()},print:function(t,...n){e.elements.standardCommands.actions.print.apply(this,[()=>{this.disabled&&this.printDisable(this.disabled),t()},...n])},stop:function(e){this.video.pause(),this.video.currentTime=0,e()},wait:function(e,t){if("first"==t&&this.hasPlayed)e();else{let n=!1,i=this.video.onended;this.video.onended=function(...r){if(i.apply(this,r),!n)if(t instanceof Object&&t._runPromises&&t.success){let i=this.disabled;this.disabled="tmp",t._runPromises().then(t=>{"success"==t&&(n=!0,e()),"tmp"==this.disabled&&(this.disabled=i)})}else n=!0,e()}}}},this.settings={disable:function(e,t){this.printDisable(t),this.disabled=t||!0,this.jQueryContainer.addClass("PennController-disabled"),this.jQueryElement.addClass("PennController-disabled"),e()},enable:function(e){this.jQueryDisable instanceof jQuery&&(this.disabled=!1,this.jQueryDisable.remove(),this.jQueryDisable=null,this.jQueryContainer.addClass("PennController-disabled"),this.jQueryElement.addClass("PennController-disabled"),this.jQueryElement.attr("controls",!0)),e()},once:function(e){if(this.hasPlayed)this.disabled=!0,this.printDisable();else{let e=this.video.onended,t=this;this.video.onended=function(...n){e.apply(this,n),t.disabled=!0,t.printDisable()}}e()},log:function(e,...t){1==t.length&&"string"==typeof t[0]?this.whatToSave.push(t):t.length>1?this.whatToSave=this.whatToSave.concat(t):this.whatToSave=["play","end","pause","seek"],e()}},this.test={hasPlayed:function(){return this.hasPlayed},playing:function(){return this.video.currentTime&&!this.video.paused}}})},function(e,t){window.PennController._AddElementType("MediaRecorder",function(e){let t,n,i="This experiment collects recording samples from its participants. Your browser should now be prompting a permission request to use your recording device (if applicable). By giving your authorization to record, and by participating in this experiment, you are giving permission to the designer(s) of this experiment to anonymously collect the samples recorded during this experiment. The recordings will be uploaded to, and hosted on, a server designated by the experimenter(s). If you accept the request, a label will remain visible at the top of this window throughout the whole experiment, indicating whether you are currently being recorded.",r="By clicking this link I understand that I grant this experiment's script access to my recording device for the purpose of uploading recordings to the server designated by the experimenter(s).",s=e=>i=e,o={audio:null,video:null,onlyvideo:null},a=[],l="",u=!1,h=[],c=[],d=[],f=[],p=!1,m=!1;const g={audio:{"audio/webm":"webm","audio/ogg":"ogg"},video:{"video/webm":"webm","video/mp4":"mp4"}};function y(e){const t=g[e];for(let e in t)if(MediaRecorder.isTypeSupported(e))return{mimeType:e,extension:t[e]}}window.PennController.InitiateRecorder=function(a,f,g){if(void 0===window.MediaRecorder)return e.debug.error("This browser does not support audio recording"),alert("Your browser does not support audio recording");"string"==typeof a&&a.match(/^http.+/i)||e.debug.error("MediaRecorder's save URL is incorrect",a),l=a,u=!0;let b=e.controllers.new();b.id="InitiateRecorder",b.runHeader=!1,b.runFooter=!1,e.controllers.list.pop(),e.tmpItems.push(b),"string"==typeof f&&f.length&&s(f),"string"==typeof g&&g.length&&s(g),b.sequence=(()=>new Promise(s=>{let a=e.controllers.running;if(!navigator.mediaDevices)return a.element.append($("<p>Sorry, you cannot complete this experiment because your browser does not support recording.</p>"));a.element.append($("<p>"+i+"</p>"));let l={};p&&(l.audio=!0),m&&(l.video=!0);let u=[];navigator.mediaDevices.getUserMedia(l).then(function(e){if(p){let t=e;m&&(t=t.clone()).getVideoTracks().map(e=>t.removeTrack(e)),o.audio=new MediaRecorder(t,{mimeType:y("audio").mimeType})}if(m){let t=e.clone();t.getAudioTracks().map(e=>t.removeTrack(e)),o.onlyvideo=t,o.video=new MediaRecorder(e,{mimeType:y("video").mimeType})}[o.audio,o.video].map(e=>{null!==e&&(e.recording=!1,e.onstop=function(i){n.css({"font-weight":"normal",color:"black","background-color":"lightgray"}),n.html("Not recording");let r=y(t.mediaType).mimeType;t.mediaPlayer.srcObject=null,t.blob=new Blob(u,{type:r}),t.mediaPlayer.src=URL.createObjectURL(t.blob),u=[],t=null,c.shift().call(),e.recording=!1},e.onstart=function(i){n.css({"font-weight":"bold",color:"white","background-color":"red"}),n.html("Recording..."),"video"==t.mediaType&&(t.mediaPlayer.srcObject=o.onlyvideo,t.mediaPlayer.play()),e.recording=!0,h.shift().call()},e.ondataavailable=function(e){u.push(e.data)})}),a.element.append($("<a>"+r+"</a>").addClass("Message-continue-link").click(s)),(n=$("<div>Not recording</div>")).css({position:"fixed",top:0,left:"50%",transform:"translateX(-50%)",padding:"2px","background-color":"lightgray"}),$("#bod").append(n)}).catch(function(e){a.element.append($("<p>The following error occurred: "+e+"</p>"))})}));let v=b.log;return b.log=((...e)=>(d.push(e),v.apply(b,e),b)),b.warning=(e=>(s(e),b)),b.consent=(e=>((e=>r=e)(e),b)),b},window.PennController.UploadRecordings=function(t,n){let i=e.controllers.new();e.tmpItems.push(i),"string"==typeof t&&t.length&&(i.useLabel=t),i.id="UploadRecordings",i.runHeader=!1,i.runFooter=!1,i.countsForProgressBar=!1,i.sequence=(()=>new Promise(async function(t){let i=e.controllers.running;i.element.append($("<p>Please wait while the archive of your recordings is being uploaded to the server...</p>"));let r=new e.utils.JSZip,s=[];n||await new Promise(e=>{let t=()=>setTimeout(()=>0==f.length&&e()||t(),10);t()});for(let e in a)"uploaded"!=a[e].uploadStatus&&(r.file(a[e].name,a[e].data),a[e].uploadStatus="uploading",s.push(a[e]));let o={};f.push(o),r.generateAsync({compression:"DEFLATE",type:"blob"}).then(function(r){window.PennController.downloadRecordingsArchive=(()=>e.utils.saveAs(r,"RecordingsArchive.zip"));let a=e.utils.guidGenerator()+".zip";var u=new File([r],a),h=new FormData;h.append("fileName",a),h.append("file",u),h.append("mimeType","application/zip");var c=new XMLHttpRequest;c.open("POST",l,!0),c.onreadystatechange=(()=>{if(4==c.readyState){if(e.controllers.running.save("PennController","UploadRecordings","Filename",a,Date.now(),n?"async":"NULL"),200==c.status&&!c.responseText.match(/problem|error/i)){e.controllers.running.save("PennController","UploadRecordings","Status","Success",Date.now(),n?"async":"NULL"),e.debug.log("Recordings sent to the server");for(let e=0;e<s.length;e++)s[e].uploadStatus="uploaded";n||t()}else{for(let e=0;e<s.length;e++)s[e].uploadStatus="local";window.PennController.UploadRecordingsError=c.responseText||"error",e.debug.error("MediaRecorder's Ajax post failed. ("+c.status+")",c.responseText),e.controllers.running.save("PennController","UploadRecordings","Status","Failed",Date.now(),"Error Text: "+c.responseText+"; Status: "+c.status),i.element.append($("<p>There was an error uploading the recordings: "+c.responseText+"</p>")).append($("<p>Please click here to download a copy of your recordings in case you need to send them manually.</p>").bind("click",()=>{e.utils.saveAs(r,"RecordingsArchive.zip"),n||t()}).addClass("Message-continue-link"))}f=f.filter(e=>e!=o)}}),c.send(h)}),n&&t()}));for(let e=0;e<d.length;e++)uploadzipController.log(...d[e]);return i},e.Prerun(()=>{let t=window.conf_modifyRunningOrder;window.conf_modifyRunningOrder=function(n){if(t instanceof Function&&(n=t.apply(this,[n])),!u)return n;let i=!1,r=[-1,-1];for(let e=0;e<n.length;++e)for(let t=0;t<n[e].length;++t)"PennController"==n[e][t].controller&&"UploadRecordings"==n[e][t].options.id?(i=!0,r[0]>=0&&alert("WARNING: upload of recording archive set AFTER sending of results; check your Sequence definition.")):"__SendResults__"==n[e][t].controller&&r[0]<0&&!i&&(r=[e,t]);let s=window.PennController.UploadRecordings();e.tmpItems.pop();let o=new DynamicElement("PennController",s);return r[0]>=0?n[r[0]].splice(r[1],0,o):n.push([o]),n}}),this.immediate=function(e,t){void 0===e||"string"!=typeof e||0==e.length?e="MediaRecorder":void 0===t&&(t=e),"string"!=typeof t||!t.match(/audio/)||t.match(/video/i)&&!t.match(/no\W*video/i)?"string"==typeof t&&(t.match(/(only\W*video|video\W*only)/i)||t.match(/video/i)&&t.match(/no\W*audio/))?(this.mediaType="video",m=!0):(this.mediaType="video",p=!0,m=!0):(this.mediaType="audio",p=!0),this.id=e,Object.defineProperty(this,"recorder",{get:()=>o[this.mediaType]})},this.uponCreation=function(n){0==l.length&&e.debug.error("Recorder not initiated. Make sure the sequence of items contains an InitiateRecorder PennController."),this.log=!1,this.recordings=[],this.recording=!1,"audio"==this.mediaType?this.mediaPlayer=document.createElement("audio"):"video"==this.mediaType&&(this.mediaPlayer=document.createElement("video")),this.mediaPlayer.setAttribute("controls",!0),this.videoFeedback=$("<div>").css({position:"absolute"}),this.jQueryElement=$("<span>").addClass("PennController-"+this.type.replace(/[\s_]/g,"")+"-ui");let i=$("<button>Record</button>").addClass("PennController-"+this.type.replace(/[\s_]/g,"")+"-record");i.click(()=>{this.mediaPlayer.pause(),this.mediaPlayer.currentTime=0,this.recording?(this.stop(),this.recording=!1,i.text("Record"),clearInterval(null)):(i.text("Stop"),this.recording=!0,this.start())}),this.start=(()=>new Promise(e=>{this.recording=!0,h.push(()=>{this.recordings.push(["Recording","Start",Date.now(),"NULL"]),e()}),t=this,this.recorder.start()})),this.stop=(()=>new Promise(e=>{this.recording=!1,t=this,c.push(()=>{this.recordings.push(["Recording","Stop",Date.now(),"NULL"]),e()}),this.recorder.recording?this.recorder.stop():e()})),this.jQueryElement.append($(this.mediaPlayer)).append(i),n()},this.end=function(){if(this.blob){let t=y(this.mediaType).extension,n=this.id+"."+t,i=a.map(e=>e.name),r=0;for(;i.indexOf(n)>=0;)r++,n=this.id+"-"+r+"."+t;a.push({name:n,data:this.blob,uploadStatus:"local"}),e.controllers.running.save(this.type,this.id,"Filename",n,Date.now(),"NULL")}if(this.log)for(let t in this.recordings)e.controllers.running.save(this.type,this.id,...this.recordings[t])},this.value=function(){return this.blob},this.actions={play:function(e){this.mediaPlayer&&this.mediaPlayer.src?(this.mediaPlayer.currentTime&&0!=this.mediaPlayer.currentTime&&(this.mediaPlayer.currentTime=0),this.mediaPlayer.play().then(()=>e())):e()},record:async function(e){await this.start(),e()},stop:async function(e){await this.stop(),this.mediaPlayer&&this.mediaPlayer.src&&(this.mediaPlayer.pause(),this.mediaPlayer.currentTime&&0!=this.mediaPlayer.currentTime&&(this.mediaPlayer.currentTime=0)),e()},wait:function(e,t){if(t&&"string"==typeof t&&t.match(/first/i)&&this.recordings.length)e();else if(t&&"string"==typeof t&&t.match(/play/i)&&this.mediaPlayer){let t=this.mediaPlayer.onended;this.mediaPlayer.onended=function(...n){t instanceof Function&&t.apply(this,n),e()}}else{let n=!1,i=this.stop;this.stop=(()=>new Promise(r=>{i.apply(this).then(()=>{if(r(),!n)if(t instanceof Object&&t._runPromises&&t.success){let i=this.disabled;this.disabled="",t._runPromises().then(t=>{"success"==t&&(n=!0,e()),""==this.disabled&&(this.disabled=i)})}else n=!0,e()})}))}}},this.settings={disable:function(e){this.disabled=!0,this.jQueryElement.find("button.PennController-"+this.type+"-record").attr("disabled",!0).css("background-color","brown"),this.jQueryContainer.addClass("PennController-disabled"),this.jQueryElement.addClass("PennController-disabled"),e()},enable:function(e){this.disabled=!1,this.jQueryElement.find("button.PennController-"+this.type+"-record").removeAttr("disabled").css("background-color","red"),this.jQueryContainer.removeClass("PennController-disabled"),this.jQueryElement.removeClass("PennController-disabled"),e()},once:function(e){if(this.recordings.length)this.disabled=!0,this.jQueryElement.find("button.PennController-"+this.type+"-record").attr("disabled",!0).css("background-color","brown");else{let e=this.stop;this.stop=(()=>new Promise(t=>{e instanceof Function?e.apply(this).then(t):t(),this.disabled=!0,this.jQueryElement.find("button.PennController-"+this.type+"-record").attr("disabled",!0).css("background-color","brown")}))}e()},log:function(e){this.log=!0,e()}},this.test={hasPlayed:function(){return this.hasPlayed},playing:function(){return this.mediaPlayer.currentTime&&!this.mediaPlayer.paused},recorded:function(){return this.blob}}}),window.PennController.DownloadRecordingButton=function(e){return"<button type=\"button\" onclick=\"if (PennController.hasOwnProperty('downloadRecordingsArchive'))  PennController.downloadRecordingsArchive();  else  alert('ERROR: could not find an archive for recordings');\">"+e+"</button>"},window.PennController.DownloadVoiceButton=window.PennController.DownloadRecordingButton,window.PennController.Elements.newVoiceRecorder=(e=>window.PennController.Elements.newMediaRecorder(e,"audio")),window.PennController.Elements.getVoiceRecorder=(e=>window.PennController.Elements.getMediaRecorder(e))},function(e,t){window.PennController._AddElementType("Youtube",function(e){const t=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;let n=[];$(document).ready(function(){let e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";let t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t),window.onYouTubeIframeAPIReady=function(){for(let e in n)n[e].call()}}),this.immediate=function(t,i,r){void 0===i&&"string"==typeof t&&(i=t),i&&"string"==typeof i||e.debug.error("Invalid code for Youtube element "+t,i),r=r&&!r.match(/^\W*no\W*controls?\W*$/i)?1:0,this.resource=e.resources.fetch(i,function(t){let s=i+"-"+e.resources.list.length;this.ended=function(){},this.playing=function(){},this.paused=function(){},this.buffering=function(){};let o=!1,a=$("<iframe>");a.attr({src:"https://www.youtube-nocookie.com/embed/"+i+"?enablejsapi=1&controls="+r,id:s,frameborder:0}).bind("load",()=>o=!0).css({display:"none",position:"absolute"}),$(document).ready(()=>$(document.body).append(a)),n.push(()=>{let e=!0,n=()=>this.player=new YT.Player(s,{playerVars:{controls:r},events:{onReady:e=>{a=e.target.cueVideoById(i),e.target.playVideo()},onStateChange:n=>{n.data!=YT.PlayerState.ENDED||e?n.data==YT.PlayerState.PLAYING?e?(n.target.pauseVideo(),n.target.seekTo(0),e=!1,t()):this.playing(n):n.data!=YT.PlayerState.PAUSED||e?n.data!=YT.PlayerState.BUFFERING||e||this.buffering(n):this.paused(n):this.ended(n)}}});o?n():a.bind("load",n)}),this.object=a},!1),this.id=t},this.uponCreation=function(e){this.iframe=this.resource.object,this.player=this.resource.player,this.log=!1,this.hasPlayed=!1,this.events=[],this.onplay=(()=>this.events.push(["Play",this.player.getCurrentTime(),Date.now(),"NULL"])),this.onpause=(()=>this.events.push(["Pause",this.player.getCurrentTime(),Date.now(),"NULL"])),this.onbuffer=(()=>this.events.push(["Buffer",this.player.getCurrentTime(),Date.now(),"NULL"])),this.onend=(()=>{this.hasPlayed=!0,this.events.push(["End",this.player.getCurrentTime(),Date.now(),"NULL"])});let t=this,n=this.resource.ended;this.resource.ended=function(e){n.apply(this,e),t.onend()};let i=this.resource.playing;this.resource.playing=function(e){i.apply(this,e),t.onplay()};let r=this.resource.paused;this.resource.paused=function(e){r.apply(this,e),t.onpause()};let s=this.resource.buffering;this.resource.buffering=function(e){s.apply(this,e),t.onbuffer()},this.jQueryElement=$("<div>").css("display","inline-block"),this.visual={top:0,left:0,width:this.iframe.width(),height:this.iframe.height()},this.jQueryElement.css({width:this.visual.width,height:this.visual.height}),this.player.seekTo(0),this.disabled=!1,this.jQueryDisable=null,this.printDisable=(()=>{this.jQueryDisable instanceof jQuery&&this.jQueryDisable.remove(),this.jQueryDisable=$("<div>").css({position:"absolute",display:"inline-block","background-color":"gray",opacity:.5,width:this.jQueryElement.width(),height:this.jQueryElement.height()}),this.jQueryElement.before(this.jQueryDisable),this.jQueryElement.addClass("PennController-"+this.type.replace(/[\s_]/g,"")+"-disabled")}),e()},this.end=function(){if(this.observer&&this.observer instanceof t&&this.observer.disconnect(),this.player&&this.player.getPlayerState()==YT.PlayerState.PLAYING&&this.player.pauseVideo(),this.iframe.css("display","none"),this.jQueryDisable&&this.jQueryDisable.remove(),this.log&&this.log instanceof Array)if(this.events.length)if(this.log.indexOf("all")>-1)for(let t in this.events)e.controllers.running.save(this.type,this.id,...this.events[t]);else{if(this.log.indexOf("play")>-1){let t=this.events.filter(e=>"Play"==e[0]);for(let n in t)e.controllers.running.save(this.type,this.id,...t[n])}if(this.log.indexOf("end")>-1){let t=this.events.filter(e=>"End"==e[0]);for(let n in t)e.controllers.running.save(this.type,this.id,...t[n])}if(this.log.indexOf("pause")>-1){let t=this.events.filter(e=>"Pause"==e[0]);for(let n in t)e.controllers.running.save(this.type,this.id,...t[n])}if(this.log.indexOf("buffer")>-1){let t=this.events.filter(e=>"Buffer"==e[0]);for(let n in t)e.controllers.running.save(this.type,this.id,...t[n])}}else e.controllers.running.save(this.type,this.id,"play","NA","Never","The video was never played during the trial")},this.value=function(){return this.hasPlayed},this.actions={play:function(e){this.player.playVideo(),e()},pause:function(e){this.player.pauseVideo(),e()},print:function(n,...i){e.elements.standardCommands.actions.print.apply(this,[()=>{let e=this.jQueryElement.offset();this.iframe.css({position:"absolute",left:e.left,top:e.top,display:"inline-block"}),this.observer=new t(()=>{if(this.jQueryElement[0].offsetParent&&$.contains(document.body,this.jQueryElement[0])){this.iframe.css("display",this.jQueryElement.css("display"));let e=this.jQueryElement.width(),t=this.jQueryElement.height();e==this.visual.width&&t==this.visual.height||(this.iframe.css({width:e,height:t}),this.visual.width=e,this.visual.height=t);let n=this.jQueryElement.offset();n.left==this.visual.left&&n.top==this.visual.top||(this.iframe.css({left:n.left,top:n.top}),this.visual.left=n.left,this.visual.top=n.top),this.observer.disconnect(),this.observer.observe(this.jQueryElement.parent()[0],{childList:!0,attributes:!0,subtree:!0})}else this.iframe.css("display","none")}),this.observer.observe(this.jQueryElement.parent()[0],{childList:!0,attributes:!0,subtree:!0}),this.disabled&&this.printDisable(),n()},...i])},remove:function(t){this.iframe.css("display","none"),e.elements.standardCommands.actions.remove.apply(this,[t])},stop:function(e){this.player.pauseVideo(),this.player.seekTo(0),e()},wait:function(e,t){if("first"==t&&this.hasPlayed)e();else{let n=!1,i=this.onend;this.onend=function(...r){if(i.apply(this,r),!n)if(t instanceof Object&&t._runPromises&&t.success){let i=this.disabled;this.disabled="tmp",t._runPromises().then(t=>{"success"==t&&(n=!0,e()),"tmp"==this.disabled&&(this.disabled=i)})}else n=!0,e()}}}},this.settings={disable:function(e){this.printDisable(),this.disabled=!0,this.jQueryContainer.addClass("PennController-disabled"),this.jQueryElement.addClass("PennController-disabled"),e()},enable:function(e){this.jQueryDisable instanceof jQuery&&(this.disabled=!1,this.jQueryDisable.remove(),this.jQueryDisable=null,this.jQueryContainer.removeClass("PennController-disabled"),this.jQueryElement.removeClass("PennController-disabled")),e()},once:function(e){if(this.hasPlayed)this.disabled=!0;else{let e=this.onend,t=this;this.onend=function(...n){e.apply(this,n),t.disabled=!0,t.printDisable()}}e()},log:function(e,...t){t.length?this.log=t:this.log=["play"],e()},size:function(t,n,i){e.elements.standardCommands.settings.size.apply(this,[()=>{this.iframe.css({width:n,height:i}),this.visual.width=n,this.visual.height=i,t()},n,i])}},this.test={hasPlayed:function(){return this.hasPlayed},playing:function(){return 1==this.player.getPlayerState()}}})},,function(e,t,n){"use strict";n.r(t);n(1),n(0),n(57),n(2),n(58),n(59),n(113),n(115),n(116),n(117),n(118),n(119),n(120),n(121),n(122),n(123),n(124),n(125),n(126),n(127),n(128),n(129),n(130),n(131),n(132),n(133),n(134),n(135),n(136),n(137),n(138)}]);